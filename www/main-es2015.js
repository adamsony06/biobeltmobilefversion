(window["webpackJsonp"] = window["webpackJsonp"] || []).push([["main"],{

/***/ "./$$_lazy_route_resource lazy recursive":
/*!******************************************************!*\
  !*** ./$$_lazy_route_resource lazy namespace object ***!
  \******************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

function webpackEmptyAsyncContext(req) {
	// Here Promise.resolve().then() is used instead of new Promise() to prevent
	// uncaught exception popping up in devtools
	return Promise.resolve().then(function() {
		var e = new Error("Cannot find module '" + req + "'");
		e.code = 'MODULE_NOT_FOUND';
		throw e;
	});
}
webpackEmptyAsyncContext.keys = function() { return []; };
webpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;
module.exports = webpackEmptyAsyncContext;
webpackEmptyAsyncContext.id = "./$$_lazy_route_resource lazy recursive";

/***/ }),

/***/ "./node_modules/@ionic/core/dist/esm lazy recursive ^\\.\\/.*\\.entry\\.js$ include: \\.entry\\.js$ exclude: \\.system\\.entry\\.js$":
/*!*****************************************************************************************************************************************!*\
  !*** ./node_modules/@ionic/core/dist/esm lazy ^\.\/.*\.entry\.js$ include: \.entry\.js$ exclude: \.system\.entry\.js$ namespace object ***!
  \*****************************************************************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var map = {
	"./ion-action-sheet-controller_8.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-action-sheet-controller_8.entry.js",
		"common",
		0
	],
	"./ion-action-sheet-ios.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-action-sheet-ios.entry.js",
		"common",
		1
	],
	"./ion-action-sheet-md.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-action-sheet-md.entry.js",
		"common",
		2
	],
	"./ion-alert-ios.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-alert-ios.entry.js",
		"common",
		3
	],
	"./ion-alert-md.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-alert-md.entry.js",
		"common",
		4
	],
	"./ion-app_8-ios.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-app_8-ios.entry.js",
		"common",
		5
	],
	"./ion-app_8-md.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-app_8-md.entry.js",
		"common",
		6
	],
	"./ion-avatar_3-ios.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-avatar_3-ios.entry.js",
		"common",
		7
	],
	"./ion-avatar_3-md.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-avatar_3-md.entry.js",
		"common",
		8
	],
	"./ion-back-button-ios.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-back-button-ios.entry.js",
		"common",
		9
	],
	"./ion-back-button-md.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-back-button-md.entry.js",
		"common",
		10
	],
	"./ion-backdrop-ios.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-backdrop-ios.entry.js",
		11
	],
	"./ion-backdrop-md.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-backdrop-md.entry.js",
		12
	],
	"./ion-button_2-ios.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-button_2-ios.entry.js",
		"common",
		13
	],
	"./ion-button_2-md.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-button_2-md.entry.js",
		"common",
		14
	],
	"./ion-card_5-ios.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-card_5-ios.entry.js",
		"common",
		15
	],
	"./ion-card_5-md.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-card_5-md.entry.js",
		"common",
		16
	],
	"./ion-checkbox-ios.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-checkbox-ios.entry.js",
		"common",
		17
	],
	"./ion-checkbox-md.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-checkbox-md.entry.js",
		"common",
		18
	],
	"./ion-chip-ios.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-chip-ios.entry.js",
		"common",
		19
	],
	"./ion-chip-md.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-chip-md.entry.js",
		"common",
		20
	],
	"./ion-col_3.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-col_3.entry.js",
		21
	],
	"./ion-datetime_3-ios.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-datetime_3-ios.entry.js",
		"common",
		22
	],
	"./ion-datetime_3-md.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-datetime_3-md.entry.js",
		"common",
		23
	],
	"./ion-fab_3-ios.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-fab_3-ios.entry.js",
		"common",
		24
	],
	"./ion-fab_3-md.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-fab_3-md.entry.js",
		"common",
		25
	],
	"./ion-img.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-img.entry.js",
		26
	],
	"./ion-infinite-scroll_2-ios.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-infinite-scroll_2-ios.entry.js",
		"common",
		27
	],
	"./ion-infinite-scroll_2-md.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-infinite-scroll_2-md.entry.js",
		"common",
		28
	],
	"./ion-input-ios.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-input-ios.entry.js",
		"common",
		29
	],
	"./ion-input-md.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-input-md.entry.js",
		"common",
		30
	],
	"./ion-item-option_3-ios.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-item-option_3-ios.entry.js",
		"common",
		31
	],
	"./ion-item-option_3-md.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-item-option_3-md.entry.js",
		"common",
		32
	],
	"./ion-item_8-ios.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-item_8-ios.entry.js",
		"common",
		33
	],
	"./ion-item_8-md.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-item_8-md.entry.js",
		"common",
		34
	],
	"./ion-loading-ios.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-loading-ios.entry.js",
		"common",
		35
	],
	"./ion-loading-md.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-loading-md.entry.js",
		"common",
		36
	],
	"./ion-menu_4-ios.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-menu_4-ios.entry.js",
		"common",
		37
	],
	"./ion-menu_4-md.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-menu_4-md.entry.js",
		"common",
		38
	],
	"./ion-modal-ios.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-modal-ios.entry.js",
		"common",
		39
	],
	"./ion-modal-md.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-modal-md.entry.js",
		"common",
		40
	],
	"./ion-nav_5.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-nav_5.entry.js",
		"common",
		41
	],
	"./ion-popover-ios.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-popover-ios.entry.js",
		"common",
		42
	],
	"./ion-popover-md.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-popover-md.entry.js",
		"common",
		43
	],
	"./ion-progress-bar-ios.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-progress-bar-ios.entry.js",
		"common",
		44
	],
	"./ion-progress-bar-md.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-progress-bar-md.entry.js",
		"common",
		45
	],
	"./ion-radio_2-ios.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-radio_2-ios.entry.js",
		"common",
		46
	],
	"./ion-radio_2-md.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-radio_2-md.entry.js",
		"common",
		47
	],
	"./ion-range-ios.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-range-ios.entry.js",
		"common",
		48
	],
	"./ion-range-md.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-range-md.entry.js",
		"common",
		49
	],
	"./ion-refresher_2-ios.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-refresher_2-ios.entry.js",
		"common",
		50
	],
	"./ion-refresher_2-md.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-refresher_2-md.entry.js",
		"common",
		51
	],
	"./ion-reorder_2-ios.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-reorder_2-ios.entry.js",
		"common",
		52
	],
	"./ion-reorder_2-md.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-reorder_2-md.entry.js",
		"common",
		53
	],
	"./ion-ripple-effect.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-ripple-effect.entry.js",
		54
	],
	"./ion-route_4.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-route_4.entry.js",
		"common",
		55
	],
	"./ion-searchbar-ios.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-searchbar-ios.entry.js",
		"common",
		56
	],
	"./ion-searchbar-md.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-searchbar-md.entry.js",
		"common",
		57
	],
	"./ion-segment_2-ios.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-segment_2-ios.entry.js",
		"common",
		58
	],
	"./ion-segment_2-md.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-segment_2-md.entry.js",
		"common",
		59
	],
	"./ion-select_3-ios.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-select_3-ios.entry.js",
		"common",
		60
	],
	"./ion-select_3-md.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-select_3-md.entry.js",
		"common",
		61
	],
	"./ion-slide_2-ios.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-slide_2-ios.entry.js",
		62
	],
	"./ion-slide_2-md.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-slide_2-md.entry.js",
		63
	],
	"./ion-spinner.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-spinner.entry.js",
		"common",
		64
	],
	"./ion-split-pane-ios.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-split-pane-ios.entry.js",
		65
	],
	"./ion-split-pane-md.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-split-pane-md.entry.js",
		66
	],
	"./ion-tab-bar_2-ios.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-tab-bar_2-ios.entry.js",
		"common",
		67
	],
	"./ion-tab-bar_2-md.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-tab-bar_2-md.entry.js",
		"common",
		68
	],
	"./ion-tab_2.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-tab_2.entry.js",
		"common",
		69
	],
	"./ion-text.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-text.entry.js",
		"common",
		70
	],
	"./ion-textarea-ios.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-textarea-ios.entry.js",
		"common",
		71
	],
	"./ion-textarea-md.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-textarea-md.entry.js",
		"common",
		72
	],
	"./ion-toast-ios.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-toast-ios.entry.js",
		"common",
		73
	],
	"./ion-toast-md.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-toast-md.entry.js",
		"common",
		74
	],
	"./ion-toggle-ios.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-toggle-ios.entry.js",
		"common",
		75
	],
	"./ion-toggle-md.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-toggle-md.entry.js",
		"common",
		76
	],
	"./ion-virtual-scroll.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-virtual-scroll.entry.js",
		77
	]
};
function webpackAsyncContext(req) {
	if(!__webpack_require__.o(map, req)) {
		return Promise.resolve().then(function() {
			var e = new Error("Cannot find module '" + req + "'");
			e.code = 'MODULE_NOT_FOUND';
			throw e;
		});
	}

	var ids = map[req], id = ids[0];
	return Promise.all(ids.slice(1).map(__webpack_require__.e)).then(function() {
		return __webpack_require__(id);
	});
}
webpackAsyncContext.keys = function webpackAsyncContextKeys() {
	return Object.keys(map);
};
webpackAsyncContext.id = "./node_modules/@ionic/core/dist/esm lazy recursive ^\\.\\/.*\\.entry\\.js$ include: \\.entry\\.js$ exclude: \\.system\\.entry\\.js$";
module.exports = webpackAsyncContext;

/***/ }),

/***/ "./node_modules/raw-loader/index.js!./src/app/app.component.html":
/*!**************************************************************!*\
  !*** ./node_modules/raw-loader!./src/app/app.component.html ***!
  \**************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<ion-header>\r\n  <ion-toolbar color=\"primary\">\r\n    <ion-buttons slot=\"start\">\r\n      <ion-menu-button></ion-menu-button>\r\n      <ion-back-button defaultHref=\"home\" text=\"Accueil\"></ion-back-button>\r\n      <!-- \r\n        Implémenter Back\r\n        Ecran blanc \r\n        Page Accueil Message enlever page test\r\n        Test connexion à la socket \r\n        Reaffiche ecran d'accueil\r\n        Afficher nouvelle page biobeltmobile mode test\r\n        disabled si aucune communication à l'upc\r\n          \r\n      -->\r\n    </ion-buttons>\r\n    \r\n    <ion-title>{{stockRet}}</ion-title>\r\n    <ion-buttons slot=\"end\" *ngIf=\"global.statutConnexion == 'Serveur'\">\r\n      <ion-button fill=\"clear\" (click)=\"goToConn();\"> <ion-icon name=\"globe\" color=\"light\"></ion-icon>ADMIN</ion-button> \r\n     </ion-buttons>\r\n     <ion-buttons slot=\"end\" *ngIf=\"global.statutConnexion == 'UPC'\">\r\n      <ion-button fill=\"clear\" (click)=\"goToConn();\"> <ion-icon name=\"wifi\" color=\"light\"></ion-icon>{{global.currentssid}}</ion-button> \r\n     </ion-buttons>\r\n     <ion-buttons slot=\"end\" style=\"color: red;\" *ngIf=\"global.statutConnexion == 'Aucune' && global.connexionRequise == 'UPC'\">\r\n      <ion-button fill=\"clear\" (click)=\"goToConn();\"><ion-icon name=\"close\"></ion-icon>UPC</ion-button> \r\n\r\n     </ion-buttons>\r\n  </ion-toolbar>\r\n</ion-header>\r\n<ion-app> \r\n  <ion-split-pane contentId=\"main-content\">\r\n    <ion-menu contentId=\"main-content\" type=\"overlay\">\r\n      <ion-header>\r\n        <ion-toolbar color=\"primary\">\r\n          <ion-title>Biobelt</ion-title>         \r\n        </ion-toolbar>\r\n      </ion-header>      \r\n      <ion-content>\r\n        <ion-list>\r\n          <ion-menu-toggle auto-hide=\"false\" *ngFor=\"let p of global.pages\">\r\n            <ion-item [routerDirection]=\"'root'\" (click)=\"onClearInterval(p.url);\">\r\n              <ion-icon slot=\"start\" [name]=\"p.icon\" color=\"primary\"></ion-icon>\r\n              <ion-label>\r\n                {{p.title}}\r\n              </ion-label>\r\n            </ion-item>\r\n          </ion-menu-toggle>\r\n        </ion-list>        \r\n      </ion-content>      \r\n    </ion-menu>\r\n    <ion-router-outlet id=\"main-content\"></ion-router-outlet>\r\n  </ion-split-pane>\r\n</ion-app>\r\n"

/***/ }),

/***/ "./node_modules/raw-loader/index.js!./src/app/rackcontent/rackcontent.page.html":
/*!*****************************************************************************!*\
  !*** ./node_modules/raw-loader!./src/app/rackcontent/rackcontent.page.html ***!
  \*****************************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<ion-header>\r\n  <ion-toolbar color=\"primary\">\r\n    <ion-buttons>\r\n      <ion-button fill=\"clear\" (click)=\"onClose();\">\r\n        <ion-icon name=\"close\"></ion-icon>\r\n      </ion-button>\r\n    </ion-buttons>\r\n    <ion-title>Enlever bouteilles du Rack</ion-title>\r\n    <ion-buttons slot=\"end\" *ngIf=\"!global.isBBAM\">\r\n      <ion-button fill=\"clear\"> <ion-icon name=\"globe\" color=\"light\"></ion-icon>ADMIN</ion-button> \r\n     </ion-buttons>\r\n     <ion-buttons slot=\"end\" *ngIf=\"global.isBBAM\">\r\n      <ion-button fill=\"clear\"> <ion-icon name=\"wifi\" color=\"light\"></ion-icon>{{global.ssid}}</ion-button> \r\n     </ion-buttons>\r\n  </ion-toolbar>\r\n</ion-header>\r\n\r\n<ion-content>\r\n  <ion-list>\r\n    <ion-item *ngFor=\"let r of rackContent;let i = index;\">\r\n      <ion-label>{{r.bottleString}}</ion-label>\r\n      <ion-badge color=\"success\" *ngIf=\"r.state === 'FULL'\">Plein</ion-badge>\r\n      <ion-badge color=\"secondary\" *ngIf=\"r.state === 'IN_USE'\">Entamée</ion-badge>\r\n      <ion-badge color=\"danger\" *ngIf=\"r.state === 'EMPTY'\">Vide</ion-badge>\r\n    </ion-item>\r\n  </ion-list>\r\n</ion-content>\r\n\r\n<ion-footer>\r\n  <ion-button size=\"block\" (click)=\"onRetourFourn();\">Retour Au Fournisseur</ion-button>\r\n</ion-footer>"

/***/ }),

/***/ "./src/app/api/ApiResponse.ts":
/*!************************************!*\
  !*** ./src/app/api/ApiResponse.ts ***!
  \************************************/
/*! exports provided: Code */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Code", function() { return Code; });
var Code;
(function (Code) {
    // General
    Code["WRONG_PARAMS"] = "WRONG_PARAMS";
    Code["INTERNAL_ERROR"] = "INTERNAL_ERROR";
    Code["UNAUTHORIZED"] = "UNAUTHORIZED";
    // Token
    Code["TOKEN_WRONG_IDENTIFIERS"] = "TOKEN_WRONG_IDENTIFIERS";
    Code["TOKEN_LOGGED_IN"] = "TOKEN_LOGGED_IN";
    // Operator
    Code["OPERATOR_RECOVERED"] = "OPERATOR_RECOVERED";
    Code["OPERATOR_CREATED"] = "OPERATOR_CREATED";
    Code["OPERATOR_DOESNT_EXSIST"] = "OPERATOR_DOESNT_EXSIST";
    Code["OPERATOR_ALREADY_EXSIST"] = "OPERATOR_ALREADY_EXSIST";
    Code["OPERATOR_EDITED"] = "OPERATOR_EDITED";
    Code["OPERATOR_DELETED"] = "OPERATOR_DELETED";
    // Designer
    Code["DESIGNER_RECOVERED"] = "DESIGNER_RECOVERED";
    Code["DESIGNER_DOESNT_EXSIST"] = "DESIGNER_DOESNT_EXSIST";
    Code["DESIGNER_ALREADY_EXSIST"] = "DESIGNER_ALREADY_EXSIST";
    Code["DESIGNER_CREATED"] = "DESIGNER_CREATED";
    Code["DESIGNER_EDITED"] = "DESIGNER_EDITED";
    Code["DESIGNER_DELETED"] = "DESIGNER_DELETED";
    // Site
    Code["SITE_RECOVERED"] = "SITE_RECOVERED";
    Code["SITE_CREATED"] = "SITE_CREATED";
    Code["SITE_DOESNT_EXSIST"] = "SITE_DOESNT_EXSIST";
    Code["SITE_ALREADY_EXSIST"] = "SITE_ALREADY_EXSIST";
    Code["SITE_EDITED"] = "SITE_EDITED";
    Code["SITE_DELETED"] = "SITE_DELETED";
    Code["SITE_USED"] = "SITE_USED";
    // Stock
    Code["STOCK_RECOVERED"] = "STOCK_RECOVERED";
    Code["STOCK_CREATED"] = "STOCK_CREATED";
    Code["STOCK_DOESNT_EXSIST"] = "STOCK_DOESNT_EXSIST";
    Code["STOCK_ALREADY_EXSIST"] = "STOCK_ALREADY_EXSIST";
    Code["STOCK_EDITED"] = "STOCK_EDITED";
    Code["STOCK_DELETED"] = "STOCK_DELETED";
    Code["STOCK_USED"] = "STOCK_USED";
    // BottleType
    Code["BOTTLE_TYPE_RECOVERED"] = "BOTTLE_TYPE_RECOVERED";
    Code["BOTTLE_TYPE_CREATED"] = "BOTTLE_TYPE_CREATED";
    Code["BOTTLE_TYPE_DOESNT_EXSIST"] = "BOTTLE_TYPE_DOESNT_EXSIST";
    Code["BOTTLE_TYPE_ALREADY_EXSIST"] = "BOTTLE_TYPE_ALREADY_EXSIST";
    Code["BOTTLE_TYPE_DELETED"] = "BOTTLE_TYPE_DELETED";
    Code["BOTTLE_TYPE_USED"] = "BOTTLE_TYPE_USED";
    // Bottle
    Code["BOTTLE_RECOVERED"] = "BOTTLE_RECOVERED";
    Code["BOTTLE_CREATED"] = "BOTTLE_CREATED";
    Code["BOTTLE_DOESNT_EXSIST"] = "BOTTLE_DOESNT_EXSIST";
    Code["BOTTLE_ALREADY_EXSIST"] = "BOTTLE_ALREADY_EXSIST";
    Code["BOTTLE_DELETED"] = "BOTTLE_DELETED";
    // Project
    Code["PROJECT_RECOVERED"] = "PROJECT_RECOVERED";
    Code["PROJECT_DOESNT_EXSIST"] = "PROJECT_DOESNT_EXSIST";
    Code["PROJECT_ALREADY_EXSIST"] = "PROJECT_ALREADY_EXSIST";
    Code["PROJECT_CREATED"] = "PROJECT_CREATED";
    Code["PROJECT_EDITED"] = "PROJECT_EDITED";
    Code["PROJECT_DELETED"] = "PROJECT_DELETED";
    // Version
    Code["VERSION_RECOVERED"] = "VERSION_RECOVERED";
    Code["VERSION_DOESNT_EXSIST"] = "VERSION_DOESNT_EXSIST";
    Code["VERSION_ALREADY_EXSIST"] = "VERSION_ALREADY_EXSIST";
    Code["VERSION_CREATED"] = "VERSION_CREATED";
    Code["VERSION_EDITED"] = "VERSION_EDITED";
    Code["VERSION_SYNCHRONIZED"] = "VERSION_SYNCHRONIZED";
    Code["VERSION_DELETED"] = "VERSION_DELETED";
    // Tasks
    Code["TASK_RECOVERED"] = "TASK_RECOVERED";
    Code["TASK_ALREADY_RUNNING"] = "TASK_ALREADY_RUNNING";
    // UPCV3
    Code["UPCV3_RECOVERED"] = "UPCV3_RECOVERED";
    Code["UPCV3_DOESNT_EXSIST"] = "UPCV3_DOESNT_EXSIST";
    Code["UPCV3_EDITED"] = "UPCV3_EDITED";
    Code["INTERVENTIONV3_RECOVERED"] = "INTERVENTIONV3_RECOVERED";
    Code["INTERVENTIONV3_DOESNT_EXSIST"] = "INTERVENTIONV3_DOESNT_EXSIST";
    Code["INTERVENTIONV3_CREATED"] = "INTERVENTIONV3_CREATED";
    Code["INTERVENTIONV3_DELETED"] = "INTERVENTIONV3_DELETED";
    Code["INTERVENTIONV3_USED"] = "INTERVENTIONV3_USED";
    Code["OBSERVATIONV3_RECOVERED"] = "OBSERVATIONV3_RECOVERED";
    Code["EVENT_RECOVERED"] = "EVENT_RECOVERED";
    Code["STATS_RECOVERED"] = "STATS_RECOVERED";
    Code["UPCV3_CREATED"] = "UPCV3_CREATED";
    Code["UPCV3_DELETED"] = "UPCV3_DELETED";
    // Firmware
    Code["FIRMWARE_RECOVERED"] = "FIRMWARE_RECOVERED";
    Code["FIRMWARE_UPLOADED"] = "FIRMWARE_UPLOADED";
    Code["FIRMWARE_DELETED"] = "FIRMWARE_DELETED";
    Code["FIRMWARE_FLASH_STARTED"] = "FIRMWARE_FLASH_STARTED";
    // Poll / Init / Restore
    Code["POLL_STARTED"] = "POLL_STARTED";
    Code["INIT_STARTED"] = "INIT_STARTED";
    Code["RESTORE_STARTED"] = "RESTORE_STARTED";
    // Default UPCV3 Params
    Code["DEFAULT_UPCV3_PARAMS_RECOVERED"] = "DEFAULT_UPCV3_PARAMS_RECOVERED";
    Code["DEFAULT_UPCV3_PARAMS_EDITED"] = "DEFAULT_UPCV3_PARAMS_EDITED";
    // Modbus
    Code["MODBUS_CONNECTION_ERROR"] = "MODBUS_CONNECTION_ERROR";
    Code["MODBUS_WRITE_ERROR"] = "MODBUS_WRITE_ERROR";
    Code["MODBUS_READ_ERROR"] = "MODBUS_READ_ERROR";
    // UPCV2
    Code["UPCV2_RECOVERED"] = "UPCV2_RECOVERED";
    Code["UPCV2_DOESNT_EXSIST"] = "UPCV2_DOESNT_EXSIST";
    Code["UPCV2_EDITED"] = "UPCV2_EDITED";
    Code["INTERVENTIONV2_RECOVERED"] = "INTERVENTIONV2_RECOVERED";
    Code["INTERVENTIONV2_DOESNT_EXSIST"] = "INTERVENTIONV2_DOESNT_EXSIST";
    Code["INTERVENTIONV2_CREATED"] = "INTERVENTIONV2_CREATED";
    Code["INTERVENTIONV2_EDITED"] = "INTERVENTIONV2_EDITED";
    Code["INTERVENTIONV2_DELETED"] = "INTERVENTIONV2_DELETED";
    Code["INTERVENTIONV2_USED"] = "INTERVENTIONV2_USED";
    Code["OBSERVATIONV2_RECOVERED"] = "OBSERVATIONV2_RECOVERED";
})(Code || (Code = {}));


/***/ }),

/***/ "./src/app/api/global.service.ts":
/*!***************************************!*\
  !*** ./src/app/api/global.service.ts ***!
  \***************************************/
/*! exports provided: GlobalService */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GlobalService", function() { return GlobalService; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm2015/core.js");
/* harmony import */ var _ionic_angular__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @ionic/angular */ "./node_modules/@ionic/angular/dist/fesm5.js");
/* harmony import */ var _upcv3service_service__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./upcv3service.service */ "./src/app/api/upcv3service.service.ts");
/* harmony import */ var _ionic_native_hotspot_ngx__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @ionic-native/hotspot/ngx */ "./node_modules/@ionic-native/hotspot/ngx/index.js");
/* harmony import */ var _model_upcv3_upcmodbus__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../model/upcv3/upcmodbus */ "./src/app/model/upcv3/upcmodbus.ts");
/* harmony import */ var _ionic_storage__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @ionic/storage */ "./node_modules/@ionic/storage/fesm2015/ionic-storage.js");
/* harmony import */ var _model_user__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../model/user */ "./src/app/model/user.ts");
/* harmony import */ var _angular_router__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @angular/router */ "./node_modules/@angular/router/fesm2015/router.js");
/* harmony import */ var _ionic_native_network_ngx__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @ionic-native/network/ngx */ "./node_modules/@ionic-native/network/ngx/index.js");
/* harmony import */ var _ionic_native_diagnostic_ngx__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @ionic-native/diagnostic/ngx */ "./node_modules/@ionic-native/diagnostic/ngx/index.js");











let GlobalService = class GlobalService {
    constructor(platform, loadingCTRL, upcv3Service, hotspot, ngZone, storage, upc3serv, toastCtrl, alertController, router, network, diagnostic, events) {
        this.platform = platform;
        this.loadingCTRL = loadingCTRL;
        this.upcv3Service = upcv3Service;
        this.hotspot = hotspot;
        this.ngZone = ngZone;
        this.storage = storage;
        this.upc3serv = upc3serv;
        this.toastCtrl = toastCtrl;
        this.alertController = alertController;
        this.router = router;
        this.network = network;
        this.diagnostic = diagnostic;
        this.events = events;
        this.B1 = [];
        this.B2 = [];
        this.designationB1 = [];
        this.designationB2 = [];
        this.ssid = "";
        this.isBBAM = false;
        this.username = "";
        this.password = "";
        this.appPagesModeIntervention = [
            {
                title: "Logs",
                url: "/debug"
            },
            {
                title: "Intervention sur Ceinture",
                url: "/interventionceinture",
                icon: "hammer"
            },
            {
                title: "Paramètres Généraux UPC",
                url: "/namepiege"
            },
            {
                title: "Initialisation / Echange boitier UPC",
                url: "/initechangeboitierupc"
            },
            {
                title: "Modification du nombre de pièges",
                url: "/modifnbpieges"
            },
            {
                title: "Vérification débits pièges individuels",
                url: "/verifpiegesindividuels"
            },
            {
                title: 'Changement de bouteilles sur ceinture',
                url: '/addbottleceint',
                icon: 'barcode'
            },
            {
                title: 'Réglage des détendeurs',
                url: '/adjustment',
                icon: 'return-right'
            },
            {
                title: "Contrôle débits Mini/Maxi",
                url: "/controldiff",
                icon: "infinite",
            },
            {
                title: 'Programmation',
                icon: 'sunny',
                url: "/synchro",
            },
            {
                title: "Etat de la Connexion",
                icon: "globe",
                url: "/connection"
            },
            {
                title: "Contrôle Diffusion",
                url: "/cdiff"
            },
            {
                title: "Mesure des pressions de sortie",
                url: "/check",
            },
            {
                title: "Paramètre de Communication",
                url: "/comunicationparam",
                icon: "wifi"
            },
            {
                title: "Paramètre d'Alarme",
                url: "/alarmparam",
                icon: "alarm"
            },
            {
                title: "Commentaires",
                url: "/commentaires"
            },
            {
                title: "Rapport de visite",
                url: "/rapportvisite"
            },
            {
                title: "Fin d'intervention",
                url: "/finintervention"
            }
        ];
        this.appPagesModeMvtBouteilles = [
            {
                title: "Mouvements de bouteilles",
                url: "/optionbottle"
            }
        ];
        this.appPagesModeTest = [
            {
                title: "Logs",
                url: "/debug"
            },
            {
                title: "Paramètres Généraux UPC",
                url: "/namepiege"
            },
            {
                title: "Initialisation / Echange boitier UPC",
                url: "/initechangeboitierupc"
            },
            {
                title: "Modification du nombre de pièges",
                url: "/modifnbpieges"
            },
            {
                title: "Vérification débits pièges individuels",
                url: "/verifpiegesindividuels"
            },
            {
                title: 'Changement de bouteilles sur ceinture',
                url: '/addbottleceint',
                icon: 'barcode'
            },
            {
                title: 'Réglage des détendeurs',
                url: '/adjustment',
                icon: 'return-right'
            },
            {
                title: "Contrôle débits Mini/Maxi",
                url: "/controldiff",
                icon: "infinite",
            },
            {
                title: 'Programmation',
                icon: 'sunny',
                url: "/synchro",
            },
            {
                title: "Etat de la Connexion",
                icon: "globe",
                url: "/connection"
            },
            {
                title: "Contrôle Diffusion",
                url: "/cdiff"
            },
            {
                title: "Mesure des pressions de sortie",
                url: "/check",
            },
            {
                title: "Paramètre de Communication",
                url: "/comunicationparam",
                icon: "wifi"
            },
            {
                title: "Paramètre d'Alarme",
                url: "/alarmparam",
                icon: "alarm"
            }
        ];
        this.pages = [];
        this.logs = [];
        this.mode = "";
        this.lectureCycliqueEnCours = false;
        this.lectureStatiqueEnCours = false;
        this.ecritureEnCours = false;
        this.statutConnexion = "Aucune";
        this.connexionRequise = "Aucune";
        this.upcname = "";
        this.appelOnConnectModbus = false;
        this.needToCheckState = false;
        this.needToCheckFlags = false;
        this.needToCallOnReadStatique = false;
        this.needToCallOnReadCyclique = false;
        this.onConnectEnCours = false;
    }
    onSynchroB1B2(token) {
        if (localStorage.getItem("bottleB1")) {
            var jsonB1 = JSON.parse(localStorage.getItem("bottleB1"));
            //alert(JSON.stringify(jsonB1));
            jsonB1.endate = new Date().toISOString().substr(0, 16);
            if (this.platform.is("ios")) {
                WifiWizard2.iOSDisconnectNetwork("BBAM").then((res) => tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
                    var loading = yield this.loadingCTRL.create({
                        message: "Synchronisation avec le Serveur en cours...",
                        duration: 10000
                    });
                    loading.present();
                    this.upcv3Service.addBottleBelt(jsonB1, token).subscribe(res => {
                        loading.dismiss();
                    });
                }));
            }
            else {
                this.upcv3Service.addBottleBelt(jsonB1, token).subscribe(res => {
                    alert(JSON.stringify(res));
                }, err => {
                    JSON.stringify(err);
                });
            }
        }
        if (localStorage.getItem("bottleB2")) {
            var jsonB2 = JSON.parse(localStorage.getItem("bottleB2"));
            jsonB2.endate = new Date().toISOString().substr(0, 16);
            if (this.platform.is("ios")) {
                WifiWizard2.iOSDisconnectNetwork(("BBAM")).then((res) => tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
                    var loading = yield this.loadingCTRL.create({
                        message: "Synchronisation avec le Serveur en cours...",
                        duration: 10000
                    });
                    loading.present();
                    this.upcv3Service.addBottleBelt(jsonB2, token).subscribe(res => {
                        loading.dismiss();
                    });
                }));
            }
            else {
                WifiWizard2.disconnect("BBAM").then((res) => tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
                    var loading = yield this.loadingCTRL.create({
                        message: "Synchronisation avec le Serveur en cours...",
                        duration: 10000
                    });
                    loading.present();
                    this.upcv3Service.addBottleBelt(jsonB2, token).subscribe(res => {
                        loading.dismiss();
                    });
                }));
            }
        }
    }
    ConnectError() {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            let toast = yield this.toastCtrl.create({ message: "Veuillez vous connectez au WiFi de l'UPC", duration: 4000, position: "middle" });
            toast.present();
        });
    }
    UpcReadWriteError() {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            let toast = yield this.toastCtrl.create({ message: "Echec lors de la communication avec l'UPC", duration: 4000, position: "middle" });
            toast.present();
        });
    }
    UpcErrorCoAuto() {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            let toast = yield this.toastCtrl.create({ message: "Erreur lors de la connexion automatique ! Veuillez vous connecter manuellement via les Réglages!", duration: 4000, position: "middle" });
            toast.present();
        });
    }
    // Ne pas Enregistrer point d'accès si l'application en sommeil
    onConnectWiFi() {
        return new Promise((resolve, reject) => tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            if (!localStorage.getItem("ssid")) {
                /* let alert = await this.alertController.create({message : "Veuillez Vous connectez au WiFi de l'UPC !",
                                                                buttons : [{
                                                                  text : "OK",
                                                                  handler : ()=>{
                                                                   WifiWizard2.getConnectedSSID().then(res=>{
                                                                      localStorage.setItem("ssid",res);
                                                                    })
                                                                    
                                                                  }
                                                                }/*,{
                                                                 text : "NON",
                                                                 handler : ()=>{
                                                                  this.onConnectWiFi();
                                                                 }
                                                                }*/ /*]
               })
await alert.present();*/
            }
            var ssid = localStorage.getItem("ssid") ? localStorage.getItem("ssid") : "BBAM";
            var password = localStorage.getItem("password") ? localStorage.getItem("password") : "BioBeltService";
            if (this.platform.is("android")) {
                //this.hotspot.isConnectedToInternet().then(res=>{
                if (!localStorage.getItem("isConnected")) {
                    this.hotspot.connectToWifi(ssid, password).then(res => {
                        this.upcmodbus = new _model_upcv3_upcmodbus__WEBPACK_IMPORTED_MODULE_5__["UPCModbus"](state => {
                            if (state == 2) {
                                var currentState = 2;
                                setTimeout(() => {
                                    if (currentState == state) {
                                        //alert("Vous n'êtes pas connecté à un UPC !");
                                    }
                                }, 1000);
                            }
                            if (state == 1) {
                                this.ngZone.run(() => {
                                    // Force refresh UI
                                    localStorage.setItem("isConnected", "true");
                                    resolve();
                                    //this.readDiffusionParameters();
                                });
                            }
                        });
                    }).catch(err => {
                        alert("Echec de Connexion à l'UPC ! Veuillez recharger la page !");
                        alert(err);
                    });
                }
                else {
                    resolve();
                }
                //})
            }
            else if (this.platform.is("ios")) {
                if (!localStorage.getItem("isConnected")) {
                    WifiWizard2.iOSConnectNetwork(ssid, password).then(res => {
                        //setTimeout(()=>{
                        var bool = false;
                        this.upcmodbus = new _model_upcv3_upcmodbus__WEBPACK_IMPORTED_MODULE_5__["UPCModbus"](state => {
                            if (state == 2) {
                                bool = true;
                                setTimeout(() => {
                                    if (bool) {
                                        localStorage.removeItem("isConnected");
                                        //alert("Vous n'êtes pas connecté à un UPC");
                                    }
                                }, 1000);
                            }
                            if (state == 1) {
                                bool = false;
                                this.ngZone.run(() => {
                                    // Force refresh UI
                                    //this.upcmodbus.getAllVars();
                                    //alert(JSON.stringify(this.upcmodbus));
                                    localStorage.setItem("isConnected", "true");
                                    resolve();
                                    //this.readDiffusionParameters();
                                });
                            }
                        });
                        //},5000)
                    }).catch(err => {
                        //alert("Echec de Connexion à l'UPC ! Veuillez recharger la page !");
                        //this.UpcErrorCoAuto();
                        localStorage.setItem("isConnected", "true");
                        resolve();
                    });
                }
                else {
                    resolve();
                }
            }
        }));
    }
    onConnectInternet() {
        return new Promise((resolve, reject) => tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            if (this.platform.is("ios")) {
                resolve();
                /*WifiWizard2.iOSDisconnectNetwork(localStorage.getItem("ssid")).then(async res=>{
                  
                  await this.storage.get('user').then(val => this.username = val);
                  await this.storage.get('pass').then(val => this.password = val);
                  await this.storage.get('remember').then(async res=>{
              if (res === 1){
                /*const loading = await this.loadingCtrl.create({
                  message: 'Connexion en cours...'
                });
                loading.present();*/
                /*let user = new User();
                user.username = this.username;
                user.password = this.password;
      
                this.upc3serv.login(user).subscribe(async res=>{
                  //loading.dismiss();
                 
                  if(res.result){
                    localStorage.setItem("token",res.result);
                    localStorage.removeItem("ssid");
                    resolve();
                  }
                  else {
                    // Check code
                    switch (res.code) {
                      case 'TOKEN_WRONG_IDENTIFIERS':
                        let toast = await this.toastCtrl.create({
                          message: 'Identifiants incorrects !',
                          duration: 3000,
                          position: 'top'
                        });
                        toast.present();
                        break;
                    }
                    //this.onBBAM();
                    resolve();
                  }
                },
                async err => {
                  localStorage.removeItem("ssid");
                  resolve();
                  // Hide loading
                  //loading.dismiss();
        
                  /*let toast = await this.toastCtrl.create({
                    message: 'Impossible de se connecter à internet ! Connexion UPC !',
                    duration: 3000,
                    position: 'top'
                  });
                  toast.present()*/
                //this.onBBAM();
                /*})
              
            
            
            
          
        }
      });
          })*/
            }
            else if (this.platform.is("android")) {
                this.hotspot.toggleWifi().then((res) => tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
                    yield this.storage.get('user').then(val => this.username = val);
                    yield this.storage.get('pass').then(val => this.password = val);
                    yield this.storage.get('remember').then((res) => tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
                        if (res === 1) {
                            /*const loading = await this.loadingCtrl.create({
                              message: 'Connexion en cours...'
                            });
                            loading.present();*/
                            let user = new _model_user__WEBPACK_IMPORTED_MODULE_7__["User"]();
                            user.username = this.username;
                            user.password = this.password;
                            this.upc3serv.login(user).subscribe((res) => tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
                                //loading.dismiss();
                                if (res.result) {
                                    localStorage.setItem("token", res.result);
                                    localStorage.removeItem("ssid");
                                    resolve();
                                }
                                else {
                                    // Check code
                                    switch (res.code) {
                                        case 'TOKEN_WRONG_IDENTIFIERS':
                                            let toast = yield this.toastCtrl.create({
                                                message: 'Identifiants incorrects !',
                                                duration: 3000,
                                                position: 'top'
                                            });
                                            toast.present();
                                            break;
                                    }
                                    //this.onBBAM();
                                    resolve();
                                }
                            }), (err) => tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
                                localStorage.removeItem("ssid");
                                resolve();
                                // Hide loading
                                //loading.dismiss();
                                /*let toast = await this.toastCtrl.create({
                                  message: 'Impossible de se connecter à internet ! Connexion UPC !',
                                  duration: 3000,
                                  position: 'top'
                                });
                                toast.present()*/
                                //this.onBBAM();
                            }));
                        }
                    }));
                }));
            }
        }));
    }
    checkNextPage() {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            var urls = [];
            var success;
            const url = this.router.url;
            const splittedUrl = url.split("/");
            const urlFinal = splittedUrl[1];
            var sequence = yield this.storage.get("sequence");
            if (sequence != undefined) {
                if (sequence != "") {
                    sequence.forEach((element) => {
                        urls.push(element[2]);
                    });
                }
                if (urls.includes(urlFinal)) {
                    var pos = urls.indexOf(urlFinal);
                    sequence[pos][1] = true;
                    this.storage.set("sequence", sequence);
                    if (urls[pos + 1] != undefined) {
                        this.storage.set("nexturl", urls[pos + 1]);
                        success = true;
                    }
                }
            }
            return success;
        });
    }
    checkMode() {
        var response;
        switch (this.mode) {
            case "intervention":
                this.pages = this.appPagesModeIntervention;
                break;
            case "mvtBouteilles":
                this.pages = this.appPagesModeMvtBouteilles;
                break;
            case "modeTest":
                this.pages = this.appPagesModeTest;
                break;
        }
        response = this.pages;
        return response;
    }
    onConnect(error) {
        this.onConnectEnCours = true;
        return new Promise((resolve, reject) => tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            var d = new Date();
            this.logs.push(this.msToTime(d.getTime()) + " - entrée fonction onConnect"); //console.log(msToTime(300000))
            if (this.connexionRequise == "Aucune") {
                var d = new Date();
                this.logs.push(this.msToTime(d.getTime()) + " - connexion requise : aucune");
                resolve("");
            }
            if (this.connexionRequise == "UPC") {
                var d = new Date();
                this.logs.push(this.msToTime(d.getTime()) + " - connexion requise : UPC");
                this.storage.get("ssid").then(res => {
                    this.ssid = res;
                    var d = new Date();
                    this.logs.push(this.msToTime(d.getTime()) + " - ssid stocké : " + this.ssid);
                    this.diagnostic.isWifiEnabled().then(res => {
                        if (res == true) { //WIFI activé
                            var d = new Date();
                            this.logs.push(this.msToTime(d.getTime()) + " - wifi activé");
                            WifiWizard2.getConnectedSSID().then(res => {
                                var d2 = new Date();
                                this.logs.push(this.msToTime(d2.getTime()) + " - wifi connecté"); //WIFI connecté
                                this.currentssid = res;
                                var d = new Date();
                                this.logs.push(this.msToTime(d.getTime()) + " - ssid courant : " + this.currentssid);
                                if (this.ssid == undefined || this.ssid == "") { //ssid vide 
                                    var d = new Date();
                                    this.logs.push(this.msToTime(d.getTime()) + " - ssid stocké vide : " + this.ssid);
                                    this.appelOnConnectModbus = true;
                                    this.onConnectModbus().then(() => tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
                                        //connexion modbus réussie : c'est un upc
                                        var d = new Date();
                                        this.appelOnConnectModbus = false;
                                        this.logs.push(this.msToTime(d.getTime()) + " - connexion Modbus réussie");
                                        yield this.storage.set("ssid", this.currentssid); //le ssid par défaut devient celui auquel on est connecté
                                        this.logs.push(this.msToTime(d.getTime()) + " - ssid stocké devient ssid connecté");
                                        this.ssid = this.currentssid;
                                        resolve("");
                                    })).catch(err => {
                                        var d = new Date();
                                        this.appelOnConnectModbus = false;
                                        this.logs.push(this.msToTime(d.getTime()) + " - connexion Modbus échouée");
                                        resolve("");
                                    });
                                }
                                else { //ssid non vide  
                                    var d = new Date();
                                    this.logs.push(this.msToTime(d.getTime()) + " - ssid stocké non vide");
                                    if (this.currentssid == this.ssid) { //le ssid du réseau auquel on est connecté est le même que celui de la ceinture sélectionnée
                                        var d = new Date();
                                        this.logs.push(this.msToTime(d.getTime()) + " - ssid courant = ssid stocké");
                                        this.appelOnConnectModbus = true;
                                        this.onConnectModbus().then(() => {
                                            this.appelOnConnectModbus = false;
                                            this.logs.push(this.msToTime(d.getTime()) + " - statut connexion devient UPC");
                                            this.statutConnexion = "UPC";
                                            resolve("");
                                        }).catch(err => {
                                            var d = new Date();
                                            this.appelOnConnectModbus = false;
                                            this.logs.push(this.msToTime(d.getTime()) + " - connexion Modbus échouée");
                                            resolve("");
                                        });
                                    }
                                    else { //le ssid du réseau auquel on est connecté est différent de celui de la ceinture sélectionnée
                                        var d = new Date();
                                        this.logs.push(this.msToTime(d.getTime()) + " - ssid courant != ssid stocké");
                                        if (this.platform.is("android")) {
                                            this.logs.push(this.msToTime(d.getTime()) + " - android");
                                            () => tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
                                                var d = new Date();
                                                this.logs.push(this.msToTime(d.getTime()) + " - in async");
                                                this.appelOnConnectModbus = true;
                                                this.onConnectModbus().then(() => tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
                                                    this.appelOnConnectModbus = false;
                                                    this.logs.push(this.msToTime(d.getTime()) + " - connexion Modbus réussie");
                                                    yield this.storage.set("ssid", this.currentssid); //le ssid par défaut devient celui auquel on est connecté
                                                    this.logs.push(this.msToTime(d.getTime()) + " - ssid stocké devient ssid connecté");
                                                    this.ssid = this.currentssid;
                                                    resolve("");
                                                })).catch(err => {
                                                    var d = new Date();
                                                    this.statutConnexion = "Aucune";
                                                    this.logs.push(this.msToTime(d.getTime()) + " - statut connexion : Aucune ");
                                                    this.logs.push(this.msToTime(d.getTime()) + " - présentation alerte connexion upc : ");
                                                    if (!window.confirm("La page a besoin d'être connecté à l'UPC. Connectez-vous à l'UPC puis appuyez sur 'OK'.")) {
                                                        var d = new Date();
                                                        this.logs.push(this.msToTime(d.getTime()) + " - réponse utilisateur : annuler");
                                                        this.connexionRequise = "Aucune";
                                                        resolve("");
                                                    }
                                                    else {
                                                        var d = new Date();
                                                        this.logs.push(this.msToTime(d.getTime()) + " - réponse utilisateur : OK");
                                                        resolve("");
                                                    }
                                                });
                                            });
                                            /*}).catch(err=>{
                                              var d=new Date()
                                              this.logs.push(this.msToTime(d.getTime())+" - déconnexion du point d'accès échouée : "+JSON.stringify(err))
                                              resolve("")
                                            })*/
                                        }
                                        else {
                                            if (this.platform.is("ios")) {
                                                () => tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
                                                    var password = yield this.storage.get("password");
                                                    var d = new Date();
                                                    this.logs.push(this.msToTime(d.getTime()) + " - ios");
                                                    this.appelOnConnectModbus = true;
                                                    this.onConnectModbus().then((res) => tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
                                                        var d = new Date();
                                                        this.appelOnConnectModbus = false;
                                                        this.logs.push(this.msToTime(d.getTime()) + " - connexion Modbus réussie");
                                                        yield this.storage.set("ssid", this.currentssid); //le ssid par défaut devient celui auquel on est connecté
                                                        this.logs.push(this.msToTime(d.getTime()) + " - ssid stocké devient ssid connecté");
                                                        this.currentssid = this.ssid;
                                                        resolve("");
                                                    })).catch(err => {
                                                        var d = new Date();
                                                        this.appelOnConnectModbus = false;
                                                        this.logs.push(this.msToTime(d.getTime()) + " - connexion Modbus échouée");
                                                        resolve("");
                                                    });
                                                });
                                            }
                                        }
                                    }
                                }
                            }).catch(() => {
                                var d = new Date();
                                this.logs.push(this.msToTime(d.getTime()) + " - wifi non connecté");
                                if (this.ssid == undefined || this.ssid == "") { //ssid vide 
                                    this.statutConnexion = "Aucune";
                                    var d = new Date();
                                    this.logs.push(this.msToTime(d.getTime()) + " - statut connexion : Aucune ");
                                    this.logs.push(this.msToTime(d.getTime()) + " - présentation alerte connexion upc : ");
                                    if (!window.confirm("La page a besoin d'être connecté à l'UPC. Connectez-vous à l'UPC puis appuyez sur 'OK'.")) {
                                        var d = new Date();
                                        this.logs.push(this.msToTime(d.getTime()) + " - réponse utilisateur : annuler");
                                        this.connexionRequise = "Aucune";
                                        resolve("");
                                    }
                                    else {
                                        var d = new Date();
                                        this.logs.push(this.msToTime(d.getTime()) + " - réponse utilisateur : OK");
                                        resolve("");
                                    }
                                }
                                else { //ssid non vide                   
                                    WifiWizard2.disconnect().then(() => tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
                                        var d = new Date();
                                        this.logs.push(this.msToTime(d.getTime()) + " - déconnexion du point d'accès réussie");
                                        var password = yield this.storage.get("password");
                                        WifiWizard2.connect(this.ssid, password).then(res => {
                                            var d = new Date();
                                            this.logs.push(this.msToTime(d.getTime()) + " - connexion au point d'accès réussie");
                                            this.currentssid = this.ssid;
                                            this.logs.push(this.msToTime(d.getTime()) + " - current ssid : " + this.ssid);
                                            this.appelOnConnectModbus = true;
                                            this.onConnectModbus().then(res => {
                                                //connexion modbus réussie   
                                                var d = new Date();
                                                this.appelOnConnectModbus = false;
                                                this.logs.push(this.msToTime(d.getTime()) + " - connexion Modbus réussie");
                                                this.logs.push(this.msToTime(d.getTime()) + " - current ssid = ssid connecté");
                                                this.currentssid = this.ssid;
                                                resolve("");
                                            }).catch(err => {
                                                var d = new Date();
                                                this.appelOnConnectModbus = false;
                                                this.logs.push(this.msToTime(d.getTime()) + " - connexion Modbus échouée");
                                                resolve("");
                                            });
                                        }).catch(err => {
                                            this.perteConnexion = true;
                                            var d = new Date();
                                            this.logs.push(this.msToTime(d.getTime()) + " - connexion au point d'accès échouée : " + JSON.stringify(err));
                                            this.statutConnexion = "Aucune";
                                            this.logs.push(this.msToTime(d.getTime()) + " - statut connexion : Aucune ");
                                            this.logs.push(this.msToTime(d.getTime()) + " - présentation alerte connexion upc : ");
                                            if (!window.confirm("La page a besoin d'être connecté à l'UPC. Connectez-vous à l'UPC puis appuyez sur 'OK'.")) {
                                                var d = new Date();
                                                this.logs.push(this.msToTime(d.getTime()) + " - réponse utilisateur : annuler");
                                                this.connexionRequise = "Aucune";
                                                resolve("");
                                            }
                                            else {
                                                var d = new Date();
                                                this.logs.push(this.msToTime(d.getTime()) + " - réponse utilisateur : OK");
                                                resolve("");
                                            }
                                        });
                                    })).catch(err => {
                                        var d = new Date();
                                        this.logs.push(this.msToTime(d.getTime()) + " - déconnexion du point d'accès échouée : " + JSON.stringify(err));
                                        resolve("");
                                    });
                                    resolve("");
                                }
                            });
                        }
                        else { //WIFI désactivé
                            var d = new Date();
                            this.logs.push(this.msToTime(d.getTime()) + " - wifi désactivé");
                            if (this.ssid == undefined || this.ssid == "") { //ssid vide
                                var d = new Date();
                                this.logs.push(this.msToTime(d.getTime()) + " - ssid vide : " + this.ssid);
                                this.logs.push(this.msToTime(d.getTime()) + " - statut connexion : Aucune ");
                                this.statutConnexion = "Aucune";
                                var d = new Date();
                                this.logs.push(this.msToTime(d.getTime()) + " - présentation alerte connexion upc : ");
                                if (!window.confirm("La page a besoin d'être connecté à l'UPC. Connectez-vous à l'UPC puis appuyez sur 'OK'.")) {
                                    var d = new Date();
                                    this.logs.push(this.msToTime(d.getTime()) + " - réponse utilisateur : annuler");
                                    this.connexionRequise = "Aucune";
                                    resolve("");
                                }
                                else {
                                    var d = new Date();
                                    this.logs.push(this.msToTime(d.getTime()) + " - réponse utilisateur : OK");
                                    resolve("");
                                }
                            }
                            else { //ssid non vide
                                var d = new Date();
                                this.logs.push(this.msToTime(d.getTime()) + " - ssid stocké non vide");
                                this.storage.get("password").then(res => {
                                    var password = res;
                                    if (this.platform.is("android")) {
                                        this.logs.push(this.msToTime(d.getTime()) + " - ssid : " + this.ssid + " - password : " + password);
                                        WifiWizard2.connect(this.ssid, password).then(() => {
                                            var d = new Date();
                                            this.logs.push(this.msToTime(d.getTime()) + " - connexion au point d'accès réussie");
                                            this.currentssid = this.ssid;
                                            this.logs.push(this.msToTime(d.getTime()) + " - current ssid : " + this.ssid);
                                            this.appelOnConnectModbus = true;
                                            this.onConnectModbus().then(() => {
                                                var d = new Date();
                                                this.appelOnConnectModbus = false;
                                                this.logs.push(this.msToTime(d.getTime()) + " - connexion Modbus réussie");
                                                this.logs.push(this.msToTime(d.getTime()) + " - current ssid = ssid connecté");
                                                this.currentssid = this.ssid;
                                                resolve("");
                                            }).catch(err => {
                                                var d = new Date();
                                                this.appelOnConnectModbus = false;
                                                this.logs.push(this.msToTime(d.getTime()) + " - connexion Modbus échouée");
                                                resolve("");
                                            });
                                        }).catch(err => {
                                            this.perteConnexion = true;
                                            var d = new Date();
                                            this.logs.push(this.msToTime(d.getTime()) + " - connexion au point d'accès échouée : " + JSON.stringify(err));
                                            this.statutConnexion = "Aucune";
                                            this.logs.push(this.msToTime(d.getTime()) + " - statut connexion : Aucune ");
                                            this.logs.push(this.msToTime(d.getTime()) + " - présentation alerte connexion upc : ");
                                            if (!window.confirm("La page a besoin d'être connecté à l'UPC. Connectez-vous à l'UPC puis appuyez sur 'OK'.")) {
                                                var d = new Date();
                                                this.logs.push(this.msToTime(d.getTime()) + " - réponse utilisateur : annuler");
                                                this.connexionRequise = "Aucune";
                                                resolve("");
                                            }
                                            else {
                                                var d = new Date();
                                                this.logs.push(this.msToTime(d.getTime()) + " - réponse utilisateur : OK");
                                                resolve("");
                                            }
                                        });
                                    }
                                    else {
                                        WifiWizard2.iOSDisconnectNetwork(this.ssid).then(() => tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
                                            var d = new Date();
                                            var password = yield this.storage.get("password");
                                            this.logs.push(this.msToTime(d.getTime()) + " - déconnexion du point d'accès réussie");
                                            WifiWizard2.iOSConnectNetwork(this.ssid, password).then(() => {
                                                var d = new Date();
                                                this.logs.push(this.msToTime(d.getTime()) + " - connexion au point d'accès réussie");
                                                this.appelOnConnectModbus = true;
                                                this.onConnectModbus().then(res => {
                                                    var d = new Date();
                                                    this.appelOnConnectModbus = false;
                                                    this.logs.push(this.msToTime(d.getTime()) + " - connexion Modbus réussie");
                                                    this.logs.push(this.msToTime(d.getTime()) + " - current ssid = ssid connecté");
                                                    this.currentssid = this.ssid;
                                                    resolve("");
                                                }).catch(err => {
                                                    var d = new Date();
                                                    this.appelOnConnectModbus = false;
                                                    this.logs.push(this.msToTime(d.getTime()) + " - connexion Modbus échouée");
                                                    resolve("");
                                                });
                                            }).catch(err => {
                                                var d = new Date();
                                                this.logs.push(this.msToTime(d.getTime()) + " - connexion au point d'accès échouée : " + JSON.stringify(err));
                                                this.statutConnexion = "Aucune";
                                                this.logs.push(this.msToTime(d.getTime()) + " - statut connexion : Aucune ");
                                                this.logs.push(this.msToTime(d.getTime()) + " - présentation alerte connexion upc : ");
                                                if (!window.confirm("La page a besoin d'être connecté à l'UPC. Connectez-vous à l'UPC puis appuyez sur 'OK'.")) {
                                                    var d = new Date();
                                                    this.logs.push(this.msToTime(d.getTime()) + " - réponse utilisateur : annuler");
                                                    this.connexionRequise = "Aucune";
                                                    resolve("");
                                                }
                                                else {
                                                    var d = new Date();
                                                    this.logs.push(this.msToTime(d.getTime()) + " - réponse utilisateur : OK");
                                                    resolve("");
                                                }
                                            });
                                        }));
                                    }
                                });
                            }
                        }
                    }).catch(err => {
                        var d = new Date();
                        this.logs.push(this.msToTime(d.getTime()) + " - Erreur fonction isWifiEnabled : " + JSON.stringify(err));
                        resolve("");
                    });
                });
            }
            if (this.connexionRequise == "Serveur") {
                var d = new Date();
                this.logs.push(this.msToTime(d.getTime()) + " - connexion requise : serveur");
                if (error.status == 403) {
                    this.login();
                }
                else {
                    if (error.statusText == "Unknown Error") {
                        this.logs.push(JSON.stringify(error));
                        if (window.confirm("Une connexion internet est requise pour cette page. Raccordez-vous à internet puis appuyez sur 'OK'.")) {
                            resolve("retry");
                        }
                        else {
                            this.connexionRequise = "Aucune";
                            resolve("cancel");
                        }
                    }
                    if (error == "UPC") {
                        WifiWizard2.disconnect().then(() => {
                            this.statutConnexion = "Aucune";
                            var d = new Date();
                            this.logs.push(this.msToTime(d.getTime()) + " - statut connexion : Aucune ");
                        }).catch(() => {
                            if (window.confirm("Une connexion internet est requise pour cette page. Raccordez-vous à internet puis appuyez sur 'OK'.")) {
                                resolve("retry");
                            }
                            else {
                                this.connexionRequise = "Aucune";
                                resolve("cancel");
                            }
                        });
                    }
                }
            }
        }));
    }
    onReadStatiqueEnable() {
        return new Promise((resolve, reject) => tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            var d = new Date();
            this.logs.push(this.msToTime(d.getTime()) + " - appel onReadStatiqueEnable ");
            this.logs.push(this.msToTime(d.getTime()) + " - flags onReadStatiqueEnable :");
            this.logs.push(this.msToTime(d.getTime()) + " - lecture cyclique : " + this.lectureCycliqueEnCours);
            this.logs.push(this.msToTime(d.getTime()) + " - ecriture : " + this.ecritureEnCours);
            this.logs.push(this.msToTime(d.getTime()) + " - onConnect : " + this.onConnectEnCours);
            this.logs.push(this.msToTime(d.getTime()) + " - statut connexion : " + this.statutConnexion);
            this.lectureStatiqueEnCours = true;
            if (this.ecritureEnCours == true || this.lectureCycliqueEnCours == true || this.onConnectEnCours == true || this.statutConnexion != "UPC") {
                this.lectureStatiqueEnCours = false;
                var d = new Date();
                this.logs.push(this.msToTime(d.getTime()) + " -attente onReadStatique ");
                this.onWait(50, 60000, "onReadStatiqueEnable").then(() => {
                    var d = new Date();
                    this.logs.push(this.msToTime(d.getTime()) + " - fin d'attente onReadStatique ");
                    //var d=new Date() 
                    //this.logs.push(this.msToTime(d.getTime())+" - statut connexion = UPC")           
                    if (this.upcmodbus != undefined) {
                        this.storage.get("upcname").then(res => {
                            this.upcname = res;
                            var d = new Date();
                            this.logs.push(this.msToTime(d.getTime()) + " - appel fonction onReadStatique");
                            this.logs.push(this.msToTime(d.getTime()) + " - lectureCycliqueEnCours : " + this.lectureCycliqueEnCours);
                            const url = this.router.url;
                            const splittedUrl = url.split("/");
                            const urlFinal = splittedUrl[1];
                            this.logs.push(this.msToTime(d.getTime()) + " - page : " + urlFinal);
                            this.upcmodbus.onReadStatique(this.upcname, this.mode, urlFinal).then(res => {
                                if (res == true) {
                                    //var d=new Date()
                                    //this.logs.push(this.msToTime(d.getTime())+" - lecture réussie")
                                    this.events.publish("loadParameters");
                                    this.lectureStatiqueEnCours = false;
                                    var d = new Date();
                                    this.logs.push("durée lecture statique : " + (d.getTime() - this.startReadDate.getTime()));
                                    resolve();
                                }
                                else {
                                    if (res == "Terminer l'intervention en cours") {
                                        var d = new Date();
                                        this.logs.push(this.msToTime(d.getTime()) + " - Terminer l'intervention en cours");
                                        this.router.navigate(["finintervention"]);
                                        this.lectureStatiqueEnCours = false;
                                        resolve();
                                    }
                                    else {
                                        if (res == "Abandonner l'intervention en cours") {
                                            var d = new Date();
                                            this.logs.push(this.msToTime(d.getTime()) + " - Abandonner l'intervention en cours");
                                            this.resetParameters().then(() => {
                                                this.router.navigate(["home"]);
                                                this.lectureStatiqueEnCours = false;
                                                resolve();
                                            });
                                        }
                                        else {
                                            if (res == "Se rapprocher de l'upc") {
                                                var d = new Date();
                                                this.logs.push(this.msToTime(d.getTime()) + " - Se rapprocher de l'upc");
                                                resolve();
                                            }
                                            else {
                                                if (res.object.errCode != undefined) {
                                                    var d = new Date();
                                                    this.logs.push(this.msToTime(d.getTime()) + " - " + res.object.errCode + " - bloc :" + res.object.bloc);
                                                    this.logs.push(this.msToTime(d.getTime()) + " - statut connexion : Aucune ");
                                                    this.statutConnexion = "Aucune";
                                                    //this.onConnect(res.object.errCode).then(res=>{
                                                    this.lectureStatiqueEnCours = false;
                                                    resolve();
                                                    //})    
                                                }
                                                else {
                                                    var d = new Date();
                                                    this.logs.push(this.msToTime(d.getTime()) + " - " + JSON.stringify(res.object) + " - bloc :" + res.object.bloc);
                                                    this.logs.push(this.msToTime(d.getTime()) + " - statut connexion : Aucune ");
                                                    this.statutConnexion = "Aucune";
                                                    //this.onConnect(res.object.errCode).then(res=>{
                                                    this.lectureStatiqueEnCours = false;
                                                    resolve();
                                                    //})  
                                                }
                                            }
                                        }
                                    }
                                }
                            }).catch(err => {
                                var d = new Date();
                                this.logs.push(this.msToTime(d.getTime()) + " - catch onReadStatique : " + JSON.stringify(err));
                                this.lectureStatiqueEnCours = false;
                                reject();
                            });
                        });
                    }
                    else {
                        var d = new Date();
                        this.logs.push(this.msToTime(d.getTime()) + " - upcmodbus undefined");
                        this.lectureStatiqueEnCours = false;
                        resolve();
                    }
                }).catch(() => {
                    alert("lecture impossible");
                    reject();
                });
            }
            else {
                /* pas de lecture cyclique en cours ni d'écriture ni de onConnect donc lecture statique possible */
                //var d=new Date() 
                //this.logs.push(this.msToTime(d.getTime())+" - statut connexion = UPC")           
                if (this.upcmodbus != undefined) {
                    this.storage.get("upcname").then(res => {
                        this.upcname = res;
                        var d = new Date();
                        this.logs.push(this.msToTime(d.getTime()) + " - appel fonction onReadStatique");
                        this.logs.push(this.msToTime(d.getTime()) + " - lectureCycliqueEnCours : " + this.lectureCycliqueEnCours);
                        const url = this.router.url;
                        const splittedUrl = url.split("/");
                        const urlFinal = splittedUrl[1];
                        this.logs.push(this.msToTime(d.getTime()) + " - page : " + urlFinal);
                        this.upcmodbus.onReadStatique(this.upcname, this.mode, urlFinal).then(res => {
                            if (res == true) {
                                //var d=new Date()
                                //this.logs.push(this.msToTime(d.getTime())+" - lecture réussie")
                                this.events.publish("loadParameters");
                                this.lectureStatiqueEnCours = false;
                                var d = new Date();
                                this.logs.push("durée lecture statique : " + (d.getTime() - this.startReadDate.getTime()));
                                resolve();
                            }
                            else {
                                if (res == "Terminer l'intervention en cours") {
                                    var d = new Date();
                                    this.logs.push(this.msToTime(d.getTime()) + " - Terminer l'intervention en cours");
                                    this.router.navigate(["finintervention"]);
                                    this.lectureStatiqueEnCours = false;
                                    resolve();
                                }
                                else {
                                    if (res == "Abandonner l'intervention en cours") {
                                        var d = new Date();
                                        this.logs.push(this.msToTime(d.getTime()) + " - Abandonner l'intervention en cours");
                                        this.resetParameters().then(() => {
                                            this.router.navigate(["home"]);
                                            this.lectureStatiqueEnCours = false;
                                            resolve();
                                        });
                                    }
                                    else {
                                        if (res == "Se rapprocher de l'upc") {
                                            var d = new Date();
                                            this.logs.push(this.msToTime(d.getTime()) + " - Se rapprocher de l'upc");
                                            resolve();
                                        }
                                        else {
                                            if (res.object.errCode != undefined) {
                                                var d = new Date();
                                                this.logs.push(this.msToTime(d.getTime()) + " - " + res.object.errCode + " - bloc :" + res.object.bloc);
                                                this.logs.push(this.msToTime(d.getTime()) + " - statut connexion : Aucune ");
                                                this.statutConnexion = "Aucune";
                                                //this.onConnect(res.object.errCode).then(res=>{
                                                this.lectureStatiqueEnCours = false;
                                                resolve();
                                                //})    
                                            }
                                            else {
                                                var d = new Date();
                                                this.logs.push(this.msToTime(d.getTime()) + " - " + JSON.stringify(res.object) + " - bloc :" + res.object.bloc);
                                                this.logs.push(this.msToTime(d.getTime()) + " - statut connexion : Aucune ");
                                                this.statutConnexion = "Aucune";
                                                //this.onConnect(res.object.errCode).then(res=>{
                                                this.lectureStatiqueEnCours = false;
                                                resolve();
                                                //})  
                                            }
                                        }
                                    }
                                }
                            }
                        }).catch(err => {
                            var d = new Date();
                            this.logs.push(this.msToTime(d.getTime()) + " - catch onReadStatique : " + JSON.stringify(err));
                            //this.onConnect("UPC")  
                            this.lectureStatiqueEnCours = false;
                            reject();
                        });
                    });
                }
                else {
                    var d = new Date();
                    this.logs.push(this.msToTime(d.getTime()) + " - upcmodbus undefined 2");
                    //this.onConnect("UPC").then(()=>{
                    this.lectureStatiqueEnCours = false;
                    resolve();
                    //})   
                }
            }
        }));
    }
    onReadCycliqueEnable() {
        return new Promise((resolve, reject) => tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            //var d=new Date()    
            //this.logs.push(this.msToTime(d.getTime())+" - onReadModbusVariables")
            if (this.statutConnexion == "UPC") {
                //var d=new Date() 
                //this.logs.push(this.msToTime(d.getTime())+" - statut connexion = UPC")           
                if (this.upcmodbus != undefined) {
                    this.storage.get("upcname").then(res => {
                        this.upcname = res;
                        //var d=new Date()
                        //this.logs.push(this.msToTime(d.getTime())+" - appel fonction readAllReg cas 1 : "+res)  
                        const url = this.router.url;
                        const splittedUrl = url.split("/");
                        const urlFinal = splittedUrl[1];
                        this.upcmodbus.onReadCyclique(this.upcname, this.mode, urlFinal).then(res => {
                            if (res == true) {
                                //var d=new Date()
                                //this.logs.push(this.msToTime(d.getTime())+" - lecture réussie")
                                this.events.publish("loadParameters");
                                this.lectureCycliqueEnCours = false;
                                var d = new Date();
                                this.logs.push("durée lecture : " + (d.getTime() - this.startReadDate.getTime()));
                                resolve();
                            }
                            else {
                                if (res.object.errCode != undefined) {
                                    var d = new Date();
                                    this.logs.push(this.msToTime(d.getTime()) + " - " + res.object.errCode + " - bloc :" + res.object.bloc);
                                    this.logs.push(this.msToTime(d.getTime()) + " - statut connexion : Aucune ");
                                    this.statutConnexion = "Aucune";
                                    if (this.onConnectEnCours == false) {
                                        this.onConnect(res.object.errCode).then(res => {
                                            this.onConnectEnCours = false;
                                            resolve();
                                        });
                                    }
                                    else {
                                        resolve();
                                    }
                                }
                                else {
                                    var d = new Date();
                                    this.logs.push(this.msToTime(d.getTime()) + " - " + JSON.stringify(res.object) + " - bloc :" + res.object.bloc);
                                    this.logs.push(this.msToTime(d.getTime()) + " - statut connexion : Aucune ");
                                    this.statutConnexion = "Aucune";
                                    if (this.onConnectEnCours == false) {
                                        this.onConnect(res.object.errCode).then(res => {
                                            this.onConnectEnCours = false;
                                            resolve();
                                        });
                                    }
                                    else {
                                        resolve();
                                    }
                                }
                            }
                        }).catch(err => {
                            var d = new Date();
                            this.logs.push(this.msToTime(d.getTime()) + " - catch onReadCyclique");
                            if (this.onConnectEnCours == false) {
                                this.onConnect("UPC").then(res => {
                                    this.onConnectEnCours = false;
                                    resolve();
                                });
                            }
                            else {
                                resolve();
                            }
                        });
                    });
                }
                else {
                    var d = new Date();
                    this.logs.push(this.msToTime(d.getTime()) + " - upcmodbus undefined");
                    if (this.onConnectEnCours == false) {
                        this.onConnect("UPC").then(() => {
                            this.onConnectEnCours = false;
                            resolve();
                        });
                    }
                    else {
                        resolve();
                    }
                }
            }
            else {
                var d = new Date();
                this.logs.push(this.msToTime(d.getTime()) + " - statut connexion != UPC");
                if (this.connexionRequise == "UPC") {
                    if (this.onConnectEnCours == false) {
                        this.onConnect("UPC").then(() => {
                            this.onConnectEnCours = false;
                            resolve();
                        });
                    }
                    else {
                        resolve();
                    }
                }
                else {
                    resolve();
                }
            }
        }));
    }
    onWriteEnable(variable, value) {
        return new Promise((resolve, reject) => tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            var d = new Date();
            this.logs.push(this.msToTime(d.getTime()) + " - appel onWriteEnable ");
            this.logs.push(this.msToTime(d.getTime()) + " - flags onWriteEnable :");
            this.logs.push(this.msToTime(d.getTime()) + " - lecture cyclique : " + this.lectureCycliqueEnCours);
            this.logs.push(this.msToTime(d.getTime()) + " - lecture statique : " + this.lectureStatiqueEnCours);
            this.logs.push(this.msToTime(d.getTime()) + " - ecriture : " + this.ecritureEnCours);
            this.logs.push(this.msToTime(d.getTime()) + " - onConnect : " + this.onConnectEnCours);
            this.logs.push(this.msToTime(d.getTime()) + " - statut connexion : " + this.statutConnexion);
            this.ecritureEnCours = true;
            if (this.statutConnexion != "UPC" || this.lectureCycliqueEnCours == true || this.lectureStatiqueEnCours == true || this.onConnectEnCours == true) {
                this.ecritureEnCours = false;
                var d = new Date();
                this.logs.push(this.msToTime(d.getTime()) + " - lecture en cours : " + this.lectureCycliqueEnCours);
                this.onWait(50, 60000, "onWriteEnable").then(() => {
                    if (variable.type == "int") {
                        this.upcmodbus.client.setIntInHoldingRegister(variable.adr, variable.dim, value).then(() => {
                            var d = new Date();
                            this.logs.push(this.msToTime(d.getTime()) + " - écriture réussie");
                            this.ecritureEnCours = false;
                            this.needToCheckFlags = false;
                            this.onReadStatiqueEnable().then(() => {
                                resolve();
                            }).catch(() => {
                                alert("lecture impossible");
                                reject();
                            });
                        }).catch(() => {
                            alert("écriture impossible");
                            reject();
                        });
                    }
                    if (variable.type == "string") {
                        this.upcmodbus.client.setStringInHoldingRegister(variable.adr, value).then(() => {
                            var d = new Date();
                            this.logs.push(this.msToTime(d.getTime()) + " - écriture réussie");
                            this.ecritureEnCours = false;
                            this.needToCheckFlags = false;
                            this.onReadStatiqueEnable().then(() => {
                                resolve();
                            }).catch(() => {
                                alert("lecture impossible");
                                reject();
                            });
                        }).catch(() => {
                            alert("écriture impossible");
                            reject();
                        });
                    }
                    if (variable.type == "float") {
                        this.upcmodbus.client.setFloatInHoldingRegister(variable.adr, value).then(() => {
                            var d = new Date();
                            this.logs.push(this.msToTime(d.getTime()) + " - écriture réussie");
                            this.ecritureEnCours = false;
                            this.needToCheckFlags = false;
                            this.onReadStatiqueEnable().then(() => {
                                resolve();
                            }).catch(() => {
                                alert("lecture impossible");
                                reject();
                            });
                        }).catch(() => {
                            alert("écriture impossible");
                            reject();
                        });
                    }
                }).catch(() => {
                    alert("écriture impossible");
                    reject();
                });
            }
            else {
                //if(this.lectureCycliqueEnCours != true && this.lectureStatiqueEnCours != true){
                var d = new Date();
                this.logs.push(this.msToTime(d.getTime()) + " - pas de lecture en cours, écriture possible");
                if (variable.type == "int") {
                    this.upcmodbus.client.setIntInHoldingRegister(variable.adr, variable.dim, value).then(() => {
                        var d = new Date();
                        this.logs.push(this.msToTime(d.getTime()) + " - écriture réussie");
                        this.ecritureEnCours = false;
                        this.needToCheckFlags = false;
                        this.onReadStatiqueEnable().then(() => {
                            resolve();
                        }).catch(() => {
                            alert("lecture impossible");
                            reject();
                        });
                    }).catch(() => {
                        alert("écriture impossible");
                        reject();
                    });
                }
                if (variable.type == "string") {
                    this.upcmodbus.client.setStringInHoldingRegister(variable.adr, value).then(() => {
                        var d = new Date();
                        this.logs.push(this.msToTime(d.getTime()) + " - écriture réussie");
                        this.ecritureEnCours = false;
                        this.needToCheckFlags = false;
                        this.onReadStatiqueEnable().then(() => {
                            resolve();
                        }).catch(() => {
                            alert("lecture impossible");
                            reject();
                        });
                    }).catch(() => {
                        alert("écriture impossible");
                        reject();
                    });
                }
                if (variable.type == "float") {
                    this.upcmodbus.client.setFloatInHoldingRegister(variable.adr, value).then(() => {
                        var d = new Date();
                        this.logs.push(this.msToTime(d.getTime()) + " - écriture réussie");
                        this.ecritureEnCours = false;
                        this.needToCheckFlags = false;
                        this.onReadStatiqueEnable().then(() => {
                            resolve();
                        }).catch(() => {
                            alert("lecture impossible");
                            reject();
                        });
                    }).catch(() => {
                        alert("écriture impossible");
                        reject();
                    });
                }
            }
        }));
    }
    onWait(loopDelay, timeoutDelay, func) {
        return new Promise((resolve, reject) => tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            this.needToCheckFlags = true;
            switch (func) {
                case "onWriteEnable":
                    this.intv = setInterval(() => {
                        if (this.statutConnexion == "UPC" && this.lectureCycliqueEnCours != true && this.lectureStatiqueEnCours != true && this.onConnectEnCours != true && this.ecritureEnCours != true) {
                            this.global.ecritureEnCours = true;
                            this.needToCheckFlags = false;
                            var d = new Date();
                            this.logs.push(this.msToTime(d.getTime()) + " - fin lecture en cours - écriture possible");
                            clearInterval(this.intv);
                            resolve();
                        }
                    }, loopDelay);
                    setTimeout(() => {
                        if (this.needToCheckFlags == true) {
                            if (this.lectureCycliqueEnCours == true || this.lectureStatiqueEnCours == true || this.onConnectEnCours == true || this.ecritureEnCours == true) {
                                this.needToCheckFlags = false;
                                clearInterval(this.intv);
                                var d = new Date();
                                this.logs.push(this.msToTime(d.getTime()) + " - écriture impossible - fin de timer");
                                reject();
                            }
                        }
                    }, timeoutDelay);
                    break;
                case "onReadStatiqueEnable":
                    this.intv = setInterval(() => {
                        if (this.statutConnexion == "UPC" && this.lectureCycliqueEnCours != true && this.ecritureEnCours != true && this.onConnectEnCours != true) {
                            this.lectureStatiqueEnCours = true;
                            this.needToCheckFlags = false;
                            var d = new Date();
                            this.logs.push(this.msToTime(d.getTime()) + " - lecture statique possible");
                            clearInterval(this.intv);
                            resolve();
                        }
                    }, loopDelay);
                    setTimeout(() => {
                        if (this.needToCheckFlags == true) {
                            if (this.lectureCycliqueEnCours == true || this.ecritureEnCours == true || this.onConnectEnCours == true || this.statutConnexion != "UPC") {
                                this.needToCheckFlags = false;
                                clearInterval(this.intv);
                                var d = new Date();
                                this.logs.push(this.msToTime(d.getTime()) + " - lecture statique impossible - fin de timer");
                                reject();
                            }
                        }
                    }, timeoutDelay);
                    break;
            }
        }));
    }
    login() {
        return new Promise((resolve, reject) => tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            this.storage.get("user").then(res => {
                this.username = res;
                this.storage.get("pass").then(res => {
                    this.password = res;
                    var user = new _model_user__WEBPACK_IMPORTED_MODULE_7__["User"]();
                    user.username = this.username;
                    user.password = this.password;
                    this.upc3serv.login(user).subscribe((res) => tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
                        this.storage.set("token", res.result).then(() => {
                            resolve();
                        });
                    }), err => {
                        this.onConnect(err).then(res => {
                            resolve();
                        })
                            .catch(res => { resolve(); });
                    });
                });
            });
        }));
    }
    onConnectModbus() {
        this.logs.push("onConnectModbus");
        return new Promise((resolve, reject) => tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            if (this.upcmodbus != undefined) {
                this.upcmodbus.client.close();
                this.upcmodbus = new _model_upcv3_upcmodbus__WEBPACK_IMPORTED_MODULE_5__["UPCModbus"](state => {
                    if (this.appelOnConnectModbus == true) {
                        this.needToCheckState = true;
                        var d = new Date();
                        this.logs.push(this.msToTime(d.getTime()) + " - state : " + state);
                        let i = setInterval(() => {
                            if (state == 1) {
                                this.statutConnexion = "UPC";
                                var d = new Date();
                                this.logs.push(this.msToTime(d.getTime()) + " - statut connexion : UPC ");
                                this.needToCheckState = false;
                                clearInterval(i);
                                resolve();
                            }
                        }, 50);
                        setTimeout(() => {
                            if (this.needToCheckState == true) {
                                if (state == 1) {
                                    this.statutConnexion = "UPC";
                                    var d = new Date();
                                    this.logs.push(this.msToTime(d.getTime()) + " - statut connexion : UPC (fin de timer) ");
                                    this.needToCheckState = false;
                                    clearInterval(i);
                                    resolve();
                                }
                                else {
                                    this.statutConnexion = "Aucune";
                                    var d = new Date();
                                    this.logs.push(this.msToTime(d.getTime()) + " - appelOnConnectModbus : " + this.appelOnConnectModbus);
                                    this.logs.push(this.msToTime(d.getTime()) + " - statut connexion : aucune (fin de timer) ");
                                    this.needToCheckState = false;
                                    clearInterval(i);
                                    reject();
                                }
                            }
                        }, 60000);
                    }
                });
            }
            else {
                this.upcmodbus = new _model_upcv3_upcmodbus__WEBPACK_IMPORTED_MODULE_5__["UPCModbus"](state => {
                    if (this.appelOnConnectModbus == true) {
                        this.needToCheckState = true;
                        var d = new Date();
                        this.logs.push(this.msToTime(d.getTime()) + " - state : " + state);
                        let i = setInterval(() => {
                            if (state == 1) {
                                this.statutConnexion = "UPC";
                                var d = new Date();
                                this.logs.push(this.msToTime(d.getTime()) + " - appelOnConnectModbus : " + this.appelOnConnectModbus);
                                this.logs.push(this.msToTime(d.getTime()) + " - statut connexion : UPC ");
                                this.needToCheckState = false;
                                this.storage.set("ssid", this.currentssid);
                                clearInterval(i);
                                resolve();
                            }
                            else {
                                return;
                            }
                        }, 50);
                        setTimeout(() => {
                            if (this.needToCheckState == true) {
                                if (state == 1) {
                                    this.statutConnexion = "UPC";
                                    var d = new Date();
                                    this.logs.push(this.msToTime(d.getTime()) + " - appelOnConnectModbus : " + this.appelOnConnectModbus);
                                    this.logs.push(this.msToTime(d.getTime()) + " - statut connexion : UPC (fin de timer) ");
                                    this.needToCheckState = false;
                                    clearInterval(i);
                                    resolve();
                                }
                                else {
                                    this.statutConnexion = "Aucune";
                                    var d = new Date();
                                    this.logs.push(this.msToTime(d.getTime()) + " - appelOnConnectModbus : " + this.appelOnConnectModbus);
                                    this.logs.push(this.msToTime(d.getTime()) + " - statut connexion : aucune (fin de timer) ");
                                    this.needToCheckState = false;
                                    clearInterval(i);
                                    reject();
                                }
                            }
                        }, 60000);
                    }
                });
            }
        }));
    }
    resetParameters() {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            var arr = yield Promise.all([
                yield this.storage.set("motiveItems", ""),
                yield this.storage.set("motiveString", ""),
                yield this.storage.set("intervenantsItems", ""),
                yield this.storage.set("intervenantsString", ""),
                yield this.storage.set("ceintureChoisieObject", ""),
                yield this.storage.set("ssid", ""),
                yield this.storage.set("password", ""),
                yield this.storage.set("currentssid", ""),
                yield this.storage.set("currentpassword", ""),
                yield this.storage.set("upcname", ""),
                yield this.storage.set("stockBottleTypes", ""),
                yield this.storage.set("ceintureChoisieBottles", ""),
                yield this.storage.set("commentaires", ""),
                yield this.storage.set("dataAlreadyLoaded", "false"),
                yield this.storage.set("json", ""),
                yield this.storage.set("isInterventionEnCours", false),
                yield this.storage.set("isInterventionNotSaved", false)
            ]);
            return arr;
        });
    }
    msToTime(duration) {
        var milliseconds;
        var seconds;
        var minutes;
        var hours;
        milliseconds = Math.floor((duration % 1000) / 100);
        seconds = Math.floor((duration / 1000) % 60);
        minutes = Math.floor((duration / (1000 * 60)) % 60);
        hours = Math.floor((duration / (1000 * 60 * 60)) % 24);
        hours = (hours < 10) ? "0" + hours : hours;
        minutes = (minutes < 10) ? "0" + minutes : minutes;
        seconds = (seconds < 10) ? "0" + seconds : seconds;
        return hours + ":" + minutes + ":" + seconds + "." + milliseconds;
    }
};
GlobalService.ctorParameters = () => [
    { type: _ionic_angular__WEBPACK_IMPORTED_MODULE_2__["Platform"] },
    { type: _ionic_angular__WEBPACK_IMPORTED_MODULE_2__["LoadingController"] },
    { type: _upcv3service_service__WEBPACK_IMPORTED_MODULE_3__["Upcv3serviceService"] },
    { type: _ionic_native_hotspot_ngx__WEBPACK_IMPORTED_MODULE_4__["Hotspot"] },
    { type: _angular_core__WEBPACK_IMPORTED_MODULE_1__["NgZone"] },
    { type: _ionic_storage__WEBPACK_IMPORTED_MODULE_6__["Storage"] },
    { type: _upcv3service_service__WEBPACK_IMPORTED_MODULE_3__["Upcv3serviceService"] },
    { type: _ionic_angular__WEBPACK_IMPORTED_MODULE_2__["ToastController"] },
    { type: _ionic_angular__WEBPACK_IMPORTED_MODULE_2__["AlertController"] },
    { type: _angular_router__WEBPACK_IMPORTED_MODULE_8__["Router"] },
    { type: _ionic_native_network_ngx__WEBPACK_IMPORTED_MODULE_9__["Network"] },
    { type: _ionic_native_diagnostic_ngx__WEBPACK_IMPORTED_MODULE_10__["Diagnostic"] },
    { type: _ionic_angular__WEBPACK_IMPORTED_MODULE_2__["Events"] }
];
GlobalService = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Injectable"])({
        providedIn: 'root'
    }),
    tslib__WEBPACK_IMPORTED_MODULE_0__["__metadata"]("design:paramtypes", [_ionic_angular__WEBPACK_IMPORTED_MODULE_2__["Platform"],
        _ionic_angular__WEBPACK_IMPORTED_MODULE_2__["LoadingController"],
        _upcv3service_service__WEBPACK_IMPORTED_MODULE_3__["Upcv3serviceService"],
        _ionic_native_hotspot_ngx__WEBPACK_IMPORTED_MODULE_4__["Hotspot"],
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["NgZone"],
        _ionic_storage__WEBPACK_IMPORTED_MODULE_6__["Storage"],
        _upcv3service_service__WEBPACK_IMPORTED_MODULE_3__["Upcv3serviceService"],
        _ionic_angular__WEBPACK_IMPORTED_MODULE_2__["ToastController"],
        _ionic_angular__WEBPACK_IMPORTED_MODULE_2__["AlertController"],
        _angular_router__WEBPACK_IMPORTED_MODULE_8__["Router"],
        _ionic_native_network_ngx__WEBPACK_IMPORTED_MODULE_9__["Network"],
        _ionic_native_diagnostic_ngx__WEBPACK_IMPORTED_MODULE_10__["Diagnostic"],
        _ionic_angular__WEBPACK_IMPORTED_MODULE_2__["Events"]])
], GlobalService);



/***/ }),

/***/ "./src/app/api/network.service.ts":
/*!****************************************!*\
  !*** ./src/app/api/network.service.ts ***!
  \****************************************/
/*! exports provided: ConnectionStatusEnum, NetworkService */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ConnectionStatusEnum", function() { return ConnectionStatusEnum; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "NetworkService", function() { return NetworkService; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm2015/core.js");
/* harmony import */ var _ionic_native_network_ngx__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @ionic-native/network/ngx */ "./node_modules/@ionic-native/network/ngx/index.js");
/* harmony import */ var _ionic_angular__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @ionic/angular */ "./node_modules/@ionic/angular/dist/fesm5.js");
/* harmony import */ var _model_upcv3_upcmodbus__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../model/upcv3/upcmodbus */ "./src/app/model/upcv3/upcmodbus.ts");





var ConnectionStatusEnum;
(function (ConnectionStatusEnum) {
    ConnectionStatusEnum[ConnectionStatusEnum["Online"] = 0] = "Online";
    ConnectionStatusEnum[ConnectionStatusEnum["Offline"] = 1] = "Offline";
})(ConnectionStatusEnum || (ConnectionStatusEnum = {}));
let NetworkService = class NetworkService {
    constructor(network, eventCtrl, ngZone) {
        this.network = network;
        this.eventCtrl = eventCtrl;
        this.ngZone = ngZone;
        this.previousStatus = ConnectionStatusEnum.Online;
    }
    initializeNetworkEvents() {
        this.upc = new _model_upcv3_upcmodbus__WEBPACK_IMPORTED_MODULE_4__["UPCModbus"](state => {
            this.ngZone.run(() => {
                // Force refresh UI
                //this.readDiffusionParameters();
            });
        });
        this.upc.client.connect();
        this.network.onDisconnect().subscribe(() => {
            if (this.previousStatus === ConnectionStatusEnum.Online) {
                this.eventCtrl.publish('network:offline');
            }
            this.previousStatus = ConnectionStatusEnum.Offline;
        });
        this.network.onConnect().subscribe(() => {
            if (this.previousStatus === ConnectionStatusEnum.Offline) {
                this.eventCtrl.publish('network:online');
            }
            this.previousStatus = ConnectionStatusEnum.Online;
        });
        /*setInterval(()=>{
            this.upc.client.getStringFromHoldingRegister(40001,10).then(res=>{
              this.eventCtrl.publish('network:offline');
            }).catch(err=>{
              this.eventCtrl.publish('network:online');
            })
        },500)*/
    }
};
NetworkService.ctorParameters = () => [
    { type: _ionic_native_network_ngx__WEBPACK_IMPORTED_MODULE_2__["Network"] },
    { type: _ionic_angular__WEBPACK_IMPORTED_MODULE_3__["Events"] },
    { type: _angular_core__WEBPACK_IMPORTED_MODULE_1__["NgZone"] }
];
NetworkService = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Injectable"])({
        providedIn: 'root'
    }),
    tslib__WEBPACK_IMPORTED_MODULE_0__["__metadata"]("design:paramtypes", [_ionic_native_network_ngx__WEBPACK_IMPORTED_MODULE_2__["Network"],
        _ionic_angular__WEBPACK_IMPORTED_MODULE_3__["Events"], _angular_core__WEBPACK_IMPORTED_MODULE_1__["NgZone"]])
], NetworkService);



/***/ }),

/***/ "./src/app/api/upcv3service.service.ts":
/*!*********************************************!*\
  !*** ./src/app/api/upcv3service.service.ts ***!
  \*********************************************/
/*! exports provided: Upcv3serviceService */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Upcv3serviceService", function() { return Upcv3serviceService; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm2015/core.js");
/* harmony import */ var _angular_common_http__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @angular/common/http */ "./node_modules/@angular/common/fesm2015/http.js");
/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! rxjs/operators */ "./node_modules/rxjs/_esm2015/operators/index.js");
/* harmony import */ var _model_upcv3_upcv3__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../model/upcv3/upcv3 */ "./src/app/model/upcv3/upcv3.ts");
/* harmony import */ var _ApiResponse__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./ApiResponse */ "./src/app/api/ApiResponse.ts");
/* harmony import */ var _ionic_storage__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @ionic/storage */ "./node_modules/@ionic/storage/fesm2015/ionic-storage.js");
/* harmony import */ var _model_operator__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../model/operator */ "./src/app/model/operator.ts");
/* harmony import */ var _model_site__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../model/site */ "./src/app/model/site.ts");
/* harmony import */ var _model_bottle__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../model/bottle */ "./src/app/model/bottle.ts");
/* harmony import */ var _model_stock__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../model/stock */ "./src/app/model/stock.ts");











let Upcv3serviceService = class Upcv3serviceService {
    constructor(http, storage) {
        this.http = http;
        this.storage = storage;
        this.apiUrl = 'http://dev-api.biobelt.com/';
    }
    getUPC3(token) {
        let headers = new _angular_common_http__WEBPACK_IMPORTED_MODULE_2__["HttpHeaders"]().set('Content-Type', 'application/json')
            .set('authorization', 'Bearer ' + token);
        return this.http.get(this.apiUrl + 'upcv3/all', { headers: headers }).pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_3__["map"])(res => {
            switch (res.code) {
                case _ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].UPCV3_RECOVERED:
                    var upcv3 = [];
                    var i = 0;
                    res.result.forEach(jsonUPCV3 => { upcv3.push(_model_upcv3_upcv3__WEBPACK_IMPORTED_MODULE_4__["UPCV3"].loadFromJSON(jsonUPCV3)); });
                    res.result = upcv3;
                    break;
                case _ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].UNAUTHORIZED:
                    alert("Vous n'êtes pas autorisé à utiliser l'application mobile !");
                    break;
            }
            return res;
        }));
    }
    createIntervention(json, token) {
        let headers = new _angular_common_http__WEBPACK_IMPORTED_MODULE_2__["HttpHeaders"]().set('Content-Type', 'application/json')
            .set('authorization', 'Bearer ' + token);
        return this.http.post(this.apiUrl + "upcv3/intervention/createAdmin", json, { headers: headers }).pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_3__["map"])(res => {
            switch (res.code) {
                case _ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].INTERVENTIONV3_CREATED:
                    alert("L'intervention a bien été enregistrée");
                    break;
                case _ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].UNAUTHORIZED:
                    alert("Non Autorisé");
                    break;
                case _ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].UPCV3_DOESNT_EXSIST:
                    alert("L'UPCV3 n'existe pas");
                    break;
                case _ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].INTERNAL_ERROR:
                    alert("Erreur Interne");
                    break;
            }
            return res;
        }));
    }
    getConnected(token) {
        let headers = new _angular_common_http__WEBPACK_IMPORTED_MODULE_2__["HttpHeaders"]().set('Content-Type', 'application/json')
            .set('authorization', 'Bearer ' + token);
        return this.http.get(this.apiUrl + "operator/getConnected", { headers: headers }).pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_3__["map"])(res => {
            switch (res.code) {
                case _ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].OPERATOR_RECOVERED:
                    break;
                case _ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].OPERATOR_DOESNT_EXSIST:
                    alert("Opérateur existe pas");
                    break;
                case _ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].UNAUTHORIZED:
                    alert("Pas autoriser !");
                    break;
            }
            return res;
        }));
    }
    getActionNotDoneById(token, id) {
        let headers = new _angular_common_http__WEBPACK_IMPORTED_MODULE_2__["HttpHeaders"]().set('Content-Type', 'application/json')
            .set('authorization', 'Bearer ' + token);
        return this.http.get(this.apiUrl + "upcv3/intervention/isActionDoneById/" + id, { headers: headers }).pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_3__["map"])(res => {
            if (res.code == _ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].INTERVENTIONV3_RECOVERED) {
            }
            else {
                alert("Pas autorisé !");
            }
            return res;
        }));
    }
    getAllStock(token) {
        let headers = new _angular_common_http__WEBPACK_IMPORTED_MODULE_2__["HttpHeaders"]().set('Content-Type', 'application/json')
            .set('authorization', 'Bearer ' + token);
        return this.http.get(this.apiUrl + "stock/allStocks", { headers: headers }).pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_3__["map"])(res => {
            switch (res.code) {
                case _ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].STOCK_RECOVERED:
                    var st = [];
                    res.result.forEach(item => {
                        st.push(_model_stock__WEBPACK_IMPORTED_MODULE_10__["Stock"].loadFromJSON(item));
                    });
                    res.result = st;
                    break;
                case _ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].UNAUTHORIZED:
                    alert("Opération non autorisée !");
                    break;
            }
            return res;
        }));
    }
    login(user) {
        return this.http.post(this.apiUrl + 'user/login', user).pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_3__["map"])(res => {
            //alert(JSON.stringify(res));
            switch (res.code) {
                case _ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].TOKEN_LOGGED_IN:
                    this.storage.set('token', res.result.toString());
                    this.storage.set('refreshToken', res.refreshToken.toString());
                    break;
                case _ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].TOKEN_WRONG_IDENTIFIERS:
                    alert('Identifiants invalides !');
                    break;
                case _ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].WRONG_PARAMS:
                    alert("Fatal Error !");
            }
            return res;
        }));
    }
    getOperators(token) {
        let headers = new _angular_common_http__WEBPACK_IMPORTED_MODULE_2__["HttpHeaders"]().set('Content-Type', 'application/json')
            .set('authorization', 'Bearer ' + token);
        return this.http.get(this.apiUrl + 'operator/all', { headers: headers }).pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_3__["map"])(res => {
            switch (res.code) {
                case _ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].OPERATOR_RECOVERED:
                    var operators = [];
                    res.result.forEach(jsonOperator => operators.push(_model_operator__WEBPACK_IMPORTED_MODULE_7__["Operator"].loadFromJSON(jsonOperator)));
                    res.result = operators;
                    break;
                case _ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].UNAUTHORIZED:
                    alert("Opération non autorisée !");
                    break;
            }
            return res;
        }));
    }
    editTrap(id, nbpieges, token) {
        let headers = new _angular_common_http__WEBPACK_IMPORTED_MODULE_2__["HttpHeaders"]().set('Content-Type', 'application/json')
            .set('authorization', 'Bearer ' + token);
        return this.http.post(this.apiUrl + 'upcv3/' + id + '/editTrapNumber?nbpieges=' + nbpieges, {}, { headers: headers }).pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_3__["map"])(res => {
            return res;
        }));
    }
    getAllBottles(token) {
        let headers = new _angular_common_http__WEBPACK_IMPORTED_MODULE_2__["HttpHeaders"]().set('Content-Type', 'application/json')
            .set('authorization', 'Bearer ' + token);
        return this.http.get(this.apiUrl + 'bottleType/all', { headers: headers }).pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_3__["map"])(res => {
            return res;
        }));
    }
    getAllBottle(token) {
        let headers = new _angular_common_http__WEBPACK_IMPORTED_MODULE_2__["HttpHeaders"]().set('Content-Type', 'application/json')
            .set('authorization', 'Bearer ' + token);
        return this.http.get(this.apiUrl + "bottle/getAllBottles", { headers: headers }).pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_3__["map"])(res => {
            return res;
        }));
    }
    getBottleFromRack(token, rack) {
        let headers = new _angular_common_http__WEBPACK_IMPORTED_MODULE_2__["HttpHeaders"]().set('Content-Type', 'application/json')
            .set('authorization', 'Bearer ' + token);
        return this.http.get(this.apiUrl + "bottle/getRack/" + rack, { headers: headers }).pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_3__["map"])(res => {
            if (res.code === _ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].BOTTLE_RECOVERED) {
                var bottle = [];
                res.result.forEach(item => {
                    bottle.push(_model_bottle__WEBPACK_IMPORTED_MODULE_9__["Bottle"].loadFromJSON(item));
                });
                res.result = bottle;
            }
            else {
                alert("Vous ne pouvez pas utiliser l'application mobile !");
            }
            return res;
        }));
    }
    getBottlesByStockId(id, token) {
        let headers = new _angular_common_http__WEBPACK_IMPORTED_MODULE_2__["HttpHeaders"]().set('Content-Type', 'application/json')
            .set('authorization', 'Bearer ' + token);
        return this.http.get(this.apiUrl + "stock/" + id + "/bottles?all=true&pageSize=1000", { headers: headers }).pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_3__["map"])(res => {
            if (res.code === _ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].BOTTLE_RECOVERED) {
                var bottle = [];
                res.result.forEach(item => {
                    bottle.push(_model_bottle__WEBPACK_IMPORTED_MODULE_9__["Bottle"].loadFromJSON(item));
                });
                res.result = bottle;
            }
            return res;
        }));
    }
    getSitesByUpcID(id, token) {
        let headers = new _angular_common_http__WEBPACK_IMPORTED_MODULE_2__["HttpHeaders"]().set('Content-Type', 'application/json')
            .set('authorization', 'Bearer ' + token);
        return this.http.get(this.apiUrl + 'upcv3/getSiteByUpcID/' + id, { headers: headers }).pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_3__["map"])(res => {
            switch (res.code) {
                case _ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].SITE_RECOVERED:
                    res.result = _model_site__WEBPACK_IMPORTED_MODULE_8__["Site"].loadFromJSON(res.result);
                    break;
                case _ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].UPCV3_DOESNT_EXSIST:
                    break;
                case _ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].UNAUTHORIZED:
                    alert("Vous n'êtes pas autorisé à accèder à ce service");
                    break;
            }
            return res;
        }));
    }
    getSites(token) {
        let headers = new _angular_common_http__WEBPACK_IMPORTED_MODULE_2__["HttpHeaders"]().set('Content-Type', 'application/json')
            .set('authorization', 'Bearer ' + token);
        return this.http.get(this.apiUrl + 'site/all', { headers: headers }).pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_3__["map"])(res => {
            switch (res.code) {
                case _ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].SITE_RECOVERED:
                    var sites = [];
                    res.result.forEach(json => sites.push(_model_site__WEBPACK_IMPORTED_MODULE_8__["Site"].loadFromJSON(json)));
                    break;
                case _ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].SITE_DOESNT_EXSIST:
                    alert("Le Site n'existe pas");
                    break;
                case _ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].UNAUTHORIZED:
                    alert("Vous n'êtes pas autorisé à accèder à ce service");
                    break;
            }
            return res;
        }));
    }
    addToStockMob(form, token) {
        let headers = new _angular_common_http__WEBPACK_IMPORTED_MODULE_2__["HttpHeaders"]().set('Content-Type', 'application/json')
            .set('authorization', 'Bearer ' + token);
        return this.http.post(this.apiUrl + "bottle/addToStockMob", form, { headers: headers }).pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_3__["map"])(res => {
            switch (res.code) {
                case _ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].BOTTLE_CREATED:
                    alert("Bouteilles ajoutés au stock !");
                    break;
                case _ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].BOTTLE_ALREADY_EXSIST:
                    alert("Bouteilles déjà enregistrés sur le stock !");
                    break;
                case _ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].INTERNAL_ERROR:
                case _ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].WRONG_PARAMS:
                    alert("Erreur Mauvais Paramètres !");
                    break;
                case _ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].BOTTLE_TYPE_DOESNT_EXSIST:
                    alert("La bouteille scanner n'existe pas dans la base de données");
                    break;
                case _ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].STOCK_DOESNT_EXSIST:
                    alert("Le stock n'existe pas !");
                    break;
                case _ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].UNAUTHORIZED:
                    alert("Vous n'êtes pas autorisé à utiliser l'application mobile !");
            }
            return res;
        }));
    }
    removeFromCeint(form, token) {
        let headers = new _angular_common_http__WEBPACK_IMPORTED_MODULE_2__["HttpHeaders"]().set('Content-Type', 'application/json')
            .set('authorization', 'Bearer ' + token);
        return this.http.post(this.apiUrl + "bottle/removeFromCeintMobile", form, { headers: headers }).pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_3__["map"])(res => {
            switch (res.code) {
                case _ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].BOTTLE_DELETED:
                    alert("Bouteilles Enlevées de la ceinture !");
                    break;
                case _ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].INTERNAL_ERROR:
                case _ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].WRONG_PARAMS:
                    alert('Erreur Mauvais Paramètres !');
                    break;
                case _ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].BOTTLE_TYPE_DOESNT_EXSIST:
                    alert("La bouteille n'existe pas dans la base de données");
                    break;
                case _ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].STOCK_DOESNT_EXSIST:
                    alert('Le stock est inexistant !');
                    break;
                case _ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].UNAUTHORIZED:
                    alert("Vous n'êtes pas autorisé à utiliser l'application mobile !");
                    break;
            }
            return res;
        }));
    }
    addBottleBelt(form, token) {
        let headers = new _angular_common_http__WEBPACK_IMPORTED_MODULE_2__["HttpHeaders"]().set('Content-Type', 'application/json')
            .set('authorization', 'Bearer ' + token);
        return this.http.post(this.apiUrl + 'bottle/addBottleBeltMobile', form, { headers: headers }).pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_3__["map"])(res => {
            switch (res.code) {
                case _ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].BOTTLE_CREATED:
                    alert('Bouteilles ajoutés à la ceinture !');
                    break;
                case _ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].INTERNAL_ERROR:
                case _ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].WRONG_PARAMS:
                    alert('Erreur Mauvais Paramètres !');
                    break;
                case _ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].BOTTLE_TYPE_DOESNT_EXSIST:
                    alert("La bouteille n'existe pas dans la base de données");
                    break;
                case _ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].STOCK_DOESNT_EXSIST:
                    alert('Le stock est inexistant !');
                    break;
                case _ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].UNAUTHORIZED:
                    alert("Vous n'êtes pas autorisé à utiliser l'application mobile !");
                    break;
            }
            return res;
        }));
    }
    addToStock(form, token) {
        let headers = new _angular_common_http__WEBPACK_IMPORTED_MODULE_2__["HttpHeaders"]().set('Content-Type', 'application/json')
            .set('authorization', 'Bearer ' + token);
        return this.http.post(this.apiUrl + 'bottle/addBottlesToBelt', form, { headers: headers }).pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_3__["map"])(res => {
            switch (res.code) {
                case _ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].BOTTLE_CREATED:
                    alert('Bouteilles ajoutés au stocks !');
                    break;
                case _ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].INTERNAL_ERROR:
                case _ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].WRONG_PARAMS:
                    alert('Erreur Mauvais Paramètres !');
                    break;
                case _ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].BOTTLE_TYPE_DOESNT_EXSIST:
                    alert("La bouteille n'existe pas dans la base de données");
                    break;
                case _ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].STOCK_DOESNT_EXSIST:
                    alert('Le stock est inexistant !');
                    break;
                case _ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].UNAUTHORIZED:
                    alert("Vous n'êtes pas autorisé à utiliser l'application mobile !");
                    break;
            }
            return res;
        }));
    }
    returnFourn(form, token) {
        let headers = new _angular_common_http__WEBPACK_IMPORTED_MODULE_2__["HttpHeaders"]().set('Content-Type', 'application/json')
            .set('authorization', 'Bearer ' + token);
        return this.http.post(this.apiUrl + "bottle/returnFourn", form, { headers: headers }).pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_3__["map"])(res => {
            switch (res.code) {
                case _ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].BOTTLE_DELETED:
                    alert("Bouteilles Enlevés du Stock !");
                    break;
                case _ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].UNAUTHORIZED:
                    alert("Vous n'êtes pas autorisé à utiliser l'appli mobile !");
                    break;
                case _ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].BOTTLE_DOESNT_EXSIST:
                    alert("La bouteille n'existe pas dans la base de données !");
                    break;
            }
            return res;
        }));
    }
    removeRack(rack, token) {
        let headers = new _angular_common_http__WEBPACK_IMPORTED_MODULE_2__["HttpHeaders"]().set('Content-Type', 'application/json')
            .set('authorization', 'Bearer ' + token);
        return this.http.post(this.apiUrl + "bottle/removeRack/" + rack, {}, { headers: headers }).pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_3__["map"])(res => {
            switch (res.code) {
                case _ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].BOTTLE_DELETED:
                    alert("Rack Enlevé du Stock !");
                    break;
                case _ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].UNAUTHORIZED:
                    alert("Vous n'êtes pas autorisé à utiliser l'appli mobile !");
                    break;
                case _ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].BOTTLE_DOESNT_EXSIST:
                    alert("Le Rack n'existe pas !");
                case _ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].WRONG_PARAMS:
                    alert("Mauvais Paramètres !");
                    break;
            }
            return res;
        }));
    }
    downloadCustomPicture(id, token) {
        let headers = new _angular_common_http__WEBPACK_IMPORTED_MODULE_2__["HttpHeaders"]().set('accept', '*').set('authorization', 'Bearer ' + token);
        return this.http.get(this.apiUrl + 'project/' + id + '/download', { headers: headers, responseType: 'arraybuffer' });
    }
    getProject(token) {
        let headers = new _angular_common_http__WEBPACK_IMPORTED_MODULE_2__["HttpHeaders"]().set('Content-Type', 'application/json')
            .set('authorization', 'Bearer ' + token);
        return this.http.get(this.apiUrl + 'project/all', { headers: headers }).pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_3__["map"])(res => {
            switch (res.code) {
                case _ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].PROJECT_RECOVERED:
                    break;
                case _ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].PROJECT_DOESNT_EXSIST:
                    alert("Projet Inexistant !");
                    break;
                case _ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].UNAUTHORIZED:
                    alert("Vous n'êtes pas autorisé à utiliser l'appli mobile !");
                    break;
            }
            return res;
        }));
    }
    getVersion(id, token) {
        let headers = new _angular_common_http__WEBPACK_IMPORTED_MODULE_2__["HttpHeaders"]().set('Content-Type', 'application/json')
            .set('authorization', 'Bearer ' + token);
        return this.http.get(this.apiUrl + 'project/' + id + '/versions', { headers: headers }).pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_3__["map"])(res => {
            switch (res.code) {
                case _ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].VERSION_RECOVERED:
                    break;
                case _ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].VERSION_DOESNT_EXSIST:
                    alert("La ceinture n'existe pas !");
                    break;
                case _ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].UNAUTHORIZED:
                    alert("Vous n'êtes pas autorisé à utiliser l'application !");
                    break;
            }
            return res;
        }));
    }
    addToDeStock(json, token) {
        let headers = new _angular_common_http__WEBPACK_IMPORTED_MODULE_2__["HttpHeaders"]().set('Content-Type', 'application/json')
            .set('authorization', 'Bearer ' + token);
        return this.http.post(this.apiUrl + "bottle/addToStock", json, { headers: headers }).pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_3__["map"])(res => {
            switch (res.code) {
                case _ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].BOTTLE_CREATED:
                    alert("Bouteilles ajoutés au stock !");
                    break;
                case _ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].BOTTLE_ALREADY_EXSIST:
                    alert("Bouteilles déjà enregistrés sur le stock !");
                    break;
                case _ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].INTERNAL_ERROR:
                case _ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].WRONG_PARAMS:
                    alert("Erreur Mauvais Paramètres !");
                    break;
                case _ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].BOTTLE_TYPE_DOESNT_EXSIST:
                    alert("La bouteille scanner n'existe pas dans la base de données");
                    break;
                case _ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].STOCK_DOESNT_EXSIST:
                    alert("Le stock n'existe pas !");
                    break;
                case _ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].UNAUTHORIZED:
                    alert("Vous n'êtes pas autorisé à utiliser l'application mobile !");
            }
            return res;
        }));
    }
};
Upcv3serviceService.ctorParameters = () => [
    { type: _angular_common_http__WEBPACK_IMPORTED_MODULE_2__["HttpClient"] },
    { type: _ionic_storage__WEBPACK_IMPORTED_MODULE_6__["Storage"] }
];
Upcv3serviceService = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Injectable"])({
        providedIn: 'root'
    }),
    tslib__WEBPACK_IMPORTED_MODULE_0__["__metadata"]("design:paramtypes", [_angular_common_http__WEBPACK_IMPORTED_MODULE_2__["HttpClient"],
        _ionic_storage__WEBPACK_IMPORTED_MODULE_6__["Storage"]])
], Upcv3serviceService);



/***/ }),

/***/ "./src/app/app-routing.module.ts":
/*!***************************************!*\
  !*** ./src/app/app-routing.module.ts ***!
  \***************************************/
/*! exports provided: AppRoutingModule */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AppRoutingModule", function() { return AppRoutingModule; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm2015/core.js");
/* harmony import */ var _angular_router__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @angular/router */ "./node_modules/@angular/router/fesm2015/router.js");



const routes = [
    {
        path: '',
        redirectTo: 'login',
        pathMatch: 'full'
    },
    {
        path: 'home',
        loadChildren: () => __webpack_require__.e(/*! import() | home-home-module */ "home-home-module").then(__webpack_require__.bind(null, /*! ./home/home.module */ "./src/app/home/home.module.ts")).then(m => m.HomePageModule)
    },
    {
        path: 'list',
        loadChildren: () => __webpack_require__.e(/*! import() | list-list-module */ "list-list-module").then(__webpack_require__.bind(null, /*! ./list/list.module */ "./src/app/list/list.module.ts")).then(m => m.ListPageModule)
    },
    {
        path: 'instalpieges',
        loadChildren: () => Promise.all(/*! import() | instalpieges-instalpieges-module */[__webpack_require__.e("default~canvas-canvas-module~instalpieges-instalpieges-module"), __webpack_require__.e("instalpieges-instalpieges-module")]).then(__webpack_require__.bind(null, /*! ./instalpieges/instalpieges.module */ "./src/app/instalpieges/instalpieges.module.ts")).then(m => m.InstalpiegesPageModule)
    },
    {
        path: 'bottles',
        loadChildren: () => __webpack_require__.e(/*! import() | bottles-bottles-module */ "bottles-bottles-module").then(__webpack_require__.bind(null, /*! ./bottles/bottles.module */ "./src/app/bottles/bottles.module.ts")).then(m => m.BottlesPageModule)
    },
    {
        path: 'bottlemodal',
        loadChildren: () => __webpack_require__.e(/*! import() | modal-bottlemodal-bottlemodal-module */ "modal-bottlemodal-bottlemodal-module").then(__webpack_require__.bind(null, /*! ./modal/bottlemodal/bottlemodal.module */ "./src/app/modal/bottlemodal/bottlemodal.module.ts")).then(m => m.BottlemodalPageModule)
    },
    {
        path: 'login',
        loadChildren: () => __webpack_require__.e(/*! import() | login-login-module */ "login-login-module").then(__webpack_require__.bind(null, /*! ./login/login.module */ "./src/app/login/login.module.ts")).then(m => m.LoginPageModule)
    },
    {
        path: 'canvas',
        loadChildren: () => Promise.all(/*! import() | canvas-canvas-module */[__webpack_require__.e("default~canvas-canvas-module~instalpieges-instalpieges-module"), __webpack_require__.e("canvas-canvas-module")]).then(__webpack_require__.bind(null, /*! ./canvas/canvas.module */ "./src/app/canvas/canvas.module.ts")).then(m => m.CanvasPageModule)
    },
    {
        path: 'removebottle',
        loadChildren: () => __webpack_require__.e(/*! import() | removebottle-removebottle-module */ "removebottle-removebottle-module").then(__webpack_require__.bind(null, /*! ./removebottle/removebottle.module */ "./src/app/removebottle/removebottle.module.ts")).then(m => m.RemovebottlePageModule)
    },
    {
        path: 'optionbottle',
        loadChildren: () => Promise.all(/*! import() | optionbottle-optionbottle-module */[__webpack_require__.e("default~addbottlemodal-addbottlemodal-module~optionbottle-optionbottle-module~retfournmodal-retfourn~a03ae8d9"), __webpack_require__.e("common"), __webpack_require__.e("optionbottle-optionbottle-module")]).then(__webpack_require__.bind(null, /*! ./optionbottle/optionbottle.module */ "./src/app/optionbottle/optionbottle.module.ts")).then(m => m.OptionbottlePageModule)
    },
    {
        path: 'stock',
        loadChildren: () => Promise.all(/*! import() | stock-stock-module */[__webpack_require__.e("default~addbottlemodal-addbottlemodal-module~optionbottle-optionbottle-module~retfournmodal-retfourn~a03ae8d9"), __webpack_require__.e("stock-stock-module")]).then(__webpack_require__.bind(null, /*! ./stock/stock.module */ "./src/app/stock/stock.module.ts")).then(m => m.StockPageModule)
    },
    {
        path: 'addbottlemodal',
        loadChildren: () => Promise.all(/*! import() | addbottlemodal-addbottlemodal-module */[__webpack_require__.e("default~addbottlemodal-addbottlemodal-module~optionbottle-optionbottle-module~retfournmodal-retfourn~a03ae8d9"), __webpack_require__.e("addbottlemodal-addbottlemodal-module")]).then(__webpack_require__.bind(null, /*! ./addbottlemodal/addbottlemodal.module */ "./src/app/addbottlemodal/addbottlemodal.module.ts")).then(m => m.AddbottlemodalPageModule)
    },
    {
        path: 'addbottleceint',
        loadChildren: () => __webpack_require__.e(/*! import() | addbottleceint-addbottleceint-module */ "addbottleceint-addbottleceint-module").then(__webpack_require__.bind(null, /*! ./addbottleceint/addbottleceint.module */ "./src/app/addbottleceint/addbottleceint.module.ts")).then(m => m.AddbottleceintPageModule)
    },
    {
        path: 'rackcontent',
        loadChildren: () => __webpack_require__.e(/*! import() | rackcontent-rackcontent-module */ "rackcontent-rackcontent-module").then(__webpack_require__.bind(null, /*! ./rackcontent/rackcontent.module */ "./src/app/rackcontent/rackcontent.module.ts")).then(m => m.RackcontentPageModule)
    },
    {
        path: 'choosestock',
        loadChildren: () => __webpack_require__.e(/*! import() | choosestock-choosestock-module */ "choosestock-choosestock-module").then(__webpack_require__.bind(null, /*! ./choosestock/choosestock.module */ "./src/app/choosestock/choosestock.module.ts")).then(m => m.ChoosestockPageModule)
    },
    {
        path: 'adjustment',
        loadChildren: () => __webpack_require__.e(/*! import() | adjustment-adjustment-module */ "adjustment-adjustment-module").then(__webpack_require__.bind(null, /*! ./adjustment/adjustment.module */ "./src/app/adjustment/adjustment.module.ts")).then(m => m.AdjustmentPageModule)
    },
    {
        path: 'check',
        loadChildren: () => __webpack_require__.e(/*! import() | check-check-module */ "check-check-module").then(__webpack_require__.bind(null, /*! ./check/check.module */ "./src/app/check/check.module.ts")).then(m => m.CheckPageModule)
    },
    {
        path: 'controldiff',
        loadChildren: () => __webpack_require__.e(/*! import() | controldiff-controldiff-module */ "controldiff-controldiff-module").then(__webpack_require__.bind(null, /*! ./controldiff/controldiff.module */ "./src/app/controldiff/controldiff.module.ts")).then(m => m.ControldiffPageModule)
    },
    {
        path: 'synchro',
        loadChildren: () => __webpack_require__.e(/*! import() | synchro-synchro-module */ "synchro-synchro-module").then(__webpack_require__.bind(null, /*! ./synchro/synchro.module */ "./src/app/synchro/synchro.module.ts")).then(m => m.SynchroPageModule)
    },
    {
        path: 'cdiff',
        loadChildren: () => __webpack_require__.e(/*! import() | cdiff-cdiff-module */ "cdiff-cdiff-module").then(__webpack_require__.bind(null, /*! ./cdiff/cdiff.module */ "./src/app/cdiff/cdiff.module.ts")).then(m => m.CdiffPageModule)
    },
    {
        path: 'connection',
        loadChildren: () => __webpack_require__.e(/*! import() | connection-connection-module */ "connection-connection-module").then(__webpack_require__.bind(null, /*! ./connection/connection.module */ "./src/app/connection/connection.module.ts")).then(m => m.ConnectionPageModule)
    },
    {
        path: 'interventionceinture',
        loadChildren: () => __webpack_require__.e(/*! import() | interventionceinture-interventionceinture-module */ "interventionceinture-interventionceinture-module").then(__webpack_require__.bind(null, /*! ./interventionceinture/interventionceinture.module */ "./src/app/interventionceinture/interventionceinture.module.ts")).then(m => m.InterventionceinturePageModule)
    },
    {
        path: 'interventionceinture2',
        loadChildren: () => __webpack_require__.e(/*! import() | interventionceinture2-interventionceinture2-module */ "interventionceinture2-interventionceinture2-module").then(__webpack_require__.bind(null, /*! ./interventionceinture2/interventionceinture2.module */ "./src/app/interventionceinture2/interventionceinture2.module.ts")).then(m => m.Interventionceinture2PageModule)
    },
    {
        path: 'retfournmodal',
        loadChildren: () => Promise.all(/*! import() | retfournmodal-retfournmodal-module */[__webpack_require__.e("default~addbottlemodal-addbottlemodal-module~optionbottle-optionbottle-module~retfournmodal-retfourn~a03ae8d9"), __webpack_require__.e("common"), __webpack_require__.e("retfournmodal-retfournmodal-module")]).then(__webpack_require__.bind(null, /*! ./retfournmodal/retfournmodal.module */ "./src/app/retfournmodal/retfournmodal.module.ts")).then(m => m.RetfournmodalPageModule)
    },
    {
        path: 'namepiege',
        loadChildren: () => __webpack_require__.e(/*! import() | namepiege-namepiege-module */ "namepiege-namepiege-module").then(__webpack_require__.bind(null, /*! ./namepiege/namepiege.module */ "./src/app/namepiege/namepiege.module.ts")).then(m => m.NamepiegePageModule)
    },
    {
        path: 'comunicationparam',
        loadChildren: () => __webpack_require__.e(/*! import() | comunicationparam-comunicationparam-module */ "comunicationparam-comunicationparam-module").then(__webpack_require__.bind(null, /*! ./comunicationparam/comunicationparam.module */ "./src/app/comunicationparam/comunicationparam.module.ts")).then(m => m.ComunicationparamPageModule)
    },
    {
        path: 'alarmparam',
        loadChildren: () => __webpack_require__.e(/*! import() | alarmparam-alarmparam-module */ "alarmparam-alarmparam-module").then(__webpack_require__.bind(null, /*! ./alarmparam/alarmparam.module */ "./src/app/alarmparam/alarmparam.module.ts")).then(m => m.AlarmparamPageModule)
    },
    {
        path: 'initechangeboitierupc',
        loadChildren: () => __webpack_require__.e(/*! import() | initechangeboitierupc-initechangeboitierupc-module */ "initechangeboitierupc-initechangeboitierupc-module").then(__webpack_require__.bind(null, /*! ./initechangeboitierupc/initechangeboitierupc.module */ "./src/app/initechangeboitierupc/initechangeboitierupc.module.ts")).then(m => m.InitechangeboitierupcPageModule)
    },
    {
        path: 'commentaires',
        loadChildren: () => __webpack_require__.e(/*! import() | commentaires-commentaires-module */ "commentaires-commentaires-module").then(__webpack_require__.bind(null, /*! ./commentaires/commentaires.module */ "./src/app/commentaires/commentaires.module.ts")).then(m => m.CommentairesPageModule)
    },
    {
        path: 'rapportvisite',
        loadChildren: () => __webpack_require__.e(/*! import() | rapportvisite-rapportvisite-module */ "rapportvisite-rapportvisite-module").then(__webpack_require__.bind(null, /*! ./rapportvisite/rapportvisite.module */ "./src/app/rapportvisite/rapportvisite.module.ts")).then(m => m.RapportvisitePageModule)
    },
    {
        path: 'modifnbpieges',
        loadChildren: () => __webpack_require__.e(/*! import() | modifnbpieges-modifnbpieges-module */ "modifnbpieges-modifnbpieges-module").then(__webpack_require__.bind(null, /*! ./modifnbpieges/modifnbpieges.module */ "./src/app/modifnbpieges/modifnbpieges.module.ts")).then(m => m.ModifnbpiegesPageModule)
    },
    {
        path: 'verifpiegesindividuels',
        loadChildren: () => __webpack_require__.e(/*! import() | verifpiegesindividuels-verifpiegesindividuels-module */ "verifpiegesindividuels-verifpiegesindividuels-module").then(__webpack_require__.bind(null, /*! ./verifpiegesindividuels/verifpiegesindividuels.module */ "./src/app/verifpiegesindividuels/verifpiegesindividuels.module.ts")).then(m => m.VerifpiegesindividuelsPageModule)
    },
    {
        path: 'testmode',
        loadChildren: () => __webpack_require__.e(/*! import() | testmode-testmode-module */ "testmode-testmode-module").then(__webpack_require__.bind(null, /*! ./testmode/testmode.module */ "./src/app/testmode/testmode.module.ts")).then(m => m.TestmodePageModule)
    },
    {
        path: 'finintervention',
        loadChildren: () => __webpack_require__.e(/*! import() | finintervention-finintervention-module */ "finintervention-finintervention-module").then(__webpack_require__.bind(null, /*! ./finintervention/finintervention.module */ "./src/app/finintervention/finintervention.module.ts")).then(m => m.FininterventionPageModule)
    },
    {
        path: 'debug',
        loadChildren: () => __webpack_require__.e(/*! import() | debug-debug-module */ "debug-debug-module").then(__webpack_require__.bind(null, /*! ./debug/debug.module */ "./src/app/debug/debug.module.ts")).then(m => m.DebugPageModule)
    }
];
let AppRoutingModule = class AppRoutingModule {
};
AppRoutingModule = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["NgModule"])({
        imports: [
            _angular_router__WEBPACK_IMPORTED_MODULE_2__["RouterModule"].forRoot(routes, { preloadingStrategy: _angular_router__WEBPACK_IMPORTED_MODULE_2__["PreloadAllModules"] })
        ],
        exports: [_angular_router__WEBPACK_IMPORTED_MODULE_2__["RouterModule"]]
    })
], AppRoutingModule);



/***/ }),

/***/ "./src/app/app.component.scss":
/*!************************************!*\
  !*** ./src/app/app.component.scss ***!
  \************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = ".normal {\n  color: light;\n}\n\n.perteConnexion {\n  color: red;\n}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9oYXJtYW5kL0Rlc2t0b3AvYmlvYmVsdG1vYmlsZS9zcmMvYXBwL2FwcC5jb21wb25lbnQuc2NzcyIsInNyYy9hcHAvYXBwLmNvbXBvbmVudC5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0ksWUFBQTtBQ0NKOztBREVBO0VBQ0ksVUFBQTtBQ0NKIiwiZmlsZSI6InNyYy9hcHAvYXBwLmNvbXBvbmVudC5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLm5vcm1hbHtcclxuICAgIGNvbG9yOiBsaWdodDtcclxufVxyXG5cclxuLnBlcnRlQ29ubmV4aW9ue1xyXG4gICAgY29sb3I6IHJlZDtcclxufSIsIi5ub3JtYWwge1xuICBjb2xvcjogbGlnaHQ7XG59XG5cbi5wZXJ0ZUNvbm5leGlvbiB7XG4gIGNvbG9yOiByZWQ7XG59Il19 */"

/***/ }),

/***/ "./src/app/app.component.ts":
/*!**********************************!*\
  !*** ./src/app/app.component.ts ***!
  \**********************************/
/*! exports provided: AppComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AppComponent", function() { return AppComponent; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm2015/core.js");
/* harmony import */ var _ionic_angular__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @ionic/angular */ "./node_modules/@ionic/angular/dist/fesm5.js");
/* harmony import */ var _ionic_native_splash_screen_ngx__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @ionic-native/splash-screen/ngx */ "./node_modules/@ionic-native/splash-screen/ngx/index.js");
/* harmony import */ var _ionic_native_status_bar_ngx__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @ionic-native/status-bar/ngx */ "./node_modules/@ionic-native/status-bar/ngx/index.js");
/* harmony import */ var _angular_router__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @angular/router */ "./node_modules/@angular/router/fesm2015/router.js");
/* harmony import */ var _api_upcv3service_service__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./api/upcv3service.service */ "./src/app/api/upcv3service.service.ts");
/* harmony import */ var _api_global_service__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./api/global.service */ "./src/app/api/global.service.ts");
/* harmony import */ var _ionic_native_hotspot_ngx__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @ionic-native/hotspot/ngx */ "./node_modules/@ionic-native/hotspot/ngx/index.js");
/* harmony import */ var _api_network_service__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./api/network.service */ "./src/app/api/network.service.ts");
/* harmony import */ var _ionic_native_network_ngx__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @ionic-native/network/ngx */ "./node_modules/@ionic-native/network/ngx/index.js");
/* harmony import */ var _ionic_storage__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @ionic/storage */ "./node_modules/@ionic/storage/fesm2015/ionic-storage.js");












let AppComponent = class AppComponent {
    constructor(platform, splashScreen, statusBar, router, upcv3Service, global, hotspot, ngZone, networkProvider, events, network, cd, alertController, storage) {
        this.platform = platform;
        this.splashScreen = splashScreen;
        this.statusBar = statusBar;
        this.router = router;
        this.upcv3Service = upcv3Service;
        this.global = global;
        this.hotspot = hotspot;
        this.ngZone = ngZone;
        this.networkProvider = networkProvider;
        this.events = events;
        this.network = network;
        this.cd = cd;
        this.alertController = alertController;
        this.storage = storage;
        this.stockRet = "";
        this.appPages = [
            {
                title: "Accueil",
                url: "/home"
            },
            {
                title: "Intervention sur Ceinture",
                url: "/interventionceinture",
                icon: "hammer"
            },
            {
                title: "Paramètres Généraux UPC",
                url: "/namepiege"
            },
            {
                title: "Initialisation / Echange boitier UPC",
                url: "/initechangeboitierupc"
            },
            {
                title: "Modification du nombre de pièges",
                url: "/modifnbpieges"
            },
            {
                title: "Vérification débits pièges individuels",
                url: "/verifpiegesindividuels"
            },
            {
                title: 'Changement de bouteilles sur ceinture',
                url: '/addbottleceint',
                icon: 'barcode'
            }, {
                title: "Mouvements de bouteilles",
                url: "/optionbottle"
            },
            {
                title: 'Réglage des détendeurs',
                url: '/adjustment',
                icon: 'return-right'
            },
            {
                title: "Contrôle débits Mini/Maxi",
                url: "/controldiff",
                icon: "infinite",
            },
            {
                title: 'Programmation',
                icon: 'sunny',
                url: "/synchro",
            },
            {
                title: "Etat de la Connexion",
                icon: "globe",
                url: "/connection"
            },
            {
                title: "Contrôle Diffusion",
                url: "/cdiff"
            },
            {
                title: "Mesure des pressions de sortie",
                url: "/check",
            },
            {
                title: "Paramètre de Communication",
                url: "/comunicationparam",
                icon: "wifi"
            },
            {
                title: "Paramètre d'Alarme",
                url: "/alarmparam",
                icon: "alarm"
            },
            {
                title: "Commentaires",
                url: "/commentaires"
            },
            {
                title: "Rapport de visite",
                url: "/rapportvisite"
            },
            {
                title: "Fin d'intervention",
                url: "/finintervention"
            }
        ];
        localStorage.removeItem("isAddedB1");
        localStorage.removeItem("isAddedB2");
        this.platform.ready().then(res => {
            this.global.pages = [];
            this.global.count = 0;
            this.global.connexionRequise = "Aucune";
            /*let i = 1;
            setTimeout(this.run,500); */
            let i = 1;
            setInterval(() => {
                var d = new Date();
                this.global.logs.push(this.global.msToTime(d.getTime()) + " - set interval");
                return new Promise((resolve, reject) => tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
                    /*if(this.global.connexionRequise == "Aucune"){
                      this.global.onConnect("").then(()=>{
                        resolve()
                      })
                    }
                    else{*/
                    if (this.global.connexionRequise == "UPC") {
                        var d = new Date();
                        this.global.logs.push(this.global.msToTime(d.getTime()) + " - connexion requise upc");
                        this.global.logs.push(this.global.msToTime(d.getTime()) + " - flags interval lc : " + this.global.lectureCycliqueEnCours + " - e : " + this.global.ecritureEnCours + " - oc : " + this.global.onConnectEnCours);
                        if (this.global.lectureCycliqueEnCours != true) {
                            this.global.lectureCycliqueEnCours = true;
                            this.global.startReadDate = new Date();
                            this.global.logs.push(this.global.msToTime(d.getTime()) + " - flags onreadcyclique ls : " + this.global.lectureStatiqueEnCours + " - e : " + this.global.ecritureEnCours + " - oc : " + this.global.onConnectEnCours);
                            if (this.global.ecritureEnCours == true || this.global.lectureStatiqueEnCours == true || this.global.onConnectEnCours == true) {
                                this.global.logs.push(this.global.msToTime(d.getTime()) + " - wait");
                                this.global.lectureCycliqueEnCours = false;
                                resolve();
                            }
                            else {
                                this.global.startReadDate = new Date();
                                var d = new Date();
                                this.global.logs.push(this.global.msToTime(d) + " - Appel onReadCycliqueEnable");
                                this.global.onReadCycliqueEnable().then(() => {
                                    this.global.lectureCycliqueEnCours = false;
                                    resolve();
                                });
                            }
                        }
                        else {
                            this.global.startReadDate = new Date();
                            this.global.logs.push(this.global.msToTime(d.getTime()) + " - lecture cyclique en cours -> wait");
                            resolve();
                        }
                    }
                    else {
                        this.global.startReadDate = new Date();
                        this.global.logs.push(this.global.msToTime(d.getTime()) + " - connexion requise != UPC");
                        resolve();
                    }
                    //}
                }));
            }, 500);
            this.initializeApp();
        });
    }
    presentAlert() {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            const alert = yield this.alertController.create({
                cssClass: 'my-custom-class',
                header: 'Session Précédente',
                message: 'Voulez-vous restaurez la session précédente ?',
                buttons: [{
                        text: 'NON',
                        handler: () => tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () { localStorage.clear(); this.stockRet = ""; yield this.storage.remove("motive"); yield this.storage.remove("intervenantsChoisis"); yield this.storage.remove("ceintureChoisieName"); yield this.storage.remove("ceintureChoisieObject"); yield this.storage.remove("nearUpcList"); })
                    }, {
                        text: "OUI"
                    }]
            });
            yield alert.present();
            const { role } = yield alert.onDidDismiss();
            console.log('onDidDismiss resolved with role', role);
        });
    }
    //Restaurer la session 
    //WifiWizard2.getConnectedSSID()
    initializeApp() {
        this.platform.ready().then(() => {
            /*this.networkProvider.initializeNetworkEvents();
      
            // Offline event
            this.events.subscribe('network:offline', () => {
              this.global.isBBAM = true;
              this.global.ssid = "BBAM";
              this.cd.detectChanges();
          });
      
          // Online event
          this.events.subscribe('network:online', () => {
              this.global.isBBAM = false;
              this.global.ssid = "ADMIN";
              this.cd.detectChanges();
          });*/
            this.statusBar.styleDefault();
            this.splashScreen.hide();
        });
        /*if(this.platform.is("android")){
          var isUPC = true;
          setInterval(()=>{
    
            this.hotspot.isWifiOn().then(res=>{
              if (res == true) {
                WifiWizard2.getConnectedSSID().then(res=>{
                  
                  if(this.network.type == this.network.Connection.WIFI){
                    this.global.isBBAM = true;
                    this.global.ssid = res;
                    if(res.length <= 10) {
                      localStorage.setItem("currentssid",this.global.ssid);
                     
                      //alert(localStorage.getItem("ssid") );
                      if (localStorage.getItem("ssid") != res) {
                        //alert("Vous n'êtes pas connecté au bon UPC !");
                      }
                    }
                  
                    
                    
                    
                    
                  } else if(this.network.type == this.network.Connection.CELL) {
                    this.global.isBBAM = false;
                    this.global.ssid = "ADMIN";
                    
                    localStorage.removeItem("isConnected");
                    //this.global.onConnectWiFi();
                  } else if(this.network.type == this.network.Connection.NONE){
                    this.global.isBBAM = false;
                    this.global.ssid = "";
                    localStorage.removeItem("isConnected");
                  }
              }).catch(err=>{
                if (this.network.type == this.network.Connection.NONE){
                  this.global.isBBAM = false;
                  this.global.ssid = "";
                } else {
                  this.global.isBBAM = false;
                  this.global.ssid = "ADMIN";
                  
                }
                localStorage.removeItem("isConnected");
              })
              } else {
                this.global.isBBAM = false;
                this.global.ssid = "ADMIN";
              }
            })
            
            if (localStorage.getItem("upcname")){
              this.stockRet = localStorage.getItem("upcname");
            }
            if(localStorage.getItem("ssid")){
              
              this.global.isBBAM = true;
              this.global.ssid = localStorage.getItem("ssid");
            } else {
              this.global.isBBAM = false;
              this.global.ssid = "ADMIN";
            }
            if (localStorage.getItem("upcname")){
              this.stockRet = localStorage.getItem("upcname");
            }
          },1000)
        } else if(this.platform.is("ios")){
          setInterval(()=>{
            if (localStorage.getItem("upcname")){
              this.stockRet = localStorage.getItem("upcname");
            }
            WifiWizard2.getConnectedSSID().then(res=>{
              
              if(this.network.type == this.network.Connection.WIFI){
                this.global.isBBAM = true;
                this.global.ssid = res;
                /*this.storage.get("ssid").then(res=>{
                  
                  if(!res){
                    
                  }
                })
                if(res.length <= 10) {
                  localStorage.setItem("currentssid",this.global.ssid);
                }
                
                
              } else if(this.network.type == this.network.Connection.CELL) {
                this.global.isBBAM = false;
                this.global.ssid = "ADMIN";
                localStorage.removeItem("isConnected");
                //this.global.onConnectWiFi();
              } else if(this.network.type == this.network.Connection.NONE){
                this.global.isBBAM = false;
                this.global.ssid = "";
                localStorage.removeItem("isConnected");
              }
            }).catch(err=>{
              if (this.network.type == this.network.Connection.NONE){
                this.global.isBBAM = false;
                this.global.ssid = "";
              } else {
                this.global.isBBAM = false;
                this.global.ssid = "ADMIN";
                
              }
              localStorage.removeItem("isConnected");
            })
          },1000)
          /*WifiWizard2.getConnectedSSID().then(res=>{
            if(res.includes("BBAM")){
              this.global.isBBAM = true;
              this.global.ssid = res;
            } else {
              this.global.isBBAM = false;
              this.global.ssid = "ADMIN";
            }
          })
          
        }
        
        /*setInterval(()=>{
          if(this.platform.is("android")) {
            this.hotspot.isConnectedToInternet().then(res=>{
              if(res && localStorage.getItem("BBAM") == "true") {
                
                this.hotspot.connectToWifi("BBAM","BioBeltService").then(()=>{
                  localStorage.setItem("BBAM","true");
                  this.global.ssid = "BBAM";
                  this.global.isBBAM = true;
                })
              } else if (res == false) {
                localStorage.setItem("BBAM","false");
              }
            }).catch(err=>{
              
            })
          } else if (this.platform.is("ios")) {
            if(localStorage.getItem("BBAM") != "true"){
              WifiWizard2.iOSConnectNetwork("BBAM","BioBeltService").then(res=>{
                localStorage.setItem("BBAM","true");
                this.global.ssid = "BBAM";
                this.global.isBBAM = true;
              })
            }
            
          }
          
        },5000)*/
    }
    onClearInterval(url) {
        clearInterval(this.global.interval);
        this.router.navigate([url]);
        this.events.unsubscribe("loadParameters");
        // version_id project_id 
    }
    goToConn() {
        this.router.navigate(['testmode']);
    }
};
AppComponent.ctorParameters = () => [
    { type: _ionic_angular__WEBPACK_IMPORTED_MODULE_2__["Platform"] },
    { type: _ionic_native_splash_screen_ngx__WEBPACK_IMPORTED_MODULE_3__["SplashScreen"] },
    { type: _ionic_native_status_bar_ngx__WEBPACK_IMPORTED_MODULE_4__["StatusBar"] },
    { type: _angular_router__WEBPACK_IMPORTED_MODULE_5__["Router"] },
    { type: _api_upcv3service_service__WEBPACK_IMPORTED_MODULE_6__["Upcv3serviceService"] },
    { type: _api_global_service__WEBPACK_IMPORTED_MODULE_7__["GlobalService"] },
    { type: _ionic_native_hotspot_ngx__WEBPACK_IMPORTED_MODULE_8__["Hotspot"] },
    { type: _angular_core__WEBPACK_IMPORTED_MODULE_1__["NgZone"] },
    { type: _api_network_service__WEBPACK_IMPORTED_MODULE_9__["NetworkService"] },
    { type: _ionic_angular__WEBPACK_IMPORTED_MODULE_2__["Events"] },
    { type: _ionic_native_network_ngx__WEBPACK_IMPORTED_MODULE_10__["Network"] },
    { type: _angular_core__WEBPACK_IMPORTED_MODULE_1__["ChangeDetectorRef"] },
    { type: _ionic_angular__WEBPACK_IMPORTED_MODULE_2__["AlertController"] },
    { type: _ionic_storage__WEBPACK_IMPORTED_MODULE_11__["Storage"] }
];
AppComponent = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Component"])({
        selector: 'app-root',
        template: __webpack_require__(/*! raw-loader!./app.component.html */ "./node_modules/raw-loader/index.js!./src/app/app.component.html"),
        styles: [__webpack_require__(/*! ./app.component.scss */ "./src/app/app.component.scss")]
    }),
    tslib__WEBPACK_IMPORTED_MODULE_0__["__metadata"]("design:paramtypes", [_ionic_angular__WEBPACK_IMPORTED_MODULE_2__["Platform"],
        _ionic_native_splash_screen_ngx__WEBPACK_IMPORTED_MODULE_3__["SplashScreen"],
        _ionic_native_status_bar_ngx__WEBPACK_IMPORTED_MODULE_4__["StatusBar"],
        _angular_router__WEBPACK_IMPORTED_MODULE_5__["Router"],
        _api_upcv3service_service__WEBPACK_IMPORTED_MODULE_6__["Upcv3serviceService"],
        _api_global_service__WEBPACK_IMPORTED_MODULE_7__["GlobalService"],
        _ionic_native_hotspot_ngx__WEBPACK_IMPORTED_MODULE_8__["Hotspot"],
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["NgZone"],
        _api_network_service__WEBPACK_IMPORTED_MODULE_9__["NetworkService"],
        _ionic_angular__WEBPACK_IMPORTED_MODULE_2__["Events"],
        _ionic_native_network_ngx__WEBPACK_IMPORTED_MODULE_10__["Network"],
        _angular_core__WEBPACK_IMPORTED_MODULE_1__["ChangeDetectorRef"],
        _ionic_angular__WEBPACK_IMPORTED_MODULE_2__["AlertController"],
        _ionic_storage__WEBPACK_IMPORTED_MODULE_11__["Storage"]])
], AppComponent);



/***/ }),

/***/ "./src/app/app.module.ts":
/*!*******************************!*\
  !*** ./src/app/app.module.ts ***!
  \*******************************/
/*! exports provided: AppModule */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AppModule", function() { return AppModule; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm2015/core.js");
/* harmony import */ var _angular_platform_browser__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @angular/platform-browser */ "./node_modules/@angular/platform-browser/fesm2015/platform-browser.js");
/* harmony import */ var _angular_router__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @angular/router */ "./node_modules/@angular/router/fesm2015/router.js");
/* harmony import */ var _ionic_storage__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @ionic/storage */ "./node_modules/@ionic/storage/fesm2015/ionic-storage.js");
/* harmony import */ var _ionic_angular__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @ionic/angular */ "./node_modules/@ionic/angular/dist/fesm5.js");
/* harmony import */ var _ionic_native_splash_screen_ngx__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @ionic-native/splash-screen/ngx */ "./node_modules/@ionic-native/splash-screen/ngx/index.js");
/* harmony import */ var _ionic_native_status_bar_ngx__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @ionic-native/status-bar/ngx */ "./node_modules/@ionic-native/status-bar/ngx/index.js");
/* harmony import */ var _angular_common_http__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @angular/common/http */ "./node_modules/@angular/common/fesm2015/http.js");
/* harmony import */ var _app_component__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./app.component */ "./src/app/app.component.ts");
/* harmony import */ var _app_routing_module__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./app-routing.module */ "./src/app/app-routing.module.ts");
/* harmony import */ var _ionic_native_barcode_scanner_ngx__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @ionic-native/barcode-scanner/ngx */ "./node_modules/@ionic-native/barcode-scanner/ngx/index.js");
/* harmony import */ var _ionic_native_network_ngx__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @ionic-native/network/ngx */ "./node_modules/@ionic-native/network/ngx/index.js");
/* harmony import */ var _ionic_native_hotspot_ngx__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! @ionic-native/hotspot/ngx */ "./node_modules/@ionic-native/hotspot/ngx/index.js");
/* harmony import */ var _ionic_native_wifi_wizard_2_ngx__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! @ionic-native/wifi-wizard-2/ngx */ "./node_modules/@ionic-native/wifi-wizard-2/ngx/index.js");
/* harmony import */ var _ionic_native_geolocation_ngx__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! @ionic-native/geolocation/ngx */ "./node_modules/@ionic-native/geolocation/ngx/index.js");
/* harmony import */ var _rackcontent_rackcontent_page__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./rackcontent/rackcontent.page */ "./src/app/rackcontent/rackcontent.page.ts");
/* harmony import */ var _api_global_service__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./api/global.service */ "./src/app/api/global.service.ts");
/* harmony import */ var _ionic_native_diagnostic_ngx__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! @ionic-native/diagnostic/ngx */ "./node_modules/@ionic-native/diagnostic/ngx/index.js");



















let AppModule = class AppModule {
};
AppModule = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["NgModule"])({
        declarations: [_app_component__WEBPACK_IMPORTED_MODULE_9__["AppComponent"], _rackcontent_rackcontent_page__WEBPACK_IMPORTED_MODULE_16__["RackcontentPage"]],
        entryComponents: [_rackcontent_rackcontent_page__WEBPACK_IMPORTED_MODULE_16__["RackcontentPage"]],
        imports: [
            _angular_platform_browser__WEBPACK_IMPORTED_MODULE_2__["BrowserModule"],
            _ionic_angular__WEBPACK_IMPORTED_MODULE_5__["IonicModule"].forRoot(),
            _app_routing_module__WEBPACK_IMPORTED_MODULE_10__["AppRoutingModule"],
            _angular_common_http__WEBPACK_IMPORTED_MODULE_8__["HttpClientModule"],
            _ionic_storage__WEBPACK_IMPORTED_MODULE_4__["IonicStorageModule"].forRoot()
        ],
        providers: [
            _ionic_native_status_bar_ngx__WEBPACK_IMPORTED_MODULE_7__["StatusBar"],
            _ionic_native_splash_screen_ngx__WEBPACK_IMPORTED_MODULE_6__["SplashScreen"],
            _ionic_native_barcode_scanner_ngx__WEBPACK_IMPORTED_MODULE_11__["BarcodeScanner"],
            _ionic_native_network_ngx__WEBPACK_IMPORTED_MODULE_12__["Network"],
            _ionic_native_hotspot_ngx__WEBPACK_IMPORTED_MODULE_13__["Hotspot"],
            _ionic_native_wifi_wizard_2_ngx__WEBPACK_IMPORTED_MODULE_14__["WifiWizard2"],
            _ionic_native_geolocation_ngx__WEBPACK_IMPORTED_MODULE_15__["Geolocation"],
            _api_global_service__WEBPACK_IMPORTED_MODULE_17__["GlobalService"],
            _ionic_native_diagnostic_ngx__WEBPACK_IMPORTED_MODULE_18__["Diagnostic"],
            { provide: _angular_router__WEBPACK_IMPORTED_MODULE_3__["RouteReuseStrategy"], useClass: _ionic_angular__WEBPACK_IMPORTED_MODULE_5__["IonicRouteStrategy"] }
        ],
        bootstrap: [_app_component__WEBPACK_IMPORTED_MODULE_9__["AppComponent"]]
    })
], AppModule);



/***/ }),

/***/ "./src/app/model/bottle.ts":
/*!*********************************!*\
  !*** ./src/app/model/bottle.ts ***!
  \*********************************/
/*! exports provided: Bottle, BottleEvent, Status, State, Code */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Bottle", function() { return Bottle; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BottleEvent", function() { return BottleEvent; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Status", function() { return Status; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "State", function() { return State; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Code", function() { return Code; });
/* harmony import */ var _bottleType__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./bottleType */ "./src/app/model/bottleType.ts");
/* harmony import */ var _upcv3_LocalDateTime__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./upcv3/LocalDateTime */ "./src/app/model/upcv3/LocalDateTime.ts");


class Bottle {
    constructor() {
        this.id = '';
        this.barcode = '';
        this.status = Status.ENTREPOSE;
        this.state = State.FULL;
        this.bottleType = null;
        this.bottleEvents = [];
        this.lastStatus = Status.ENTREPOSE;
        this.rack = "";
    }
    get statusString() {
        switch (this.status) {
            case Status.ENTREPOSE: return 'Entreposée';
            case Status.B1: return 'Sur B1';
            case Status.B2: return 'Sur B2';
            case Status.REVOKED: return 'Retirée';
            case Status.UNDEFINED: return 'Indéfini';
        }
    }
    get bottleString() {
        return this.bottleType.designationString + ' (' + this.barcode + ')';
    }
    static loadFromJSON(json) {
        var bottle = Object.assign(new Bottle, json);
        if (json.bottleType)
            bottle.bottleType = _bottleType__WEBPACK_IMPORTED_MODULE_0__["BottleType"].loadFromJSON(json.bottleType);
        if (json.bottleEvents) {
            bottle.bottleEvents = [];
            json.bottleEvents.forEach(jsonBottleEvent => bottle.bottleEvents.push(BottleEvent.loadFromJSON(jsonBottleEvent)));
        }
        return bottle;
    }
}
class BottleEvent {
    constructor() {
        this.id = '';
        this.code = Code.ENTREPOSAGE;
        this.date = new _upcv3_LocalDateTime__WEBPACK_IMPORTED_MODULE_1__["LocalDateTime"]();
        this.parameter = '';
        this.destinationId = '';
        this.destinationType = '';
        this.state = '';
        this.intervention_time = new _upcv3_LocalDateTime__WEBPACK_IMPORTED_MODULE_1__["LocalDateTime"]();
        this.operator = '';
    }
    get codeString() {
        switch (this.code) {
            case Code.ENTREPOSAGE:
                if (this.parameter === "0840ffbf-82ee-4f23-a3b9-96b1f99cefdd" || this.parameter === '1e2b0d98-44a8-4fe8-a412-299f0991919d' || this.parameter === "8eea82b3-e17c-4a62-8e4a-389a8f15e9a2" || this.parameter === "ff1c41aa-f9f7-478b-8b41-8616313f6d88") {
                    return 'Ajout au stock';
                }
                else {
                    return 'Ajout à la ceinture';
                }
            case Code.CONNEXION_A_B1: return 'Ajout à B1';
            case Code.CONNEXION_A_B2: return 'Ajout à B2';
            case Code.RECEPTION: return 'Reception au stock';
            case Code.RENVOIE: return 'Suppression du stock';
        }
    }
    get parameterString() {
        if (this.parameter)
            return this.parameter;
        else
            return '-';
    }
    static loadFromJSON(json) {
        var bottleEvent = Object.assign(new BottleEvent, json);
        if (json.date)
            bottleEvent.date = _upcv3_LocalDateTime__WEBPACK_IMPORTED_MODULE_1__["LocalDateTime"].loadFromJSON(json.date);
        return bottleEvent;
    }
}
var Status;
(function (Status) {
    Status["ENTREPOSE"] = "ENTREPOSE";
    Status["B1"] = "B1";
    Status["B2"] = "B2";
    Status["REVOKED"] = "REVOKED";
    Status["UNDEFINED"] = "UNDEFINED";
})(Status || (Status = {}));
var State;
(function (State) {
    State["FULL"] = "FULL";
    State["IN_USE"] = "IN_USE";
    State["EMPTY"] = "EMPTY";
})(State || (State = {}));
var Code;
(function (Code) {
    Code["ENTREPOSAGE"] = "ENTREPOSAGE";
    Code["CONNEXION_A_B1"] = "CONNEXION_A_B1";
    Code["CONNEXION_A_B2"] = "CONNEXION_A_B2";
    Code["RECEPTION"] = "RECEPTION";
    Code["RENVOIE"] = "RENVOIE";
})(Code || (Code = {}));


/***/ }),

/***/ "./src/app/model/bottleType.ts":
/*!*************************************!*\
  !*** ./src/app/model/bottleType.ts ***!
  \*************************************/
/*! exports provided: BottleType */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BottleType", function() { return BottleType; });
class BottleType {
    constructor() {
        this.id = '';
        this.designation = 0;
        this.brand = '';
        this.isRembo = false;
    }
    get designationString() {
        return this.designation + ' kg' + (this.isRembo ? ' (Rembo) - ' : ' - ') + this.brand;
    }
    static loadFromJSON(json) {
        return Object.assign(new BottleType, json);
    }
}


/***/ }),

/***/ "./src/app/model/operator.ts":
/*!***********************************!*\
  !*** ./src/app/model/operator.ts ***!
  \***********************************/
/*! exports provided: Operator */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Operator", function() { return Operator; });
/* harmony import */ var _user__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./user */ "./src/app/model/user.ts");
/* harmony import */ var _site__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./site */ "./src/app/model/site.ts");


class Operator extends _user__WEBPACK_IMPORTED_MODULE_0__["User"] {
    constructor() {
        super(...arguments);
        this.lastName = '';
        this.firstName = '';
        this.phone = '';
        this.sites = [];
    }
    static loadFromJSON(json) {
        var operator = Object.assign(new Operator, json);
        if (json.sites) {
            operator.sites = [];
            json.sites.forEach(jsonSite => { operator.sites.push(_site__WEBPACK_IMPORTED_MODULE_1__["Site"].loadFromJSON(jsonSite)); });
        }
        return operator;
    }
}


/***/ }),

/***/ "./src/app/model/site.ts":
/*!*******************************!*\
  !*** ./src/app/model/site.ts ***!
  \*******************************/
/*! exports provided: Site, State */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Site", function() { return Site; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "State", function() { return State; });
/* harmony import */ var _stock__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./stock */ "./src/app/model/stock.ts");
/* harmony import */ var _upcv3_upcv3__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./upcv3/upcv3 */ "./src/app/model/upcv3/upcv3.ts");


class Site {
    constructor() {
        this.id = '';
        this.clientNumber = '';
        this.name = '';
        this.infos = '';
        this.address = '';
        this.lat = 0;
        this.lng = 0;
        this.stockClient = '';
        this.upcv3 = [];
    }
    get state() {
        var state = State.RESERVE_1;
        // If all belts hibernating
        var hibernating = true;
        this.upcv3.forEach(upcv3 => { if (!upcv3.hibernated)
            hibernating = false; });
        // If a belt is in B2
        var b2 = false;
        this.upcv3.forEach(upcv3 => { if (!upcv3.hibernated && (upcv3.reservesParameters.co2Res1Status == 0 || upcv3.reservesParameters.co2Res2Status == 0))
            b2 = true; });
        // If a belt is in B3 OR DISABLE OR EMPTY
        var disable = false;
        this.upcv3.forEach(upcv3 => { if (!upcv3.hibernated && (upcv3.reservesParameters.co2Res1Status == 0 && upcv3.reservesParameters.co2Res2Status == 0))
            disable = true; });
        if (hibernating)
            state = State.HIBERNATING;
        if (b2)
            state = State.RESERVE_2;
        if (disable)
            state = State.DISABLE;
        return state;
    }
    get communicationState() {
        var state = true;
        // UPC-V3
        this.upcv3.forEach(upcv3 => {
            if (!upcv3.hibernated && upcv3.lastPollResult != 0)
                state = false;
        });
        return state;
    }
    get hasBelts() {
        return this.upcv3.length > 0;
    }
    static loadFromJSON(json) {
        var site = Object.assign(new Site, json);
        if (json.stock)
            site.stock = _stock__WEBPACK_IMPORTED_MODULE_0__["Stock"].loadFromJSON(json.stock);
        if (json.upcv3) {
            site.upcv3 = [];
            json.upcv3.forEach(jsonUpcv3 => { site.upcv3.push(_upcv3_upcv3__WEBPACK_IMPORTED_MODULE_1__["UPCV3"].loadFromJSON(jsonUpcv3)); });
        }
        return site;
    }
}
var State;
(function (State) {
    State[State["HIBERNATING"] = 0] = "HIBERNATING";
    State[State["RESERVE_1"] = 1] = "RESERVE_1";
    State[State["RESERVE_2"] = 2] = "RESERVE_2";
    State[State["DISABLE"] = 3] = "DISABLE";
})(State || (State = {}));


/***/ }),

/***/ "./src/app/model/stock.ts":
/*!********************************!*\
  !*** ./src/app/model/stock.ts ***!
  \********************************/
/*! exports provided: Stock */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Stock", function() { return Stock; });
/* harmony import */ var _bottleType__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./bottleType */ "./src/app/model/bottleType.ts");

class Stock {
    constructor() {
        this.id = '';
        this.name = '';
        this.bottleTypes = [];
        this.bottleTypeStringCeint = "";
        this.fullBottlesNumber = 0;
        this.emptyBottlesNumber = 0;
        this.selected = false;
    }
    get bottleTypesString() {
        var names = [];
        this.bottleTypes.forEach(bottleType => names.push(bottleType.designationString));
        return names.join(' | ');
    }
    static loadFromJSON(json) {
        var stock = Object.assign(new Stock, json);
        if (json.bottleTypes) {
            stock.bottleTypes = [];
            json.bottleTypes.forEach(jsonBottleType => { stock.bottleTypes.push(_bottleType__WEBPACK_IMPORTED_MODULE_0__["BottleType"].loadFromJSON(jsonBottleType)); });
        }
        return stock;
    }
}


/***/ }),

/***/ "./src/app/model/upcv3/LocalDateTime.ts":
/*!**********************************************!*\
  !*** ./src/app/model/upcv3/LocalDateTime.ts ***!
  \**********************************************/
/*! exports provided: LocalDateTime */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LocalDateTime", function() { return LocalDateTime; });
class LocalDateTime {
    constructor() {
        this.year = 1970;
        this.dayOfYear = 1;
        this.month = 'JANUARY';
        this.monthValue = 1;
        this.dayOfMonth = 1;
        this.dayOfWeek = 'MONDAY';
        this.hour = 0;
        this.minute = 0;
        this.second = 0;
        this.nano = 0;
    }
    get daysFromNow() {
        return Math.round((new Date().getTime() - new Date(this.year, this.monthValue - 1, this.dayOfMonth, this.hour, this.minute, this.second).getTime()) / (1000 * 60 * 60 * 24));
    }
    get hoursFromNow() {
        return Math.round((new Date().getTime() - new Date(this.year, this.monthValue - 1, this.dayOfMonth, this.hour, this.minute, this.second).getTime()) / (1000 * 60 * 60));
    }
    get minutesFromNow() {
        return Math.round((new Date().getTime() - new Date(this.year, this.monthValue - 1, this.dayOfMonth, this.hour, this.minute, this.second).getTime()) / (1000 * 60));
    }
    static loadFromJSON(json) {
        return Object.assign(new LocalDateTime, json);
    }
    get date() {
        return new Date(this.year, this.monthValue - 1, this.dayOfMonth);
    }
    isBefore(date) {
        return new Date(this.year, this.monthValue - 1, this.dayOfMonth) <= new Date(date.year, date.monthValue - 1, date.dayOfMonth);
    }
    isAfter(date) {
        return new Date(this.year, this.monthValue - 1, this.dayOfMonth) >= new Date(date.year, date.monthValue - 1, date.dayOfMonth);
    }
    isEqual(date) {
        return new Date(this.year, this.monthValue - 1, this.dayOfMonth) == new Date(date.year, date.monthValue - 1, date.dayOfMonth);
    }
    toLocaleString() {
        return new Date(this.year, this.monthValue - 1, this.dayOfMonth, this.hour, this.minute, this.second).toLocaleString();
    }
    toLocaleDateString() {
        return new Date(this.year, this.monthValue - 1, this.dayOfMonth).toLocaleDateString();
    }
    static getLastDayOfMonth(year, month) {
        return new Date(year, month, 0).getDate();
    }
}


/***/ }),

/***/ "./src/app/model/upcv3/alarmsParameters.ts":
/*!*************************************************!*\
  !*** ./src/app/model/upcv3/alarmsParameters.ts ***!
  \*************************************************/
/*! exports provided: AlarmsParameters */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AlarmsParameters", function() { return AlarmsParameters; });
class AlarmsParameters {
    constructor() {
        this.alrResLowEn = false;
        this.alrResEmptyEn = false;
        this.alrPresInpEn = false;
        this.alrPresOutEn = false;
        this.alrFlowAvgEn = false;
        this.alrPowBackEn = false;
        this.alrPowDownEn = false;
        this.alrEmptyPress = 0;
        this.alrEmptyVol = 0;
        this.alrPresInpTol = 0;
        this.alrPresOutTol = 0;
        this.alrFlowSetTol = 0;
        this.alrResLowLevel = 0;
        this.alrResEmptyFlow = 0;
        this.alrResEmptyTest = 3600;
        this.alrSmsNum1 = "";
        this.alrSmsNum2 = "";
        this.alrSmsNum3 = "";
        this.alrSmsNum4 = "";
        this.alrSmsNum5 = "";
        this.alrPressInpSet1_1 = 0;
        this.alrPressInpSet1_2 = 0;
        this.alrPressInpSet1_3 = 0;
        this.alrPressInpSet1_4 = 0;
        this.alrPressInpSet1_5 = 0;
        this.alrPressInpSet1_6 = 0;
        this.alrPressInpSet1_7 = 0;
        this.alrPressInpSet1_8 = 0;
        this.alrPressInpSet1_9 = 0;
        this.alrPressInpSet1_10 = 0;
        this.alrPressInpSet2_1 = 0;
        this.alrPressInpSet2_2 = 0;
        this.alrPressInpSet2_3 = 0;
        this.alrPressInpSet2_4 = 0;
        this.alrPressInpSet2_5 = 0;
        this.alrPressInpSet2_6 = 0;
        this.alrPressInpSet2_7 = 0;
        this.alrPressInpSet2_8 = 0;
        this.alrPressInpSet2_9 = 0;
        this.alrPressInpSet2_10 = 0;
        this.alrPressOutSet_1 = 0;
        this.alrPressOutSet_2 = 0;
        this.alrPressOutSet_3 = 0;
        this.alrPressOutSet_4 = 0;
        this.alrPressOutSet_5 = 0;
        this.alrPressOutSet_6 = 0;
        this.alrPressOutSet_7 = 0;
        this.alrPressOutSet_8 = 0;
        this.alrPressOutSet_9 = 0;
        this.alrPressOutSet_10 = 0;
        this.alrPressSetTemp = 0;
    }
    static loadFromJSON(json) {
        return Object.assign(new AlarmsParameters, json);
    }
}


/***/ }),

/***/ "./src/app/model/upcv3/communicationParameters.ts":
/*!********************************************************!*\
  !*** ./src/app/model/upcv3/communicationParameters.ts ***!
  \********************************************************/
/*! exports provided: CommunicationParameters */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CommunicationParameters", function() { return CommunicationParameters; });
class CommunicationParameters {
    constructor() {
        this.comWiFiName = "";
        this.comWiFiPass = "";
        this.comWiFiIpAdr = "";
        this.comGsmName = "";
        this.comGsmPass = "";
        this.comGsmIpAdr = "0.0.0.0";
        this.comGsmMode = 0;
        this.comGsmLevel = 0;
        this.comWebSrvUrl = "";
        this.comMdmApnId = "";
        this.comMdmApnId2 = "orange.m2m";
        this.comMdmApnUser = "orange";
        this.comMdmApnPass = "orange";
        this.comWifiApCh = 11;
        this.comMdmName = "";
        this.comMdmMode = 0;
        this.xComMdmRssuMoyen2G = 0;
        this.xComMdmRssuMoyen3G = 0;
        this.xComMdmRssuMoyen4G = 0;
        this.xComMdmQualMoyen2GGPRS = 0;
        this.xComMdmQualMoyen2GEDGE = 0;
        this.xComMdmQualMoyen3G = 0;
        this.xComMdmQualMoyen4G = 0;
        this.xComMdmRatioTimeIn2G = 0;
        this.xComMdmRatioTimeIn3G = 0;
        this.xComMdmRatioTimeIn4G = 0;
        this.xComMdmRatioTimeOffline = 0;
    }
    get comGsmModeString() {
        switch (this.comGsmMode) {
            case 0: return 'Non enregistré';
            case 1: return '2G GPRS';
            case 2: return '2G EDGE';
            case 3: return '3G WCDMA';
            case 4: return '3G HSDPA';
            case 5: return '3G HSUPA';
            case 6: return '3G HSDPA/HSUPA';
            case 7: return '4G';
        }
    }
    static loadFromJSON(json) {
        return Object.assign(new CommunicationParameters, json);
    }
}


/***/ }),

/***/ "./src/app/model/upcv3/correspondancesRegistres.ts":
/*!*********************************************************!*\
  !*** ./src/app/model/upcv3/correspondancesRegistres.ts ***!
  \*********************************************************/
/*! exports provided: CorrespondancesRegistres */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CorrespondancesRegistres", function() { return CorrespondancesRegistres; });
class CorrespondancesRegistres {
    constructor() {
        /* adr : adresse du registre | dim : dimension du registre */
        //General Parameters
        this.upcMcuUid = { adr: 40441, dim: 8, type: "int" };
        this.upcFwVer = { adr: 40168, dim: 1, type: "int" };
        this.upcNameId = { adr: 40001, dim: 10, type: "string" };
        this.upcNameIdW = { adr: 40580, dim: 20, type: "string" };
        this.upcEventNum = { adr: 40044, dim: 1, type: "int" };
        this.upcMode = { adr: 40011, dim: 1, type: "int" };
        this.upcInitRestore = { adr: 40067, dim: 1, type: "int" };
        this.upcStatus = { adr: 40376, dim: 1, type: "int" };
        this.upcClock = { adr: 40012, dim: 2, type: "int" };
        this.upcTimeZone = { adr: 40401, dim: 2, type: "int" };
        this.upcLanguage = { adr: 40014, dim: 1, type: "int" };
        //upcEventLog	= {adr : 40403, dim: 11, type: }
        this.upcTrapNum = { adr: 40015, dim: 1, type: "int" };
        this.co2FlowRefTrap = { adr: 40016, dim: 2, type: "float" };
        this.co2FlowRefNom = { adr: 40020, dim: 2, type: "float" };
        this.co2FlowRefAdj = { adr: 40018, dim: 2, type: "float" };
        this.co2PressOutRef = { adr: 40271, dim: 20, type: "float" };
        this.co2PressOutTemp = { adr: 40461, dim: 2, type: "float" };
        //communication		
        this.comMdmName = { adr: 40024, dim: 10, type: "string" };
        this.comMdmNameW = { adr: 40700, dim: 20, type: "string" };
        this.comMdmPass = { adr: 40034, dim: 10, type: "string" };
        this.comMdmPassW = { adr: 40820, dim: 20, type: "string" };
        this.comMdmIpAdr = { adr: 40022, dim: 2, type: "int" };
        this.comMdmMode = { adr: 40414, dim: 1, type: "int" };
        this.comMdmLevel = { adr: 40415, dim: 1, type: "int" };
        this.comWifiSsid = { adr: 40045, dim: 10, type: "string" };
        this.comWifiSsidW = { adr: 40720, dim: 20, type: "string" };
        this.comWifiPass = { adr: 40055, dim: 10, type: "string" };
        this.comWifiPassW = { adr: 40740, dim: 20, type: "string" };
        this.comWifiApCh = { adr: 40340, dim: 1, type: "int" };
        //CO2 diffusion
        this.diffHourSunRise = { adr: 40068, dim: 2, type: "int" };
        this.diffHourSunSet = { adr: 40070, dim: 2, type: "int" };
        this.diffCo2Program1Start = { adr: 40072, dim: 2, type: "int" };
        this.diffCo2Program1End = { adr: 40074, dim: 2, type: "int" };
        this.diffCo2Program1Frequency = { adr: 40076, dim: 1, type: "int" };
        this.diffCo2Program1Intensity = { adr: 40077, dim: 1, type: "int" };
        this.diffCo2Program2Start = { adr: 40078, dim: 2, type: "int" };
        this.diffCo2Program2End = { adr: 40080, dim: 2, type: "int" };
        this.diffCo2Program2Frequency = { adr: 40082, dim: 1, type: "int" };
        this.diffCo2Program2Intensity = { adr: 40083, dim: 1, type: "int" };
        this.diffCo2Program3Start = { adr: 40084, dim: 2, type: "int" };
        this.diffCo2Program3End = { adr: 40086, dim: 2, type: "int" };
        this.diffCo2Program3Frequency = { adr: 40088, dim: 1, type: "int" };
        this.diffCo2Program3Intensity = { adr: 40089, dim: 1, type: "int" };
        this.diffCo2Program4Start = { adr: 40090, dim: 2, type: "int" };
        this.diffCo2Program4End = { adr: 40092, dim: 2, type: "int" };
        this.diffCo2Program4Frequency = { adr: 40094, dim: 1, type: "int" };
        this.diffCo2Program4Intensity = { adr: 40095, dim: 1, type: "int" };
        this.diffCo2Program5Start = { adr: 40096, dim: 2, type: "int" };
        this.diffCo2Program5End = { adr: 40098, dim: 2, type: "int" };
        this.diffCo2Program5Frequency = { adr: 40100, dim: 1, type: "int" };
        this.diffCo2Program5Intensity = { adr: 40101, dim: 1, type: "int" };
        this.diffCo2Program6Start = { adr: 40102, dim: 2, type: "int" };
        this.diffCo2Program6End = { adr: 40104, dim: 2, type: "int" };
        this.diffCo2Program6Frequency = { adr: 40106, dim: 1, type: "int" };
        this.diffCo2Program6Intensity = { adr: 40107, dim: 1, type: "int" };
        this.diffCo2Program7Start = { adr: 40108, dim: 2, type: "int" };
        this.diffCo2Program7End = { adr: 40110, dim: 2, type: "int" };
        this.diffCo2Program7Frequency = { adr: 40112, dim: 1, type: "int" };
        this.diffCo2Program7Intensity = { adr: 40113, dim: 1, type: "int" };
        this.diffCo2Program8Start = { adr: 40114, dim: 2, type: "int" };
        this.diffCo2Program8End = { adr: 40116, dim: 2, type: "int" };
        this.diffCo2Program8Frequency = { adr: 40118, dim: 1, type: "int" };
        this.diffCo2Program8Intensity = { adr: 40119, dim: 1, type: "int" };
        this.diffCo2Program9Start = { adr: 40120, dim: 2, type: "int" };
        this.diffCo2Program9End = { adr: 40122, dim: 2, type: "int" };
        this.diffCo2Program9Frequency = { adr: 40124, dim: 1, type: "int" };
        this.diffCo2Program9Intensity = { adr: 40125, dim: 1, type: "int" };
        this.diffCo2Program10Start = { adr: 40126, dim: 2, type: "int" };
        this.diffCo2Program10End = { adr: 40128, dim: 2, type: "int" };
        this.diffCo2Program10Frequency = { adr: 40130, dim: 1, type: "int" };
        this.diffCo2Program10Intensity = { adr: 40131, dim: 1, type: "int" };
        this.diffCo2SunriseDelay = { adr: 40132, dim: 2, type: "int" };
        this.diffCo2SunriseDuration = { adr: 40134, dim: 2, type: "int" };
        this.diffCo2SunriseDaycode = { adr: 40136, dim: 2, type: "int" };
        this.diffCo2SunriseIntensity = { adr: 40137, dim: 2, type: "int" };
        this.diffCo2SunsetDelay = { adr: 40138, dim: 2, type: "int" };
        this.diffCo2SunsetDuration = { adr: 40140, dim: 2, type: "int" };
        this.diffCo2SunsetDaycode = { adr: 40142, dim: 2, type: "int" };
        this.diffCo2SunsetIntensity = { adr: 40143, dim: 2, type: "int" };
        //diffCo2Instant = {adr : 40144, dim: 6, type: }
        this.co2PressInpMeas1 = { adr: 40427, dim: 2, type: "float" };
        this.co2PressInpMeas2 = { adr: 40429, dim: 2, type: "float" };
        this.co2PressOutMeas = { adr: 40431, dim: 2, type: "float" };
        this.co2FlowMeas = { adr: 40433, dim: 2, type: "float" };
        this.co2PressInpAvg = { adr: 40435, dim: 2, type: "float" };
        this.co2PressInpOffs = { adr: 40455, dim: 2, type: "float" };
        this.co2PressOutAvg = { adr: 40437, dim: 2, type: "float" };
        this.co2PressoutOffs = { adr: 40457, dim: 2, type: "float" };
        this.co2PressOutComp = { adr: 40463, dim: 2, type: "float" };
        this.co2FlowAvg = { adr: 40439, dim: 2, type: "float" };
        this.co2FlowGain = { adr: 40390, dim: 2, type: "float" };
        this.co2FlowOffs = { adr: 40459, dim: 2, type: "float" };
        this.upcCo2DiffLvl = { adr: 40416, dim: 1, type: "int" };
        this.upcDiffLvlAdj = { adr: 40065, dim: 1, type: "int" };
        this.co2TempAvg = { adr: 40451, dim: 2, type: "float" };
        //C02 reserves
        this.co2ResActive = { adr: 40151, dim: 1, type: "int" };
        this.co2ResActAdj = { adr: 40150, dim: 1, type: "int" };
        this.co2ResActPrev = { adr: 40417, dim: 2, type: "int" };
        this.co2ResInactPrev = { adr: 40419, dim: 2, type: "int" };
        this.co2Res = { adr: 40382, dim: 1, type: "int" };
        this.co2Res1Status = { adr: 40381, dim: 1, type: "int" };
        this.co2Res1FillNew = { adr: 40384, dim: 2, type: "float" };
        this.co2Res1FillVol = { adr: 40153, dim: 2, type: "float" };
        this.co2Res1FillTime = { adr: 40155, dim: 2, type: "int" };
        this.co2Res1ActVol = { adr: 40157, dim: 2, type: "float" };
        this.co2Res1ActDur = { adr: 40159, dim: 1, type: "int" };
        this.co2Res1StartVol = { adr: 40421, dim: 2, type: "float" };
        this.co2Res1Bottle = { adr: 40342, dim: 5, type: "int" };
        this.co2Res1AuxVol = { adr: 40347, dim: 2, type: "float" };
        this.co2Res2Status = { adr: 40383, dim: 1, type: "int" };
        this.co2Res2FillNew = { adr: 40386, dim: 2, type: "float" };
        this.co2Res2FillVol = { adr: 40161, dim: 2, type: "float" };
        this.co2Res2FillTime = { adr: 40163, dim: 2, type: "int" };
        this.co2Res2ActVol = { adr: 40165, dim: 2, type: "float" };
        this.co2Res2ActDur = { adr: 40167, dim: 1, type: "int" };
        this.co2Res2StartVol = { adr: 40449, dim: 2, type: "float" };
        this.co2Res2Bottle = { adr: 40349, dim: 5, type: "int" };
        this.co2Res2AuxVol = { adr: 40354, dim: 2, type: "float" };
        //Alarms setup
        this.alrResEmptyTest = { adr: 40388, dim: 2, type: "int" };
        this.alrResLowEn = { adr: 40066, dim: 1, type: "int" };
        this.alrResEmptyEn = { adr: 40169, dim: 1, type: "int" };
        this.alrPressInpEn = { adr: 40170, dim: 1, type: "int" };
        this.alrPressOutEn = { adr: 40171, dim: 1, type: "int" };
        this.alrFlowAvgEn = { adr: 40172, dim: 1, type: "int" };
        this.alrPowDownEn = { adr: 40173, dim: 1, type: "int" };
        this.alrPowBackEn = { adr: 40174, dim: 1, type: "int" };
        this.alrSmsNum = { adr: 40175, dim: 50, type: "string" };
        this.alrSmsNumW = { adr: 40600, dim: 100, type: "string" };
        this.alrResLowLevel = { adr: 40227, dim: 2, type: "float" };
        this.alrResEmptyFlow = { adr: 40225, dim: 2, type: "float" };
        this.alrPressInpTol = { adr: 40269, dim: 2, type: "float" };
        this.alrPressOutTol = { adr: 40291, dim: 2, type: "float" };
        this.alrFlowSetTol = { adr: 40293, dim: 2, type: "float" };
        this.alrPressInpSet1 = { adr: 40229, dim: 20, type: "float" };
        this.alrPressInpSet2 = { adr: 40249, dim: 20, type: "float" };
        this.alrPressOutSet = { adr: 40356, dim: 20, type: "float" };
        this.alrPressSetTemp = { adr: 40465, dim: 2, type: "float" };
        //Auxiliary parameters
        this.comWebSrvUrl = { adr: 40295, dim: 15, type: "string" };
        this.comWebSrvUrlW = { adr: 40840, dim: 30, type: "string" };
        this.comMdmApnId1 = { adr: 40310, dim: 10, type: "string" };
        this.comMdmApnId2 = { adr: 40467, dim: 50, type: "string" };
        this.comMdmApnId1W = { adr: 40760, dim: 20, type: "string" };
        this.comMdmApnId2W = { adr: 40870, dim: 100, type: "string" };
        this.comMdmApnUser = { adr: 40320, dim: 10, type: "string" };
        this.comMdmApnUserW = { adr: 40780, dim: 20, type: "string" };
        this.comMdmApnPass = { adr: 40330, dim: 10, type: "string" };
        this.comMdmApnPassW = { adr: 40800, dim: 20, type: "string" };
        this.upcCo2PidProp = { adr: 40453, dim: 2, type: "float" };
        this.upcCo2PidInteg = { adr: 40377, dim: 2, type: "float" };
        this.upcCo2PidDiff = { adr: 40379, dim: 2, type: "float" };
        this.upcBattChrg = { adr: 40423, dim: 2, type: "float" };
        this.upcBattTemp = { adr: 40425, dim: 2, type: "float" };
        this.comMdmSrec = { adr: 41000, dim: 120, type: "string" };
        this.xCo2Res1CodesBarres = { adr: 41124, dim: 45, type: "string" };
        this.xCo2Res2CodesBarres = { adr: 41169, dim: 45, type: "string" };
        this.xComMdmRssiMoyen2G = { adr: 41219, dim: 2, type: "float" };
        this.xComMdmRssiMoyen3G = { adr: 41221, dim: 2, type: "float" };
        this.xComMdmRssiMoyen4G = { adr: 41223, dim: 2, type: "float" };
        this.xComMdmQualMoyen2GGPRS = { adr: 41225, dim: 2, type: "float" };
        this.xComMdmQualMoyen2GEDGE = { adr: 41227, dim: 2, type: "float" };
        this.xComMdmQualMoyen3G = { adr: 41229, dim: 2, type: "float" };
        this.xComMdmQualMoyen4G = { adr: 41231, dim: 2, type: "float" };
        this.xComMdmRatioTimeIn2G = { adr: 41233, dim: 2, type: "float" };
        this.xComMdmRatioTimeIn3G = { adr: 41235, dim: 2, type: "float" };
        this.xComMdmRatioTimeIn4G = { adr: 41237, dim: 2, type: "float" };
        this.xComMdmRatioTimeOffline = { adr: 41239, dim: 2, type: "float" };
    }
}


/***/ }),

/***/ "./src/app/model/upcv3/defaultUPCV3Params.ts":
/*!***************************************************!*\
  !*** ./src/app/model/upcv3/defaultUPCV3Params.ts ***!
  \***************************************************/
/*! exports provided: DefaultUPCV3Params */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DefaultUPCV3Params", function() { return DefaultUPCV3Params; });
class DefaultUPCV3Params {
    static loadFromJSON(json) {
        return Object.assign(new DefaultUPCV3Params, json);
    }
}


/***/ }),

/***/ "./src/app/model/upcv3/diffCo2.ts":
/*!****************************************!*\
  !*** ./src/app/model/upcv3/diffCo2.ts ***!
  \****************************************/
/*! exports provided: DiffCo2 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DiffCo2", function() { return DiffCo2; });
class DiffCo2 {
    constructor() {
        this.delay = 0;
        this.duration = 0;
        this.intensity = 0;
    }
    static loadFromJSON(json) {
        return Object.assign(new DiffCo2, json);
    }
}


/***/ }),

/***/ "./src/app/model/upcv3/diffCo2Program.ts":
/*!***********************************************!*\
  !*** ./src/app/model/upcv3/diffCo2Program.ts ***!
  \***********************************************/
/*! exports provided: DiffCo2Program, DaysCode, intensities, daysCodes */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DiffCo2Program", function() { return DiffCo2Program; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DaysCode", function() { return DaysCode; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "intensities", function() { return intensities; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "daysCodes", function() { return daysCodes; });
class DiffCo2Program {
    constructor() {
        this.daysCode = 7;
        this.start = "00:00:00";
        this.end = "00:00:00";
        this.intensity = 0;
    }
    static loadFromJSON(json) {
        return Object.assign(new DiffCo2Program, json);
    }
}
var DaysCode;
(function (DaysCode) {
    DaysCode[DaysCode["Sunday"] = 0] = "Sunday";
    DaysCode[DaysCode["Monday"] = 1] = "Monday";
    DaysCode[DaysCode["Tuesday"] = 2] = "Tuesday";
    DaysCode[DaysCode["Wednesday"] = 3] = "Wednesday";
    DaysCode[DaysCode["Thursday"] = 4] = "Thursday";
    DaysCode[DaysCode["Friday"] = 5] = "Friday";
    DaysCode[DaysCode["Saturday"] = 6] = "Saturday";
    DaysCode[DaysCode["All week"] = 7] = "All week";
    DaysCode[DaysCode["Weekend"] = 8] = "Weekend";
    DaysCode[DaysCode["Midweek"] = 9] = "Midweek";
})(DaysCode || (DaysCode = {}));
const intensities = [
    { name: 'Désactivée', value: 0 },
    { name: '1', value: 1 },
    { name: '2', value: 2 },
    { name: '3', value: 3 },
    { name: '4', value: 4 },
    { name: '5', value: 5 },
    { name: '6', value: 6 },
    { name: '7', value: 7 },
    { name: '8', value: 8 },
    { name: '9', value: 9 },
    { name: '10', value: 10 }
];
const daysCodes = [
    { name: 'Tous les jours', value: DaysCode['All week'] },
    { name: 'Semaine', value: DaysCode['Midweek'] },
    { name: 'Weekend', value: DaysCode['Weekend'] },
    { name: 'Lundi', value: DaysCode['Monday'] },
    { name: 'Mardi', value: DaysCode['Tuesday'] },
    { name: 'Mercredi', value: DaysCode['Wednesday'] },
    { name: 'Jeudi', value: DaysCode['Thursday'] },
    { name: 'Vendredi', value: DaysCode['Friday'] },
    { name: 'Samedi', value: DaysCode['Saturday'] },
    { name: 'Dimanche', value: DaysCode['Sunday'] }
];


/***/ }),

/***/ "./src/app/model/upcv3/diffusionParameters.ts":
/*!****************************************************!*\
  !*** ./src/app/model/upcv3/diffusionParameters.ts ***!
  \****************************************************/
/*! exports provided: DiffusionParameters */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DiffusionParameters", function() { return DiffusionParameters; });
/* harmony import */ var _diffCo2Program__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./diffCo2Program */ "./src/app/model/upcv3/diffCo2Program.ts");
/* harmony import */ var _diffCo2__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./diffCo2 */ "./src/app/model/upcv3/diffCo2.ts");


class DiffusionParameters {
    constructor() {
        this.diffHourSunrise = 0;
        this.diffHourSunset = 0;
        this.diffCo2Program1 = new _diffCo2Program__WEBPACK_IMPORTED_MODULE_0__["DiffCo2Program"]();
        this.diffCo2Program2 = new _diffCo2Program__WEBPACK_IMPORTED_MODULE_0__["DiffCo2Program"]();
        this.diffCo2Program3 = new _diffCo2Program__WEBPACK_IMPORTED_MODULE_0__["DiffCo2Program"]();
        this.diffCo2Program4 = new _diffCo2Program__WEBPACK_IMPORTED_MODULE_0__["DiffCo2Program"]();
        this.diffCo2Program5 = new _diffCo2Program__WEBPACK_IMPORTED_MODULE_0__["DiffCo2Program"]();
        this.diffCo2Program6 = new _diffCo2Program__WEBPACK_IMPORTED_MODULE_0__["DiffCo2Program"]();
        this.diffCo2Program7 = new _diffCo2Program__WEBPACK_IMPORTED_MODULE_0__["DiffCo2Program"]();
        this.diffCo2Program8 = new _diffCo2Program__WEBPACK_IMPORTED_MODULE_0__["DiffCo2Program"]();
        this.diffCo2Program9 = new _diffCo2Program__WEBPACK_IMPORTED_MODULE_0__["DiffCo2Program"]();
        this.diffCo2Program10 = new _diffCo2Program__WEBPACK_IMPORTED_MODULE_0__["DiffCo2Program"]();
        this.diffCo2Sunrise = new _diffCo2__WEBPACK_IMPORTED_MODULE_1__["DiffCo2"]();
        this.diffCo2Sunset = new _diffCo2__WEBPACK_IMPORTED_MODULE_1__["DiffCo2"]();
        this.diffCo2Instant = new _diffCo2__WEBPACK_IMPORTED_MODULE_1__["DiffCo2"]();
        this.co2PresInpMeas1 = 0;
        this.co2PresInpMeas2 = 0;
        this.co2PresOutMeas = 0;
        this.co2FlowMeas = 0;
        this.co2PresInpAvg = 0;
        this.co2PressInpOffs = 0;
        this.co2PresOutAvg = 0;
        this.co2PressOutOffs = 0;
        this.co2PressOutComp = 0;
        this.co2FlowAvg = 0;
        this.co2FlowOffs = 0;
        this.co2FlowGain = 0;
        this.upcCo2DiffLvl = 0;
        this.upcDiffLvlAdj = 0;
        this.co2TempAvg = 0;
    }
    static loadFromJSON(json) {
        var diffusionParameters = Object.assign(new DiffusionParameters, json);
        if (json.diffCo2Program1)
            diffusionParameters.diffCo2Program1 = _diffCo2Program__WEBPACK_IMPORTED_MODULE_0__["DiffCo2Program"].loadFromJSON(json.diffCo2Program1);
        if (json.diffCo2Program2)
            diffusionParameters.diffCo2Program2 = _diffCo2Program__WEBPACK_IMPORTED_MODULE_0__["DiffCo2Program"].loadFromJSON(json.diffCo2Program2);
        if (json.diffCo2Program3)
            diffusionParameters.diffCo2Program3 = _diffCo2Program__WEBPACK_IMPORTED_MODULE_0__["DiffCo2Program"].loadFromJSON(json.diffCo2Program3);
        if (json.diffCo2Program4)
            diffusionParameters.diffCo2Program4 = _diffCo2Program__WEBPACK_IMPORTED_MODULE_0__["DiffCo2Program"].loadFromJSON(json.diffCo2Program4);
        if (json.diffCo2Program5)
            diffusionParameters.diffCo2Program5 = _diffCo2Program__WEBPACK_IMPORTED_MODULE_0__["DiffCo2Program"].loadFromJSON(json.diffCo2Program5);
        if (json.diffCo2Program6)
            diffusionParameters.diffCo2Program6 = _diffCo2Program__WEBPACK_IMPORTED_MODULE_0__["DiffCo2Program"].loadFromJSON(json.diffCo2Program6);
        if (json.diffCo2Program7)
            diffusionParameters.diffCo2Program7 = _diffCo2Program__WEBPACK_IMPORTED_MODULE_0__["DiffCo2Program"].loadFromJSON(json.diffCo2Program7);
        if (json.diffCo2Program8)
            diffusionParameters.diffCo2Program8 = _diffCo2Program__WEBPACK_IMPORTED_MODULE_0__["DiffCo2Program"].loadFromJSON(json.diffCo2Program8);
        if (json.diffCo2Program9)
            diffusionParameters.diffCo2Program9 = _diffCo2Program__WEBPACK_IMPORTED_MODULE_0__["DiffCo2Program"].loadFromJSON(json.diffCo2Program9);
        if (json.diffCo2Program10)
            diffusionParameters.diffCo2Program10 = _diffCo2Program__WEBPACK_IMPORTED_MODULE_0__["DiffCo2Program"].loadFromJSON(json.diffCo2Program10);
        if (json.diffCo2Sunrise)
            diffusionParameters.diffCo2Sunrise = _diffCo2__WEBPACK_IMPORTED_MODULE_1__["DiffCo2"].loadFromJSON(json.diffCo2Sunrise);
        if (json.diffCo2Sunset)
            diffusionParameters.diffCo2Sunset = _diffCo2__WEBPACK_IMPORTED_MODULE_1__["DiffCo2"].loadFromJSON(json.diffCo2Sunset);
        if (json.diffCo2Instant)
            diffusionParameters.diffCo2Instant = _diffCo2__WEBPACK_IMPORTED_MODULE_1__["DiffCo2"].loadFromJSON(json.diffCo2Instant);
        return diffusionParameters;
    }
}


/***/ }),

/***/ "./src/app/model/upcv3/generalParameters.ts":
/*!**************************************************!*\
  !*** ./src/app/model/upcv3/generalParameters.ts ***!
  \**************************************************/
/*! exports provided: GeneralParameters */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GeneralParameters", function() { return GeneralParameters; });
class GeneralParameters {
    constructor() {
        this.upcMcuUid = "";
        this.upcFwVer = 0;
        this.upcMode = 0;
        this.upcStatus = 0;
        this.upcTimeZone = 0;
        this.upcLanguage = 0;
        this.upcTrapNum = 0;
        this.co2FlowRefTrap = 0;
        this.refFlowRateGperhour = 0;
        this.co2FlowRefNom = 0;
        this.co2FlowRefAdj = 0;
        this.co2PresOutRef1 = 0;
        this.co2PresOutRef2 = 0;
        this.co2PresOutRef3 = 0;
        this.co2PresOutRef4 = 0;
        this.co2PresOutRef5 = 0;
        this.co2PresOutRef6 = 0;
        this.co2PresOutRef7 = 0;
        this.co2PresOutRef8 = 0;
        this.co2PresOutRef9 = 0;
        this.co2PresOutRef10 = 0;
        this.co2PressOutTemp = 0;
        this.upcBattChrg = 0;
        this.upcBattTemp = 0;
        this.upcCo2PidInteg = 0;
        this.upcCo2PidDiff = 0;
        this.upcCo2PidProp = 300;
    }
    static loadFromJSON(json) {
        return Object.assign(new GeneralParameters, json);
    }
}


/***/ }),

/***/ "./src/app/model/upcv3/modbus.ts":
/*!***************************************!*\
  !*** ./src/app/model/upcv3/modbus.ts ***!
  \***************************************/
/*! exports provided: Events, StateMachine, MODBUS_CONSTS, ModbusRequest, ReadCoilsRequest, ReadHoldingRegistersRequest, ReadInputRegistersRequest, WriteSingleCoilRequest, WriteSingleRegisterRequest, WriteMultipleRegistersRequest, ModbusRequestManager, ModbusClient, UPCDiffCo2Program, UPCDiffCo2Sun */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Events", function() { return Events; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "StateMachine", function() { return StateMachine; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MODBUS_CONSTS", function() { return MODBUS_CONSTS; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ModbusRequest", function() { return ModbusRequest; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ReadCoilsRequest", function() { return ReadCoilsRequest; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ReadHoldingRegistersRequest", function() { return ReadHoldingRegistersRequest; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ReadInputRegistersRequest", function() { return ReadInputRegistersRequest; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "WriteSingleCoilRequest", function() { return WriteSingleCoilRequest; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "WriteSingleRegisterRequest", function() { return WriteSingleRegisterRequest; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "WriteMultipleRegistersRequest", function() { return WriteMultipleRegistersRequest; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ModbusRequestManager", function() { return ModbusRequestManager; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ModbusClient", function() { return ModbusClient; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "UPCDiffCo2Program", function() { return UPCDiffCo2Program; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "UPCDiffCo2Sun", function() { return UPCDiffCo2Sun; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! jquery */ "./node_modules/jquery/dist/jquery.js");
/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(jquery__WEBPACK_IMPORTED_MODULE_1__);


class Events {
    constructor() {
        this.cbList = {};
    }
    fire(name, args) {
        if (!this.cbList[name])
            return;
        for (var i in this.cbList[name])
            this.cbList[name][i].apply(this, args);
        return this;
    }
    fireLater(name, args) {
        if (args === undefined)
            args = [];
        return function () {
            var aA = Array.prototype.slice.call(arguments, 0), a = args.concat(aA);
            this.fire(name, a.length > 0 ? a : undefined);
        }.bind(this);
    }
    on(name, func) {
        if (!this.cbList.hasOwnProperty(name))
            this.cbList[name] = [];
        this.cbList[name].push(func);
        return {
            name: name,
            index: this.cbList[name].length - 1
        };
    }
    off(id) {
        this.cbList[id.name].splice(id.index);
        return this;
    }
}
class StateMachine extends Events {
    constructor(initState) {
        super();
        this.state = null;
        this.state = initState;
    }
    inState(newState) {
        return this.state === newState;
    }
    setState(newState) {
        var oldState = this.state;
        this.state = newState;
        this.fire('state_changed', [oldState, newState]);
        return this;
    }
}
StateMachine.ctorParameters = () => [
    null
];
const MODBUS_CONSTS = {
    MBAP_TID: 0,
    MBAP_PID: 2,
    MBAP_LEN: 4,
    MBAP_UID: 6,
    BODY_FC: 0,
    BODY_START: 1,
    BODY_COUNT: 3,
    READ_COILS: 1,
    READ_HOLDING_REGISTERS: 3,
    READ_INPUT_REGISTERS: 4,
    WRITE_SINGLE_COIL: 5,
    WRITE_SINGLE_REGISTER: 6,
    WRITE_MULTIPLE_REGISTERS: 16
};
class ModbusRequest {
    constructor(id, length) {
        this.timeout = null;
        this.id = id;
        this.length = length;
        this.deferred = jquery__WEBPACK_IMPORTED_MODULE_1__["Deferred"]();
        this.packet = new ArrayBuffer(length);
        this.header = new DataView(this.packet, 0, 7);
        // Init
        this.header.setUint16(MODBUS_CONSTS.MBAP_TID, this.id);
        this.header.setUint16(MODBUS_CONSTS.MBAP_PID, 0);
        this.header.setUint16(MODBUS_CONSTS.MBAP_LEN, this.length - 6);
        this.header.setUint8(MODBUS_CONSTS.MBAP_UID, 1);
    }
    getPromise() {
        return this.deferred.promise();
    }
    reject(...args) {
        this.deferred.reject.apply(null, args);
        return this;
    }
    resolve(...args) {
        this.deferred.resolve.apply(null, args);
        return this;
    }
    setTimeout(to) {
        this.timeout = to;
        return this;
    }
}
ModbusRequest.ctorParameters = () => [
    null,
    null
];
class ReadCoilsRequest extends ModbusRequest {
    constructor(id, start, count) {
        super(id, 12);
        this.start = start;
        this.count = count;
        // Init
        this.body = new DataView(this.packet, 7, 5);
        this.body.setUint8(MODBUS_CONSTS.BODY_FC, MODBUS_CONSTS.READ_COILS);
        this.body.setUint16(MODBUS_CONSTS.BODY_START, this.start);
        this.body.setUint16(MODBUS_CONSTS.BODY_COUNT, this.count);
    }
    handleResponse(data, offset) {
        var mbap = new DataView(data, offset, 7), pdu = new DataView(data, offset + 7, 2), fc = pdu.getUint8(0), byte_count = pdu.getUint8(1);
        if (fc > 0x80) {
            this.reject({ errCode: 'serverError' });
            return 2;
        }
        var dv = new DataView(data, offset + 9, byte_count), fc_data = [], i, t, j, mask, c = this.count;
        for (i = 0; i < this.count; i += 1) {
            t = dv.getUint8(i);
            for (j = 0; j < 7; j += 1) {
                mask = 1 << j;
                if (mask !== 0)
                    fc_data.push(t & mask);
                c -= 1;
                if (c === 0)
                    break;
            }
        }
        this.resolve(fc_data, this);
        return byte_count + 2;
    }
}
ReadCoilsRequest.ctorParameters = () => [
    null,
    null,
    null
];
class ReadHoldingRegistersRequest extends ModbusRequest {
    constructor(id, start, count) {
        super(id, 12);
        this.start = start;
        this.count = count;
        // Init
        this.body = new DataView(this.packet, 7, 5);
        this.body.setUint8(MODBUS_CONSTS.BODY_FC, MODBUS_CONSTS.READ_HOLDING_REGISTERS);
        this.body.setUint16(MODBUS_CONSTS.BODY_START, this.start);
        this.body.setUint16(MODBUS_CONSTS.BODY_COUNT, this.count);
    }
    handleResponse(data, offset) {
        var mbap = new DataView(data, offset, 7), pdu = new DataView(data, offset + 7, 2), fc = pdu.getUint8(0), byte_count = pdu.getUint8(1);
        if (fc > 0x80) {
            this.reject({ errCode: 'serverError' });
            return 2;
        }
        var dv = new DataView(data, offset + 7 + 2, byte_count), fc_data = [];
        for (var i = 0; i < byte_count / 2; i += 1) {
            fc_data.push(dv.getUint16(i * 2));
        }
        this.resolve(fc_data, this);
        return byte_count + 2;
    }
}
ReadHoldingRegistersRequest.ctorParameters = () => [
    null,
    null,
    null
];
class ReadInputRegistersRequest extends ModbusRequest {
    constructor(id, start, count) {
        super(id, 12);
        this.start = start;
        this.count = count;
        // Init
        this.body = new DataView(this.packet, 7, 5);
        this.body.setUint8(MODBUS_CONSTS.BODY_FC, MODBUS_CONSTS.READ_INPUT_REGISTERS);
        this.body.setUint16(MODBUS_CONSTS.BODY_START, this.start);
        this.body.setUint16(MODBUS_CONSTS.BODY_COUNT, this.count);
    }
    handleResponse(data, offset) {
        var mbap = new DataView(data, offset, 7), pdu = new DataView(data, offset + 7, 2), fc = pdu.getUint8(0), byte_count = pdu.getUint8(1);
        if (fc > 0x80) {
            this.reject({ errCode: 'serverError' });
            return 2;
        }
        var dv = new DataView(data, offset + 7 + 2, byte_count), fc_data = [];
        for (var i = 0; i < byte_count / 2; i += 1) {
            fc_data.push(dv.getUint16(i * 2));
        }
        this.resolve(fc_data, this);
        return byte_count + 2;
    }
}
ReadInputRegistersRequest.ctorParameters = () => [
    null,
    null,
    null
];
class WriteSingleCoilRequest extends ModbusRequest {
    constructor(id, address, value) {
        super(id, 12);
        this.address = address;
        this.value = value;
        // Init
        this.body = new DataView(this.packet, 7, 5);
        this.body.setUint8(MODBUS_CONSTS.BODY_FC, MODBUS_CONSTS.WRITE_SINGLE_COIL);
        this.body.setUint16(MODBUS_CONSTS.BODY_START, this.address);
        this.body.setUint16(MODBUS_CONSTS.BODY_COUNT, this.value ? 65280 : 0);
    }
    handleResponse(data, offset) {
        var mbap = new DataView(data, offset, 7), pdu = new DataView(data, offset + 7, 5), fc = pdu.getUint8(0), start = pdu.getUint8(1), value = pdu.getUint16(3);
        if (fc > 0x80) {
            this.reject({ errCode: 'serverError' });
            return 2;
        }
        this.resolve(this);
        return 5;
    }
}
WriteSingleCoilRequest.ctorParameters = () => [
    null,
    null,
    null
];
class WriteSingleRegisterRequest extends ModbusRequest {
    constructor(id, address, value) {
        super(id, 12);
        this.address = address;
        this.value = value;
        // Init
        this.body = new DataView(this.packet, 7, 5);
        this.body.setUint8(MODBUS_CONSTS.BODY_FC, MODBUS_CONSTS.WRITE_SINGLE_REGISTER);
        this.body.setUint16(MODBUS_CONSTS.BODY_START, this.address);
        this.body.setUint16(MODBUS_CONSTS.BODY_COUNT, this.value);
    }
    handleResponse(data, offset) {
        var mbap = new DataView(data, offset, 7), pdu = new DataView(data, offset + 7, 5), fc = pdu.getUint8(0), start = pdu.getUint16(1), value = pdu.getUint16(3);
        if (fc > 0x80) {
            this.reject({ errCode: 'serverError' });
            return 2;
        }
        this.resolve(this);
        return 5;
    }
}
WriteSingleRegisterRequest.ctorParameters = () => [
    null,
    null,
    null
];
class WriteMultipleRegistersRequest extends ModbusRequest {
    constructor(id, address, values) {
        super(id, 7 + 6 + (values.length * 2));
        this.address = address;
        this.values = values;
        // Init
        this.body = new DataView(this.packet, 7, 6 + (this.values.length * 2));
        this.body.setUint8(MODBUS_CONSTS.BODY_FC, MODBUS_CONSTS.WRITE_MULTIPLE_REGISTERS);
        this.body.setUint16(1, this.address);
        this.body.setUint16(3, this.values.length);
        this.body.setUint8(5, 2 * this.values.length);
        this.values.forEach(function (v, i) {
            this.body.setUint16(6 + (i * 2), v);
        }.bind(this));
    }
    handleResponse(data, offset) {
        var mbap = new DataView(data, offset, 7), pdu = new DataView(data, offset + 7, 5), fc = pdu.getUint8(0), start = pdu.getUint16(1), quant = pdu.getUint16(3);
        if (fc > 0x80) {
            this.reject({ errCode: 'serverError' });
            return 2;
        }
        this.resolve(this);
        return 5;
    }
}
WriteMultipleRegistersRequest.ctorParameters = () => [
    null,
    null,
    null
];
class ModbusRequestManager extends StateMachine {
    constructor(verbose = false) {
        super('ready');
        this.queue = [];
        this.socketId = 1;
        this.receiveBuffer = [];
        this.verbose = false;
        this.currentRequest = null;
        this.socketId = 1;
        this.verbose = verbose;
        // Init
        window['chrome'].sockets.tcp.onReceive.addListener(this.receiveListener.bind(this));
        this.on('state_changed', function onStateChanged(oldState, newState) {
            if (newState === 'ready')
                this.send();
        }.bind(this));
    }
    receiveListener(info) {
        if (info.socketId !== this.socketId)
            return;
        if (this.inState('waiting')) {
            this.receiveBuffer.push(info);
            this.handleResponse();
        }
        else
            throw new Error('ModbusRequestManager - Received Packet while in state "waiting".');
    }
    handleResponse() {
        if (this.verbose)
            console.log('ModbusRequestManager', 'Trying to handle response.');
        if (this.receiveBuffer.length === null)
            return;
        var response = this.receiveBuffer.shift(), data = response.data;
        if (data.byteLength < 7) {
            if (this.verbose)
                console.log('ModbusRequestManager', 'Wrong packet size.', (data.byteLength));
            return;
        }
        // read the header
        var mbap = new DataView(data, 0, 7), tid = mbap.getUint16(0);
        if (!this.currentRequest) {
            if (this.verbose)
                console.error('ModbusRequestManager', 'No current request, strange!!', this.currentRequest);
            return;
        }
        if (this.currentRequest.id !== tid) {
            if (this.verbose)
                console.error('ModbusRequestManager', 'CurrentRequest tid !== received tid', this.currentRequest.id, tid);
            return;
        }
        if (this.verbose)
            console.log('ModbusRequestManager', 'Request handled fine.');
        // cleartimeout
        clearTimeout(this.currentRequest.timeout);
        // handle fc response
        this.currentRequest.handleResponse(data, 0);
        this.setState('ready');
    }
    send() {
        if (this.queue.length === 0) {
            if (this.verbose)
                console.log('ModbusRequestManager', 'Nothing in Queue.');
            return;
        }
        this.setState('sending');
        if (this.verbose)
            console.log('ModbusRequestManager', 'Trying to send packet.');
        this.currentRequest = this.queue.shift();
        // Before sending set the timeout for this request
        var timeout_no = setTimeout(function () {
            if (this.verbose)
                console.log('ModbusRequestManager', 'Timeout occured.');
            this.currentRequest.reject({ errCode: 'timeout' });
            this.fire('error', [{ errCode: 'timeout' }]);
        }.bind(this), 10000);
        this.currentRequest.setTimeout(timeout_no);
        if (this.verbose)
            console.log('ModbusRequestManager', 'Sending packet...');
        window['chrome'].sockets.tcp.send(this.socketId, this.currentRequest.packet, function (sendInfo) {
            if (sendInfo.resultCode < 0) {
                if (this.verbose)
                    console.log('ModbusRequestManager', 'A error occured while sending packet.', sendInfo.resultCode);
                this.currentRequest.reject({ errCode: 'sendError' });
                this.setState('ready');
                return;
            }
            if (this.verbose)
                console.log('ModbusRequestManager', 'Packet send! Waiting for response.');
            this.setState('waiting');
        }.bind(this));
    }
    setSocketId(id) {
        this.socketId = id;
        return this;
    }
    sendPacket(packet) {
        if (this.verbose)
            console.log('ModbusRequestManager', 'Queing a new packet.');
        this.queue.push(packet);
        if (this.socketId === null) {
            throw new Error('ModbusRequestManager - No socketId provided.');
        }
        if (!this.inState('ready')) {
            return;
        }
        this.send();
        return this;
    }
    clear() {
        while (this.queue.length > 0) {
            this.queue.pop().reject({ 'errCode': 'clientOffline' });
        }
        this.setState('ready');
    }
    flush() {
        if (this.verbose)
            console.log('ModbusRequestManager', 'Flush');
        if (this.socketId === null)
            return;
        this.send();
        return this;
    }
}
ModbusRequestManager.ctorParameters = () => [
    { type: Boolean }
];
class ModbusClient extends StateMachine {
    constructor(timeout = 32000, autoreconnect = true, verbose = true) {
        super('init');
        this.host = '10.1.1.1';
        this.port = 502;
        this.id = 0;
        this.isWaiting = false;
        this.isReconnecting = false;
        this.socketId = 0;
        this.timeout = 32000;
        this.autoreconnect = true;
        this.verbose = true;
        this.timeout = timeout;
        this.autoreconnect = autoreconnect;
        this.verbose = verbose;
        this.requestManager = new ModbusRequestManager(verbose);
        // Init
        this.requestManager.on('error', function (err) {
            if (this.inState('offline'))
                return;
            this.fire('error', [err]);
            if (this.autoreconnect)
                this.reconnect();
            else
                this.disconnect();
        }.bind(this));
        // flush everything when going from error to online again
        this.on('state_changed', function (oldState, newState) {
            if (this.verbose)
                console.log('state changed', oldState, newState);
            this.fire(newState);
            if (oldState === 'error' && newState === 'online')
                this.requestManager.flush();
        }.bind(this));
        this.on('offline', function () {
            this.requestManager.clear();
        }.bind(this));
        this.on('online', function () {
            this.isReconnecting = false;
        }.bind(this));
        this.on('error', function () {
            this.isReconnecting = false;
        }.bind(this));
        this.createSocket();
    }
    onReceiveError(info) {
        if (this.verbose)
            console.log('ModbusClient', 'Receive Error occured.', info, this.socketId);
        if (info.socketId !== this.socketId)
            return;
        this.setState('offline');
        this.fire('error', [{ errCode: 'ServerError', args: arguments }]);
        if (this.autoreconnect) {
            if (this.verbose)
                console.log('ModbusClient', 'AutoReconnect enabled, reconnecting.');
            this.reconnect();
            return;
        }
        if (this.verbose)
            console.log('ModbusClient', 'Disconnecting client.');
        this.close();
    }
    createSocket() {
        return new Promise((resolve, reject) => tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            if (this.verbose)
                console.log('ModbusClient', 'Creating socket.');
            window['chrome'].sockets.tcp.onReceiveError.addListener(this.onReceiveError.bind(this));
            window['chrome'].sockets.tcp.create({}, function (createInfo) {
                if (this.verbose)
                    console.log('ModbusClient', 'Socket created.', createInfo);
                this.socketId = createInfo.socketId;
                this.requestManager.setSocketId(this.socketId);
                this.setState('offline');
                this.fire('ready');
                this.setHost(this.host);
                this.setPort(this.port);
                this.connect();
                resolve();
            }.bind(this));
        }));
    }
    createNewId() {
        this.id = (this.id + 1) % 10000;
        return this.id;
    }
    sendPacket(req) {
        // invalid states for sending packages
        if (!this.inState('online'))
            return;
        this.requestManager.sendPacket(req);
    }
    isOnline() {
        return this.inState('online');
    }
    readCoils(start, count) {
        var request = new ReadCoilsRequest(this.createNewId(), start, count);
        if (!this.inState('online')) {
            request.reject({ errCode: 'offline' });
            return request.getPromise();
        }
        this.sendPacket(request);
        return request.getPromise();
    }
    readHoldingRegisters(start, count) {
        var request = new ReadHoldingRegistersRequest(this.createNewId(), start, count);
        if (!this.inState('online')) {
            request.reject({ errCode: 'offline' });
            return request.getPromise();
        }
        this.sendPacket(request);
        return request.getPromise();
    }
    readInputRegisters(start, count) {
        var request = new ReadInputRegistersRequest(this.createNewId(), start, count);
        if (!this.inState('online')) {
            request.reject({ errCode: 'offline' });
            return request.getPromise();
        }
        this.sendPacket(request);
        return request.getPromise();
    }
    writeSingleCoil(address, value) {
        var request = new WriteSingleCoilRequest(this.createNewId(), address, value);
        if (!this.inState('online')) {
            request.reject({ errCode: 'offline' });
            return request.getPromise();
        }
        this.sendPacket(request);
        return request.getPromise();
    }
    writeSingleRegister(address, value) {
        var request = new WriteSingleRegisterRequest(this.createNewId(), address, value);
        if (!this.inState('online')) {
            request.reject({ errCode: 'offline' });
            return request.getPromise();
        }
        this.sendPacket(request);
        return request.getPromise();
    }
    writeMultipleRegisters(address, values) {
        var request = new WriteMultipleRegistersRequest(this.createNewId(), address, values);
        if (!this.inState('online')) {
            request.reject({ errCode: 'offline' });
            return request.getPromise();
        }
        this.sendPacket(request);
        return request.getPromise();
    }
    connect() {
        if (this.inState('connecting') || this.inState('online'))
            return;
        this.setState('connecting');
        this.fire('busy', null);
        if (this.verbose)
            console.log('ModbusClient', 'Establishing connection.', this.socketId, this.host, this.port);
        window['chrome'].sockets.tcp.connect(this.socketId, this.host, this.port, function (result) {
            //38 error 0 successful Echec connection UPC 
            //-104 not connected WiFi non connecté
            //popup pour donner l'erreur à l'utilisateur 
            //Retentative de connexion
            if (this.verbose)
                console.log('ModbusClient', 'Connect returned', arguments);
            if (result !== 0) {
                if (this.verbose) {
                    console.log('ModbusClient', 'Connection failed.', result);
                    localStorage.removeItem("isConnected");
                }
                this.fire('error', [{
                        errCode: 'connectionError',
                        result: result
                    }]);
                //if (this.autoreconnect) {
                if (this.verbose)
                    console.log('ModbusClient', 'Auto Reconnect enabled, trying to reconnect.');
                this.reconnect(5000);
                //}
                return;
            }
            if (this.verbose)
                console.log('ModbusClient', 'Connection successfull.');
            this.setState('online');
        }.bind(this));
        return this;
    }
    setHost(h) {
        this.host = h;
        return this;
    }
    setPort(p) {
        this.port = p;
        return this;
    }
    getHost() {
        return this.host;
    }
    getPort() {
        return this.port;
    }
    disconnect(cb = null) {
        if (this.inState('disconnecting'))
            return;
        this.setState('disconnecting');
        this.fire('busy', null);
        if (this.verbose)
            console.log('ModbusClient', 'Disconnecting client.');
        window['chrome'].sockets.tcp.disconnect(this.socketId, function () {
            if (this.verbose)
                console.log('ModbusClient', 'Client disconnected.');
            this.setState('offline');
            if (!cb)
                return;
            cb();
        }.bind(this));
        return this;
    }
    close(cb = null) {
        this.disconnect(function () {
            if (this.verbose)
                console.log('ModbusClient', 'Close socket.');
            window['chrome'].sockets.tcp.close(this.socketId, function () {
                if (this.verbose)
                    console.log('ModbusClient', 'Client closed.');
                this.setState('init');
                this.socketId = null;
                if (!cb)
                    return;
            }.bind(this));
        }.bind(this));
    }
    reconnect(wait = null) {
        if (this.isReconnecting)
            return;
        this.isReconnecting = true;
        this.fire('reconnecting', null);
        setTimeout(function () {
            if (this.inState('offline')) {
                if (this.verbose)
                    console.log('ModbusClient', 'Client already disconnected.');
                this.connect();
                return;
            }
            window['chrome'].sockets.tcp.disconnect(this.socketId, function () {
                if (this.verbose)
                    console.log('ModbusClient', 'Client disconnected.', arguments);
                this.setState('offline');
                this.connect();
            }.bind(this));
        }.bind(this), wait ? wait : 0);
    }
    /**
     * Extras
     */
    /* Float */
    getFloatFromHoldingRegister(start) {
        return this.readHoldingRegisters(start, 2).then(function (data) {
            return this.registerToFloat(data);
        }.bind(this));
    }
    setFloatInHoldingRegister(start, value) {
        var data = this.floatToRegister(value);
        return this.writeMultipleRegisters(start, data);
    }
    registerToFloat(registers) {
        var highRegister = registers[1], lowRegister = registers[0], highRegisterBytes, lowRegisterBytes, floatBytes, buffer, view;
        // Get bytes from high register
        buffer = new ArrayBuffer(2);
        view = new DataView(buffer);
        view.setUint16(0, highRegister);
        highRegisterBytes = [view.getUint8(1), view.getUint8(0)];
        // Get bytes from low register
        buffer = new ArrayBuffer(2);
        view = new DataView(buffer);
        view.setUint16(0, lowRegister);
        lowRegisterBytes = [view.getUint8(1), view.getUint8(0)];
        // Get bytes from float
        floatBytes = [highRegisterBytes[1], highRegisterBytes[0], lowRegisterBytes[1], lowRegisterBytes[0]];
        buffer = new ArrayBuffer(4);
        view = new DataView(buffer);
        for (var i = 0; i < floatBytes.length; i++) {
            view.setUint8(i, floatBytes[i]);
        }
        return view.getFloat32(0);
    }
    floatToRegister(value) {
        var buffer = new ArrayBuffer(4), view = new DataView(buffer), highRegisterBytes, lowRegisterBytes, highRegister, lowRegister;
        // Get data from float
        view.setFloat32(0, value);
        highRegisterBytes = [view.getUint8(0), view.getUint8(1)];
        lowRegisterBytes = [view.getUint8(2), view.getUint8(3)];
        // Get data from high register
        buffer = new ArrayBuffer(2);
        view = new DataView(buffer);
        view.setUint8(0, highRegisterBytes[0]);
        view.setUint8(1, highRegisterBytes[1]);
        highRegister = view.getUint16(0);
        // Get data from low register
        buffer = new ArrayBuffer(2);
        view = new DataView(buffer);
        view.setUint8(0, lowRegisterBytes[0]);
        view.setUint8(1, lowRegisterBytes[1]);
        lowRegister = view.getUint16(0);
        return [lowRegister, highRegister];
    }
    /* Integer */
    getIntFromHoldingRegister(start, count) {
        switch (count) {
            case 2:
                return this.readHoldingRegisters(start, 2).then(function (data) {
                    return this.registerToUint32(data);
                }.bind(this));
            case 1:
                return this.readHoldingRegisters(start, 1).then(function (data) {
                    return data[0];
                }.bind(this));
        }
    }
    setIntInHoldingRegister(start, count, value) {
        switch (count) {
            case 2:
                var data = this.uint32ToRegister(value);
                return this.writeMultipleRegisters(start, data);
            case 1:
                return this.writeMultipleRegisters(start, [value]);
        }
    }
    registerToUint32(registers) {
        var highRegister = registers[1], lowRegister = registers[0], highRegisterBytes, lowRegisterBytes, intBytes, buffer, view;
        // Get bytes from high register
        buffer = new ArrayBuffer(2);
        view = new DataView(buffer);
        view.setUint16(0, highRegister);
        highRegisterBytes = [view.getUint8(1), view.getUint8(0)];
        // Get bytes from low register
        buffer = new ArrayBuffer(2);
        view = new DataView(buffer);
        view.setUint16(0, lowRegister);
        lowRegisterBytes = [view.getUint8(1), view.getUint8(0)];
        // Get bytes from int
        intBytes = [highRegisterBytes[1], highRegisterBytes[0], lowRegisterBytes[1], lowRegisterBytes[0]];
        buffer = new ArrayBuffer(4);
        view = new DataView(buffer);
        for (var i = 0; i < intBytes.length; i++) {
            view.setUint8(i, intBytes[i]);
        }
        return view.getInt32(0);
    }
    uint32ToRegister(value) {
        var buffer = new ArrayBuffer(4), view = new DataView(buffer), highRegisterBytes, lowRegisterBytes, highRegister, lowRegister;
        // Get data from int
        view.setInt32(0, value);
        highRegisterBytes = [view.getUint8(0), view.getUint8(1)];
        lowRegisterBytes = [view.getUint8(2), view.getUint8(3)];
        // Get data from high register
        buffer = new ArrayBuffer(2);
        view = new DataView(buffer);
        view.setUint8(0, highRegisterBytes[0]);
        view.setUint8(1, highRegisterBytes[1]);
        highRegister = view.getUint16(0);
        // Get data from low register
        buffer = new ArrayBuffer(2);
        view = new DataView(buffer);
        view.setUint8(0, lowRegisterBytes[0]);
        view.setUint8(1, lowRegisterBytes[1]);
        lowRegister = view.getUint16(0);
        return [lowRegister, highRegister];
    }
    /* String */
    getStringFromHoldingRegister(start, count) {
        return this.readHoldingRegisters(start, count).then(function (data) {
            var string = this.registerToString(data);
            if (string.indexOf('\u0004') != -1)
                string = string.substr(0, string.indexOf('\u0004'));
            if (string.indexOf('\0') != -1)
                string = string.substr(0, string.indexOf('\0'));
            return string;
        }.bind(this));
    }
    setStringInHoldingRegister(start, value) {
        return this.writeMultipleRegisters(start, this.stringToRegister(value));
    }
    registerToString(registers) {
        var hexValue = '';
        for (var i = 0; i < registers.length; i++) {
            if (i > 0 && registers[i - 1] == 101)
                break;
            if (registers[i].toString(16).length == 4)
                hexValue += registers[i].toString(16).substr(2, 2) + registers[i].toString(16).substr(0, 2);
            else
                hexValue += registers[i].toString(16);
        }
        var s = this.hex2a(hexValue);
        return s;
    }
    stringToRegister(string) {
        var array = string.split('').map((s) => { return s.charCodeAt(0); });
        var returnarray = [];
        for (var i = 0; i < string.length / 2 + string.length % 2; i++)
            returnarray.push(0);
        for (var i = 0; i < returnarray.length; i++) {
            returnarray[i] = array[i * 2];
            if (i * 2 + 1 < array.length) {
                returnarray[i] = (returnarray[i] | (array[i * 2 + 1] << 8));
            }
        }
        return returnarray;
    }
    /* Date */
    getDateFromHoldingRegister(start) {
        return this.readHoldingRegisters(start, 2).then(function (data) {
            var startDate = new Date(1970, 0, 1, 0, 0, 0), highRegister = data[1], lowRegister = data[0], highRegisterBytes = this.toByteArray(highRegister), lowRegisterBytes = this.toByteArray(lowRegister), intBytes = [highRegisterBytes[1], highRegisterBytes[0], lowRegisterBytes[1], lowRegisterBytes[0]], buf = new ArrayBuffer(4), view = new DataView(buf);
            for (var i = 0; i < intBytes.length; i++) {
                view.setUint8(i, intBytes[i]);
            }
            return new Date(startDate.getTime() + (view.getInt32(0) * 1000));
        });
    }
    /* Diffusion program */
    getDiffusionProgramFromHoldingRegister(start) {
        return this.readHoldingRegisters(start, 6).then(function (data) {
            return new UPCDiffCo2Program(this.registerToUint32([data[0], data[1]]), // Start
            this.registerToUint32([data[2], data[3]]), // Stop
            data[4], // Mode
            data[5] // Intensity
            );
        }.bind(this));
    }
    setDiffusionProgramInHoldingRegister(start, value) {
        var startTimeData = this.uint32ToRegister(value.start), endTimeData = this.uint32ToRegister(value.stop), data = [
            startTimeData[0], startTimeData[1],
            endTimeData[0], endTimeData[1],
            value.mode,
            value.intensity
        ];
        return this.writeMultipleRegisters(start, data);
    }
    getDiffusionSunFromHoldingRegister(start) {
        return this.readHoldingRegisters(start, 6).then(function (data) {
            return new UPCDiffCo2Sun(this.registerToUint32([data[0], data[1]]), // Offset
            this.registerToUint32([data[2], data[3]]), // Duration
            data[5], // Intensity
            data[4] // Mode
            );
        }.bind(this));
    }
    setDiffusionSunInHoldingRegister(start, value) {
        var startTimeData = this.uint32ToRegister(value.offset), endTimeData = this.uint32ToRegister(value.duration), data = [
            startTimeData[0], startTimeData[1],
            endTimeData[0], endTimeData[1],
            value.mode,
            value.intensity
        ];
        return this.writeMultipleRegisters(start, data);
    }
    hex2a(hexx) {
        var hex = hexx.toString();
        var str = '';
        for (var i = 0; i < hex.length; i += 2)
            str += String.fromCharCode(parseInt(hex.substr(i, 2), 16));
        return str;
    }
}
ModbusClient.ctorParameters = () => [
    { type: Number },
    { type: Boolean },
    { type: Boolean }
];
class UPCDiffCo2Program {
    constructor(start = 0, stop = 0, mode = 0, intensity = 0) {
        this.start = 0;
        this.stop = 0;
        this.mode = 0;
        this.intensity = 0;
        this.start = start;
        this.stop = stop;
        this.mode = mode;
        this.intensity = intensity;
    }
    getDailyConsumption(beltRefConsumption) {
        return Math.round((beltRefConsumption * ((this.stop - this.start) / 3600) * this.intensity / 10) * 100) / 100;
    }
    getMonthlyConsumption(beltRefConsumption) {
        if (this.mode >= 0 && this.mode <= 6)
            return this.getDailyConsumption(beltRefConsumption) * 4;
        else if (this.mode == 7)
            return this.getDailyConsumption(beltRefConsumption) * 7 * 4;
        else if (this.mode == 8)
            return this.getDailyConsumption(beltRefConsumption) * 2 * 4;
        else if (this.mode == 8)
            return this.getDailyConsumption(beltRefConsumption) * 5 * 4;
    }
}
UPCDiffCo2Program.ctorParameters = () => [
    { type: Number },
    { type: Number },
    { type: Number },
    { type: Number }
];
class UPCDiffCo2Sun {
    constructor(offset = 0, duration = 0, intensity = 0, mode = 0) {
        this.offset = 0;
        this.duration = 0;
        this.intensity = 0;
        this.mode = 0;
        this.offset = offset;
        this.duration = duration;
        this.intensity = intensity;
        this.mode = mode;
    }
    getDailyConsumption(beltRefConsumption) {
        return Math.round((beltRefConsumption * (this.duration / 3600) * this.intensity / 10) * 100) / 100;
    }
    getMonthlyConsumption(beltRefConsumption) {
        return this.getDailyConsumption(beltRefConsumption) * 7 * 4;
    }
}
UPCDiffCo2Sun.ctorParameters = () => [
    { type: Number },
    { type: Number },
    { type: Number },
    { type: Number }
];


/***/ }),

/***/ "./src/app/model/upcv3/reservesParameters.ts":
/*!***************************************************!*\
  !*** ./src/app/model/upcv3/reservesParameters.ts ***!
  \***************************************************/
/*! exports provided: ReservesParameters */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ReservesParameters", function() { return ReservesParameters; });
/* harmony import */ var _LocalDateTime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./LocalDateTime */ "./src/app/model/upcv3/LocalDateTime.ts");

class ReservesParameters {
    constructor() {
        this.co2ResActive = 0;
        this.co2ResActAdj = 0;
        this.co2ResActPrev = new _LocalDateTime__WEBPACK_IMPORTED_MODULE_0__["LocalDateTime"]();
        this.co2ResInactPrev = new _LocalDateTime__WEBPACK_IMPORTED_MODULE_0__["LocalDateTime"]();
        this.co2ResType = 0;
        this.co2Res1Status = 0;
        this.co2Res1FillVol = 0;
        this.co2Res1FillTime = new _LocalDateTime__WEBPACK_IMPORTED_MODULE_0__["LocalDateTime"]();
        this.co2Res1ActVol = 0;
        this.co2Res1ActDur = 0;
        this.co2Res1StartVol = 0;
        this.co2Res1AuxVol = 0;
        this.co2Res2Status = 0;
        this.co2Res2FillVol = 0;
        this.co2Res2FillTime = new _LocalDateTime__WEBPACK_IMPORTED_MODULE_0__["LocalDateTime"]();
        this.co2Res2ActVol = 0;
        this.co2Res2ActDur = 0;
        this.co2Res2StartVol = 0;
        this.co2Res2AuxVol = 0;
        this.co2Res1Bottle = 0;
        this.co2Res2Bottle = 0;
        this.co2Res1FillNew = 0;
        this.co2Res2FillNew = 0;
        this.bottlesB1 = [];
        this.bottlesB2 = [];
        this.co2ResLow = 0;
    }
    static loadFromJSON(json) {
        var reservesParameters = Object.assign(new ReservesParameters, json);
        if (json.co2ResActPrev)
            reservesParameters.co2ResActPrev = _LocalDateTime__WEBPACK_IMPORTED_MODULE_0__["LocalDateTime"].loadFromJSON(json.co2ResActPrev);
        if (json.co2ResInactPrev)
            reservesParameters.co2ResInactPrev = _LocalDateTime__WEBPACK_IMPORTED_MODULE_0__["LocalDateTime"].loadFromJSON(json.co2ResInactPrev);
        if (json.co2Res1FillTime)
            reservesParameters.co2Res1FillTime = _LocalDateTime__WEBPACK_IMPORTED_MODULE_0__["LocalDateTime"].loadFromJSON(json.co2Res1FillTime);
        if (json.co2Res2FillTime)
            reservesParameters.co2Res2FillTime = _LocalDateTime__WEBPACK_IMPORTED_MODULE_0__["LocalDateTime"].loadFromJSON(json.co2Res2FillTime);
        return reservesParameters;
    }
}


/***/ }),

/***/ "./src/app/model/upcv3/upcmodbus.ts":
/*!******************************************!*\
  !*** ./src/app/model/upcv3/upcmodbus.ts ***!
  \******************************************/
/*! exports provided: UPCModbus, UPCState */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "UPCModbus", function() { return UPCModbus; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "UPCState", function() { return UPCState; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _modbus__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./modbus */ "./src/app/model/upcv3/modbus.ts");
/* harmony import */ var _generalParameters__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./generalParameters */ "./src/app/model/upcv3/generalParameters.ts");
/* harmony import */ var _diffusionParameters__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./diffusionParameters */ "./src/app/model/upcv3/diffusionParameters.ts");
/* harmony import */ var _communicationParameters__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./communicationParameters */ "./src/app/model/upcv3/communicationParameters.ts");
/* harmony import */ var _alarmsParameters__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./alarmsParameters */ "./src/app/model/upcv3/alarmsParameters.ts");
/* harmony import */ var _reservesParameters__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./reservesParameters */ "./src/app/model/upcv3/reservesParameters.ts");
/* harmony import */ var _correspondancesRegistres__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./correspondancesRegistres */ "./src/app/model/upcv3/correspondancesRegistres.ts");








class UPCModbus {
    /**
     * Constructor
     */
    constructor(stateChangeCallback) {
        // Attributes
        this.host = '10.1.1.1';
        this.port = 502;
        this.stateChangeCallback = null;
        this.state = UPCState.NULL;
        this.client = null;
        this.nameId = '';
        this.mode = 0;
        this.status = 0;
        this.trapNum = 0;
        this.general = new _generalParameters__WEBPACK_IMPORTED_MODULE_2__["GeneralParameters"]();
        this.diffusions = new _diffusionParameters__WEBPACK_IMPORTED_MODULE_3__["DiffusionParameters"]();
        this.alarm = new _alarmsParameters__WEBPACK_IMPORTED_MODULE_5__["AlarmsParameters"]();
        this.reserves = new _reservesParameters__WEBPACK_IMPORTED_MODULE_6__["ReservesParameters"]();
        this.co2FlowRefTrap = 0;
        this.co2Res1ActVol = 0;
        this.co2Res2ActVol = 0;
        this.diffHourSunrise = 0;
        this.diffHourSunset = 0;
        this.diffCo2Program = [
            new _modbus__WEBPACK_IMPORTED_MODULE_1__["UPCDiffCo2Program"](),
            new _modbus__WEBPACK_IMPORTED_MODULE_1__["UPCDiffCo2Program"](),
            new _modbus__WEBPACK_IMPORTED_MODULE_1__["UPCDiffCo2Program"](),
            new _modbus__WEBPACK_IMPORTED_MODULE_1__["UPCDiffCo2Program"](),
            new _modbus__WEBPACK_IMPORTED_MODULE_1__["UPCDiffCo2Program"](),
            new _modbus__WEBPACK_IMPORTED_MODULE_1__["UPCDiffCo2Program"](),
            new _modbus__WEBPACK_IMPORTED_MODULE_1__["UPCDiffCo2Program"](),
            new _modbus__WEBPACK_IMPORTED_MODULE_1__["UPCDiffCo2Program"](),
            new _modbus__WEBPACK_IMPORTED_MODULE_1__["UPCDiffCo2Program"](),
            new _modbus__WEBPACK_IMPORTED_MODULE_1__["UPCDiffCo2Program"]()
        ];
        this.communicationParameters = new _communicationParameters__WEBPACK_IMPORTED_MODULE_4__["CommunicationParameters"]();
        this.diffCo2Sunrise = new _modbus__WEBPACK_IMPORTED_MODULE_1__["UPCDiffCo2Sun"]();
        this.diffCo2Sunset = new _modbus__WEBPACK_IMPORTED_MODULE_1__["UPCDiffCo2Sun"]();
        this.stateChangeCallback = stateChangeCallback;
        this.init();
    }
    int2ip(ipInt) {
        return ((ipInt >>> 24) + '.' + (ipInt >> 16 & 255) + '.' + (ipInt >> 8 & 255) + '.' + (ipInt & 255));
    }
    toZero4(d) {
        return ("0000" + (+d).toString(16)).substr(-4);
    }
    onReadCyclique(upcNameId, mode, page) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            var success;
            var error;
            var correspondanceRegistres = new _correspondancesRegistres__WEBPACK_IMPORTED_MODULE_7__["CorrespondancesRegistres"]();
            switch (page) {
                case "namepiege":
                    success = true;
                    break;
                case "cdiff":
                    try {
                        //40435 40464
                        var res = yield this.client.readHoldingRegisters(correspondanceRegistres.co2PressInpAvg.adr, 29);
                        //40435 
                        this.diffusions.co2PresInpAvg = this.client.registerToFloat([res[0], res[1]]);
                        //40437
                        this.diffusions.co2PresOutAvg = this.client.registerToFloat([res[2], res[3]]);
                        //40451  
                        this.diffusions.co2TempAvg = this.client.registerToFloat([res[16], res[17]]);
                        //40463 
                        this.diffusions.co2PressOutComp = this.client.registerToFloat([res[28], res[29]]);
                        success = true;
                        break;
                    }
                    catch (err) {
                        success = false;
                        error = err;
                        break;
                    }
                case "comunicationparam":
                    success = true;
                    break;
                case "addbottleceint":
                    success = true;
                    break;
            }
            if (success == true) {
                return true;
            }
            else {
                return error;
            }
        });
    }
    onReadStatique(upcNameId, mode, page) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            var success;
            var error;
            var correspondancesRegistres = new _correspondancesRegistres__WEBPACK_IMPORTED_MODULE_7__["CorrespondancesRegistres"]();
            const opt = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric', hour: 'numeric',
                minute: 'numeric',
                dayPeriod: 'short' };
            switch (page) {
                case "namepiege":
                    try {
                        //40001 40015
                        var res1 = yield this.client.readHoldingRegisters(correspondancesRegistres.upcNameId.adr, 15);
                        //40001 40010                
                        var tabname = [];
                        for (var i = 0; i < 10; i++) {
                            tabname.push(res1[i]);
                        }
                        var nameId = this.client.registerToString(tabname).replace(/[^a-zA-Z0-9]/g, '');
                        if (mode != "modeTest") { //on n'est pas en mode test   
                            if (nameId != upcNameId) { //changement d'UPC
                                if (window.confirm("Une intervention est en cours sur l'upc " + upcNameId + ". Voulez-vous néanmoins continuer sur l'upc " + nameId + "?")) {
                                    if (window.confirm("Voulez-vous terminer l'intervention ? (OK) ou l'abandonner ? (Annuler)")) {
                                        return { success: true, object: "Terminer l'intervention en cours" };
                                    }
                                    else {
                                        return { success: true, object: "Abandonner l'intervention en cours" };
                                    }
                                }
                                else {
                                    alert("Rapprochez-vous de l'upc " + upcNameId + " puis appuyez sur 'OK'.");
                                    return { success: true, object: "Se rapprocher de l'upc" };
                                }
                            }
                            else {
                                this.nameId = nameId;
                                //40012 40013                  
                                this.general.upcClock = new Date(this.client.registerToUint32([res1[11], res1[12]]) * 1000).toLocaleDateString("fr-FR", opt);
                                //40015
                                this.general.upcTrapNum = res1[14];
                                //40168
                                var res2 = yield this.client.readHoldingRegisters(correspondancesRegistres.upcFwVer.adr, 1);
                                //40168
                                this.general.upcFwVer = this.client.registerToUint32([res2[0]]);
                                //40401 40449 
                                var res3 = yield this.client.readHoldingRegisters(correspondancesRegistres.upcTimeZone.adr, 48);
                                //40401 40402
                                this.general.upcTimeZone = this.client.registerToUint32([res3[0], res3[1]]);
                                //40441 40449 48 56
                                var tabuuid = "";
                                for (var i = 48; i < 56; i++) {
                                    tabuuid += this.toZero4(res3[i]);
                                }
                                this.general.upcMcuUid = tabuuid;
                                success = true;
                                break;
                            }
                        }
                        else {
                            this.nameId = nameId;
                            //40012 40013                  
                            this.general.upcClock = new Date(this.client.registerToUint32([res1[11], res1[12]]) * 1000).toLocaleDateString("fr-FR", opt);
                            //40015
                            this.general.upcTrapNum = res1[14];
                            //40168
                            var res2 = yield this.client.readHoldingRegisters(correspondancesRegistres.upcFwVer.adr, 1);
                            //40168
                            this.general.upcFwVer = this.client.registerToUint32([res2[0]]);
                            //40401 40449 
                            var res3 = yield this.client.readHoldingRegisters(correspondancesRegistres.upcTimeZone.adr, 48);
                            //40401 40402
                            this.general.upcTimeZone = this.client.registerToUint32([res3[0], res3[1]]);
                            //40441 40449  48 56
                            var tabuuid = "";
                            for (var i = 48; i < 56; i++) {
                                tabuuid += this.toZero4(res3[i]);
                            }
                            this.general.upcMcuUid = tabuuid;
                            success = true;
                            break;
                        }
                    }
                    catch (err) {
                        success = false;
                        error = err;
                        break;
                    }
                case "cdiff":
                    try {
                        //40001 40065
                        var res1 = yield this.client.readHoldingRegisters(correspondancesRegistres.upcNameId.adr, 65);
                        //40001 40010                
                        var tabname = [];
                        for (var i = 0; i < 10; i++) {
                            tabname.push(res1[i]);
                        }
                        var nameId = this.client.registerToString(tabname).replace(/[^a-zA-Z0-9]/g, '');
                        if (mode != "modeTest") { //on n'est pas en mode test   
                            if (nameId != upcNameId) { //changement d'UPC
                                if (window.confirm("Une intervention est en cours sur l'upc " + upcNameId + ". Voulez-vous néanmoins continuer sur l'upc " + nameId + "?")) {
                                    if (window.confirm("Voulez-vous terminer l'intervention ? (OK) ou l'abandonner ? (Annuler)")) {
                                        return { success: true, object: "Terminer l'intervention en cours" };
                                    }
                                    else {
                                        return { success: true, object: "Abandonner l'intervention en cours" };
                                    }
                                }
                                else {
                                    alert("Rapprochez-vous de l'upc " + upcNameId + " puis appuyez sur 'OK'.");
                                    return { success: true, object: "Se rapprocher de l'upc" };
                                }
                            }
                            else {
                                this.general.co2FlowRefAdj = this.client.registerToFloat([res1[17], res1[18]]);
                                this.diffusions.upcDiffLvlAdj = res1[64];
                                //40150
                                var res2 = yield this.client.readHoldingRegisters(correspondancesRegistres.co2ResActAdj.adr, 1);
                                this.reserves.co2ResActAdj = res2[0];
                                //40376 40464
                                var res3 = yield this.client.readHoldingRegisters(correspondancesRegistres.upcStatus.adr, 89);
                                //40376
                                this.general.upcStatus = res3[0];
                                //40435 
                                this.diffusions.co2PresInpAvg = this.client.registerToFloat([res3[58], res3[59]]);
                                //40437
                                this.diffusions.co2PresOutAvg = this.client.registerToFloat([res3[60], res3[61]]);
                                //40439 40440               
                                this.diffusions.co2FlowAvg = this.client.registerToFloat([res3[62], res3[63]]);
                                //40451  
                                this.diffusions.co2TempAvg = this.client.registerToFloat([res3[75], res3[76]]);
                                //40455 40456
                                this.diffusions.co2PressInpOffs = this.client.registerToFloat([res3[79], res3[80]]);
                                //40457 40458
                                this.diffusions.co2PressOutOffs = this.client.registerToFloat([res3[81], res3[82]]);
                                //40459 40460
                                this.diffusions.co2FlowOffs = this.client.registerToFloat([res3[83], res3[84]]);
                                //40463 
                                this.diffusions.co2PressOutComp = this.client.registerToFloat([res3[87], res3[88]]);
                                success = true;
                                break;
                            }
                        }
                        else { //on est en mode test
                            this.general.co2FlowRefAdj = this.client.registerToFloat([res1[17], res1[18]]);
                            this.diffusions.upcDiffLvlAdj = res1[64];
                            //40150
                            var res2 = yield this.client.readHoldingRegisters(correspondancesRegistres.co2ResActAdj.adr, 1);
                            this.reserves.co2ResActAdj = res2[0];
                            //40376 40464
                            var res3 = yield this.client.readHoldingRegisters(correspondancesRegistres.upcStatus.adr, 89);
                            //40376
                            this.general.upcStatus = res3[0];
                            //40435 
                            this.diffusions.co2PresInpAvg = this.client.registerToFloat([res3[58], res3[59]]);
                            //40437
                            this.diffusions.co2PresOutAvg = this.client.registerToFloat([res3[60], res3[61]]);
                            //40439 40440               
                            this.diffusions.co2FlowAvg = this.client.registerToFloat([res3[63], res3[64]]);
                            //40451  
                            this.diffusions.co2TempAvg = this.client.registerToFloat([res3[75], res3[76]]);
                            //40455 40456
                            this.diffusions.co2PressInpOffs = this.client.registerToFloat([res3[79], res3[80]]);
                            //40457 40458
                            this.diffusions.co2PressOutOffs = this.client.registerToFloat([res3[81], res3[82]]);
                            //40459 40460
                            this.diffusions.co2FlowOffs = this.client.registerToFloat([res3[83], res3[84]]);
                            //40463 
                            this.diffusions.co2PressOutComp = this.client.registerToFloat([res3[87], res3[88]]);
                            success = true;
                            break;
                        }
                    }
                    catch (err) {
                        success = false;
                        error = err;
                        break;
                    }
                case "comunicationparam":
                    try {
                        //40001 40064
                        var res1 = yield this.client.readHoldingRegisters(correspondancesRegistres.upcNameId.adr, 64);
                        //40001 40010                
                        var tabname = [];
                        for (var i = 0; i < 10; i++) {
                            tabname.push(res1[i]);
                        }
                        var nameId = this.client.registerToString(tabname).replace(/[^a-zA-Z0-9]/g, '');
                        if (mode != "modeTest") { //on n'est pas en mode test   
                            if (nameId != upcNameId) { //changement d'UPC
                                if (window.confirm("Une intervention est en cours sur l'upc " + upcNameId + ". Voulez-vous néanmoins continuer sur l'upc " + nameId + "?")) {
                                    if (window.confirm("Voulez-vous terminer l'intervention ? (OK) ou l'abandonner ? (Annuler)")) {
                                        return { success: true, object: "Terminer l'intervention en cours" };
                                    }
                                    else {
                                        return { success: true, object: "Abandonner l'intervention en cours" };
                                    }
                                }
                                else {
                                    alert("Rapprochez-vous de l'upc " + upcNameId + " puis appuyez sur 'OK'.");
                                    return { success: true, object: "Se rapprocher de l'upc" };
                                }
                            }
                            else {
                                //40022 40023
                                this.communicationParameters.comGsmIpAdr = this.int2ip(this.client.registerToUint32([res1[21], res1[22]]));
                                //40024 40033
                                var tabMdmName = [];
                                for (var i = 23; i < 33; i++) {
                                    tabMdmName.push(res1[i]);
                                }
                                this.communicationParameters.comMdmName = this.client.registerToString(tabMdmName);
                                //40034 40043
                                var tabMdmPass = [];
                                for (var i = 33; i < 43; i++) {
                                    tabMdmPass.push(res1[i]);
                                }
                                this.communicationParameters.comGsmPass = this.client.registerToString(tabMdmPass);
                                //40045 40053
                                var tabssid = [];
                                for (var i = 44; i < 54; i++) {
                                    tabssid.push(res1[i]);
                                }
                                this.communicationParameters.comGsmName = this.client.registerToString(tabssid);
                                //40055 40064
                                var tabpassword = [];
                                for (var i = 54; i < 64; i++) {
                                    tabpassword.push(res1[i]);
                                }
                                this.communicationParameters.comWiFiPass = this.client.registerToString(tabpassword).replace(/[^a-zA-Z0-9-.-]/g, '');
                                var res2 = yield this.client.readHoldingRegisters(correspondancesRegistres.comWebSrvUrl.adr, 46);
                                //40295 40310
                                var taburl = [];
                                for (var i = 0; i < 14; i++) {
                                    taburl.push(res2[i]);
                                }
                                this.communicationParameters.comWebSrvUrl = this.client.registerToString(taburl).replace(/[^a-zA-Z0-9-.-]/g, '');
                                //40320 40329
                                var tabapnuser = [];
                                for (var i = 24; i < 34; i++) {
                                    tabapnuser.push(res2[i]);
                                }
                                this.communicationParameters.comMdmApnUser = this.client.registerToString(tabapnuser).replace(/[^a-zA-Z0-9]/g, '');
                                //40330 40339
                                var tabapnpass = [];
                                for (var i = 34; i < 44; i++) {
                                    tabapnpass.push(res2[i]);
                                }
                                this.communicationParameters.comMdmApnPass = this.client.registerToString(tabapnpass).replace(/[^a-zA-Z0-9]/g, '');
                                //40340 
                                this.communicationParameters.comWifiApCh = this.client.registerToUint32([res2[45]]);
                                var res3 = yield this.client.readHoldingRegisters(correspondancesRegistres.comMdmApnId2.adr, 51);
                                //40467 40517 0 50 
                                var tabapn2 = [];
                                for (var i = 0; i < 50; i++) {
                                    tabapn2.push(res3[i]);
                                }
                                this.communicationParameters.comMdmApnId2 = this.client.registerToString(tabapn2).replace(/[^a-zA-Z0-9-.-]/g, '');
                                success = true;
                                break;
                            }
                        }
                        else { //on est en mode test
                            //40022 40023
                            this.communicationParameters.comGsmIpAdr = this.int2ip(this.client.registerToUint32([res1[21], res1[22]]));
                            //40024 40033
                            var tabMdmName = [];
                            for (var i = 23; i < 33; i++) {
                                tabMdmName.push(res1[i]);
                            }
                            this.communicationParameters.comMdmName = this.client.registerToString(tabMdmName);
                            //40034 40043
                            var tabMdmPass = [];
                            for (var i = 33; i < 43; i++) {
                                tabMdmPass.push(res1[i]);
                            }
                            this.communicationParameters.comGsmPass = this.client.registerToString(tabMdmPass);
                            //40045 40053
                            var tabssid = [];
                            for (var i = 44; i < 54; i++) {
                                tabssid.push(res1[i]);
                            }
                            this.communicationParameters.comGsmName = this.client.registerToString(tabssid);
                            //40055 40064
                            var tabpassword = [];
                            for (var i = 54; i < 64; i++) {
                                tabpassword.push(res1[i]);
                            }
                            this.communicationParameters.comWiFiPass = this.client.registerToString(tabpassword).replace(/[^a-zA-Z0-9-.-]/g, '');
                            var res2 = yield this.client.readHoldingRegisters(correspondancesRegistres.comWebSrvUrl.adr, 46);
                            //40295 40310
                            var taburl = [];
                            for (var i = 0; i < 14; i++) {
                                taburl.push(res2[i]);
                            }
                            this.communicationParameters.comWebSrvUrl = this.client.registerToString(taburl).replace(/[^a-zA-Z0-9-.-]/g, '');
                            //40320 40329
                            var tabapnuser = [];
                            for (var i = 24; i < 34; i++) {
                                tabapnuser.push(res2[i]);
                            }
                            this.communicationParameters.comMdmApnUser = this.client.registerToString(tabapnuser).replace(/[^a-zA-Z0-9]/g, '');
                            //40330 40339
                            var tabapnpass = [];
                            for (var i = 34; i < 44; i++) {
                                tabapnpass.push(res2[i]);
                            }
                            this.communicationParameters.comMdmApnPass = this.client.registerToString(tabapnpass).replace(/[^a-zA-Z0-9]/g, '');
                            //40340 
                            this.communicationParameters.comWifiApCh = this.client.registerToUint32([res2[45]]);
                            var res3 = yield this.client.readHoldingRegisters(correspondancesRegistres.comMdmApnId2.adr, 51);
                            //40467 40517 0 50 
                            var tabapn2 = [];
                            for (var i = 0; i < 50; i++) {
                                tabapn2.push(res3[i]);
                            }
                            this.communicationParameters.comMdmApnId2 = this.client.registerToString(tabapn2).replace(/[^a-zA-Z0-9-.-]/g, '');
                            success = true;
                            break;
                        }
                    }
                    catch (err) {
                        success = false;
                        error = err;
                        break;
                    }
                case "addbottleceint":
                    try {
                        var res1 = yield this.client.readHoldingRegisters(correspondancesRegistres.upcNameId.adr, 10);
                        //40001 40010                
                        var tabname = [];
                        for (var i = 0; i < 10; i++) {
                            tabname.push(res1[i]);
                        }
                        var nameId = this.client.registerToString(tabname).replace(/[^a-zA-Z0-9]/g, '');
                        if (mode != "modeTest") { //on n'est pas en mode test   
                            if (nameId != upcNameId) { //changement d'UPC
                                if (window.confirm("Une intervention est en cours sur l'upc " + upcNameId + ". Voulez-vous néanmoins continuer sur l'upc " + nameId + "?")) {
                                    if (window.confirm("Voulez-vous terminer l'intervention ? (OK) ou l'abandonner ? (Annuler)")) {
                                        return { success: true, object: "Terminer l'intervention en cours" };
                                    }
                                    else {
                                        return { success: true, object: "Abandonner l'intervention en cours" };
                                    }
                                }
                                else {
                                    alert("Rapprochez-vous de l'upc " + upcNameId + " puis appuyez sur 'OK'.");
                                    return { success: true, object: "Se rapprocher de l'upc" };
                                }
                            }
                            else {
                                this.reserves.bottlesB1 = [];
                                this.reserves.bottlesB2 = [];
                                var res2 = yield this.client.readHoldingRegisters(correspondancesRegistres.co2ResActive.adr, 16);
                                //40151
                                this.reserves.co2ResActive = this.client.registerToUint32([res2[0]]);
                                //40157 40158
                                this.reserves.co2Res1ActVol = Math.round((this.client.registerToFloat([res2[6], res2[7]]) * 0.001974) * 100) / 100;
                                //40165 40166
                                this.reserves.co2Res2ActVol = Math.round((this.client.registerToFloat([res2[14], res2[15]]) * 0.001974) * 100) / 100;
                                //40376 40450
                                var res3 = yield this.client.readHoldingRegisters(correspondancesRegistres.upcStatus.adr, 75);
                                //40376
                                this.general.upcStatus = res3[0];
                                //40381
                                this.reserves.co2Res1Status = this.client.registerToUint32([res3[5]]);
                                //40383
                                this.reserves.co2Res2Status = this.client.registerToUint32([res3[6]]);
                                //40421 40422 
                                this.reserves.co2Res1StartVol = Math.round((this.client.registerToFloat([res3[45], res3[46]]) * 0.001974) * 100) / 100;
                                //40449 40450  Math.round((this.client.registerToFloat([res[87],res[88]])* 0.001974) * 100) / 100
                                this.reserves.co2Res2StartVol = Math.round((this.client.registerToFloat([res3[73], res3[74]]) * 0.001974) * 100) / 100;
                                var res4 = yield this.client.readHoldingRegisters(correspondancesRegistres.xCo2Res1CodesBarres.adr, 90);
                                //41124 41128
                                var tabB11 = [];
                                for (var i = 0; i < 5; i++) {
                                    tabB11.push(res4[i]);
                                }
                                this.reserves.bottlesB1.push(this.client.registerToString(tabB11));
                                //41129 41133
                                var tabB12 = [];
                                for (var i = 5; i < 10; i++) {
                                    tabB12.push(res4[i]);
                                }
                                this.reserves.bottlesB1.push(this.client.registerToString(tabB12));
                                //41134 41138
                                var tabB13 = [];
                                for (var i = 10; i < 15; i++) {
                                    tabB13.push(res4[i]);
                                }
                                this.reserves.bottlesB1.push(this.client.registerToString(tabB13));
                                //41139 41143
                                var tabB14 = [];
                                for (var i = 15; i < 20; i++) {
                                    tabB14.push(res4[i]);
                                }
                                this.reserves.bottlesB1.push(this.client.registerToString(tabB14));
                                //41144 41148
                                var tabB15 = [];
                                for (var i = 20; i < 25; i++) {
                                    tabB15.push(res4[i]);
                                }
                                this.reserves.bottlesB1.push(this.client.registerToString(tabB15));
                                //41149 41153
                                var tabB16 = [];
                                for (var i = 25; i < 30; i++) {
                                    tabB16.push(res4[i]);
                                }
                                this.reserves.bottlesB1.push(this.client.registerToString(tabB16));
                                //41154 41158
                                var tabB17 = [];
                                for (var i = 30; i < 35; i++) {
                                    tabB17.push(res4[i]);
                                }
                                this.reserves.bottlesB1.push(this.client.registerToString(tabB17));
                                //41159 41163
                                var tabB18 = [];
                                for (var i = 35; i < 40; i++) {
                                    tabB18.push(res4[i]);
                                }
                                this.reserves.bottlesB1.push(this.client.registerToString(tabB18));
                                //41164 41168
                                var tabB19 = [];
                                for (var i = 40; i < 45; i++) {
                                    tabB19.push(res4[i]);
                                }
                                this.reserves.bottlesB1.push(this.client.registerToString(tabB19));
                                //41169 41173
                                var tabB21 = [];
                                for (var i = 45; i < 50; i++) {
                                    tabB21.push(res4[i]);
                                }
                                this.reserves.bottlesB2.push(this.client.registerToString(tabB21));
                                //41174 41178
                                var tabB22 = [];
                                for (var i = 50; i < 55; i++) {
                                    tabB22.push(res4[i]);
                                }
                                this.reserves.bottlesB2.push(this.client.registerToString(tabB22));
                                //41179 41183
                                var tabB23 = [];
                                for (var i = 55; i < 60; i++) {
                                    tabB23.push(res4[i]);
                                }
                                this.reserves.bottlesB2.push(this.client.registerToString(tabB23));
                                //41184 41188
                                var tabB24 = [];
                                for (var i = 60; i < 65; i++) {
                                    tabB24.push(res4[i]);
                                }
                                this.reserves.bottlesB2.push(this.client.registerToString(tabB24));
                                //41189 41193
                                var tabB25 = [];
                                for (var i = 65; i < 70; i++) {
                                    tabB25.push(res4[i]);
                                }
                                this.reserves.bottlesB2.push(this.client.registerToString(tabB25));
                                //41194 41198
                                var tabB26 = [];
                                for (var i = 70; i < 75; i++) {
                                    tabB26.push(res4[i]);
                                }
                                this.reserves.bottlesB2.push(this.client.registerToString(tabB26));
                                //41199 41203
                                var tabB27 = [];
                                for (var i = 75; i < 80; i++) {
                                    tabB27.push(res4[i]);
                                }
                                this.reserves.bottlesB2.push(this.client.registerToString(tabB27));
                                //41204 41208
                                var tabB28 = [];
                                for (var i = 80; i < 85; i++) {
                                    tabB28.push(res4[i]);
                                }
                                this.reserves.bottlesB2.push(this.client.registerToString(tabB28));
                                //41209 41213
                                var tabB29 = [];
                                for (var i = 85; i < 90; i++) {
                                    tabB29.push(res4[i]);
                                }
                                this.reserves.bottlesB2.push(this.client.registerToString(tabB29));
                                success = true;
                                break;
                            }
                        }
                        else { //on est en mode test
                            this.reserves.bottlesB1 = [];
                            this.reserves.bottlesB2 = [];
                            var res2 = yield this.client.readHoldingRegisters(correspondancesRegistres.co2ResActive.adr, 16);
                            //40151
                            this.reserves.co2ResActive = this.client.registerToUint32([res2[0]]);
                            //40157 40158
                            this.reserves.co2Res1ActVol = Math.round((this.client.registerToFloat([res2[6], res2[7]]) * 0.001974) * 100) / 100;
                            //40165 40166
                            this.reserves.co2Res2ActVol = Math.round((this.client.registerToFloat([res2[14], res2[15]]) * 0.001974) * 100) / 100;
                            //40376 40450
                            var res3 = yield this.client.readHoldingRegisters(correspondancesRegistres.upcStatus.adr, 75);
                            //40376
                            this.general.upcStatus = res3[0];
                            //40381
                            this.reserves.co2Res1Status = this.client.registerToUint32([res3[5]]);
                            //40383
                            this.reserves.co2Res2Status = this.client.registerToUint32([res3[6]]);
                            //40421 40422 
                            this.reserves.co2Res1StartVol = Math.round((this.client.registerToFloat([res3[45], res3[46]]) * 0.001974) * 100) / 100;
                            //40449 40450  Math.round((this.client.registerToFloat([res[87],res[88]])* 0.001974) * 100) / 100
                            this.reserves.co2Res2StartVol = Math.round((this.client.registerToFloat([res3[73], res3[74]]) * 0.001974) * 100) / 100;
                            var res4 = yield this.client.readHoldingRegisters(correspondancesRegistres.xCo2Res1CodesBarres.adr, 90);
                            //41124 41128
                            var tabB11 = [];
                            for (var i = 0; i < 5; i++) {
                                tabB11.push(res4[i]);
                            }
                            this.reserves.bottlesB1.push(this.client.registerToString(tabB11));
                            //41129 41133
                            var tabB12 = [];
                            for (var i = 5; i < 10; i++) {
                                tabB12.push(res4[i]);
                            }
                            this.reserves.bottlesB1.push(this.client.registerToString(tabB12));
                            //41134 41138
                            var tabB13 = [];
                            for (var i = 10; i < 15; i++) {
                                tabB13.push(res4[i]);
                            }
                            this.reserves.bottlesB1.push(this.client.registerToString(tabB13));
                            //41139 41143
                            var tabB14 = [];
                            for (var i = 15; i < 20; i++) {
                                tabB14.push(res4[i]);
                            }
                            this.reserves.bottlesB1.push(this.client.registerToString(tabB14));
                            //41144 41148
                            var tabB15 = [];
                            for (var i = 20; i < 25; i++) {
                                tabB15.push(res4[i]);
                            }
                            this.reserves.bottlesB1.push(this.client.registerToString(tabB15));
                            //41149 41153
                            var tabB16 = [];
                            for (var i = 25; i < 30; i++) {
                                tabB16.push(res4[i]);
                            }
                            this.reserves.bottlesB1.push(this.client.registerToString(tabB16));
                            //41154 41158
                            var tabB17 = [];
                            for (var i = 30; i < 35; i++) {
                                tabB17.push(res4[i]);
                            }
                            this.reserves.bottlesB1.push(this.client.registerToString(tabB17));
                            //41159 41163
                            var tabB18 = [];
                            for (var i = 35; i < 40; i++) {
                                tabB18.push(res4[i]);
                            }
                            this.reserves.bottlesB1.push(this.client.registerToString(tabB18));
                            //41164 41168
                            var tabB19 = [];
                            for (var i = 40; i < 45; i++) {
                                tabB19.push(res4[i]);
                            }
                            this.reserves.bottlesB1.push(this.client.registerToString(tabB19));
                            //41169 41173
                            var tabB21 = [];
                            for (var i = 45; i < 50; i++) {
                                tabB21.push(res4[i]);
                            }
                            this.reserves.bottlesB2.push(this.client.registerToString(tabB21));
                            //41174 41178
                            var tabB22 = [];
                            for (var i = 50; i < 55; i++) {
                                tabB22.push(res4[i]);
                            }
                            this.reserves.bottlesB2.push(this.client.registerToString(tabB22));
                            //41179 41183
                            var tabB23 = [];
                            for (var i = 55; i < 60; i++) {
                                tabB23.push(res4[i]);
                            }
                            this.reserves.bottlesB2.push(this.client.registerToString(tabB23));
                            //41184 41188
                            var tabB24 = [];
                            for (var i = 60; i < 65; i++) {
                                tabB24.push(res4[i]);
                            }
                            this.reserves.bottlesB2.push(this.client.registerToString(tabB24));
                            //41189 41193
                            var tabB25 = [];
                            for (var i = 65; i < 70; i++) {
                                tabB25.push(res4[i]);
                            }
                            this.reserves.bottlesB2.push(this.client.registerToString(tabB25));
                            //41194 41198
                            var tabB26 = [];
                            for (var i = 70; i < 75; i++) {
                                tabB26.push(res4[i]);
                            }
                            this.reserves.bottlesB2.push(this.client.registerToString(tabB26));
                            //41199 41203
                            var tabB27 = [];
                            for (var i = 75; i < 80; i++) {
                                tabB27.push(res4[i]);
                            }
                            this.reserves.bottlesB2.push(this.client.registerToString(tabB27));
                            //41204 41208
                            var tabB28 = [];
                            for (var i = 80; i < 85; i++) {
                                tabB28.push(res4[i]);
                            }
                            this.reserves.bottlesB2.push(this.client.registerToString(tabB28));
                            //41209 41213
                            var tabB29 = [];
                            for (var i = 85; i < 90; i++) {
                                tabB29.push(res4[i]);
                            }
                            this.reserves.bottlesB2.push(this.client.registerToString(tabB29));
                            success = true;
                            break;
                        }
                    }
                    catch (err) {
                        success = false;
                        error = err;
                        break;
                    }
            }
            if (success == true) {
                return true;
            }
            else {
                return error;
            }
        });
    }
    readAllRegOld(upcNameId, mode, page) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            var repBloc1 = yield this.readBloc1(upcNameId, mode);
            if (repBloc1.success == true) {
                return true;
                if (repBloc1.object == "Terminer l'intervention en cours") {
                    return "Terminer l'intervention en cours";
                }
                else {
                    if (repBloc1.object == "Abandonner l'intervention en cours") {
                        return "Abandonner l'intervention en cours";
                    }
                    else {
                        if (repBloc1.object == "Se rapprocher de l'upc") {
                            return "Se rapprocher de l'upc";
                        }
                        else {
                            var repBloc2 = yield this.readBloc2();
                            if (repBloc2.success == true) {
                                var repBloc3 = yield this.readBloc3();
                                if (repBloc3.success == true) {
                                    var repBloc4 = yield this.readBloc4();
                                    if (repBloc4.success == true) {
                                        var repBloc5 = yield this.readBloc5();
                                        if (repBloc5.success == true) {
                                            var repBloc6 = yield this.readBloc6();
                                            if (repBloc6.success == true) {
                                                return true;
                                            }
                                            else {
                                                return repBloc6; //retourne l'erreur du bloc 6
                                            }
                                        }
                                        else {
                                            return repBloc5; //retourne l'erreur du bloc 5
                                        }
                                    }
                                    else {
                                        return repBloc4; //retourne l'erreur du bloc 4
                                    }
                                }
                                else {
                                    return repBloc3; //retourne l'erreur du bloc 3
                                }
                            }
                            else {
                                return repBloc2; //retourne l'erreur du bloc 2
                            }
                        }
                    }
                }
            }
            else {
                return repBloc1; //retourne l'erreur du bloc 1
            }
            /*this.client.readHoldingRegisters(40600,120).then(res=>{
              //0 to 99 sms not necessary
              //100 to 120 not necessary
            }).catch(err=>{
              alert(JSON.stringify(err));
            })*/
            /*this.client.readHoldingRegisters(40720,120).then(res=>{
              //0 to 19 not necessary
              //20 to 39 not necessary
              //40 to 69 not necessary
              //70 to 99 not necessary
              //100 to 119 nothing
              // 120 not necessary
            }).catch(err=>{
              alert(JSON.stringify(err));
            })*/
            /*this.client.readHoldingRegisters(40840,120).then(res=>{
              // 0 to 29 not necessary
        
              alert(JSON.stringify(res));
            }).catch(err=>{
              alert(JSON.stringify(err));
            })*/
            /*this.client.readHoldingRegisters(40961,120).then(res=>{
              alert(JSON.stringify(res));
        
            }).catch(err=>{
              alert(JSON.stringify(err));
            })*/
            /*this.client.readHoldingRegisters(41081,120).then(res=>{
              alert(JSON.stringify(res));
            }).catch(err=>{
              alert(JSON.stringify(err));
            })*/
            //if(bool1 && bool2 && bool3 && bool4 && bool5 && bool6 ){
            //var itm = await this.readAllReg();
            //}
        });
    }
    onConfirm(buttonIndex) {
        if (buttonIndex == 0) {
            this.answer = 0;
        }
        if (buttonIndex == 1) {
            this.answer = 1;
        }
        if (buttonIndex == 2) {
            this.answer = 2;
        }
        if (buttonIndex == 3) {
            this.answer = 3;
        }
    }
    readBloc1(upcNameId, mode) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            const opt = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric', hour: 'numeric',
                minute: 'numeric',
                dayPeriod: 'short' };
            try {
                var res = yield this.client.readHoldingRegisters(40168, 1);
                //40001 40010
                var tabname = [];
                for (var i = 0; i < 10; i++) {
                    tabname.push(res[i]);
                }
                var nameId = this.client.registerToString(tabname).replace(/[^a-zA-Z0-9]/g, '');
                if (mode != "modeTest") { //on n'est pas en mode test   
                    if (nameId != upcNameId) { //changement d'UPC
                        if (window.confirm("Une intervention est en cours sur l'upc " + upcNameId + ". Voulez-vous néanmoins continuer sur l'upc " + nameId + "?")) {
                            if (window.confirm("Voulez-vous terminer l'intervention ? (OK) ou l'abandonner ? (Annuler)")) {
                                return { success: true, object: "Terminer l'intervention en cours" };
                            }
                            else {
                                return { success: true, object: "Abandonner l'intervention en cours" };
                            }
                        }
                        else {
                            alert("Rapprochez-vous de l'upc " + upcNameId + " puis appuyez sur 'OK'.");
                            return { success: true, object: "Se rapprocher de l'upc" };
                        }
                    }
                    else {
                        this.nameId = nameId;
                        //40011
                        this.general.upcMode = this.client.registerToUint32(res[10]);
                        //40012 40013
                        this.general.upcClock = new Date(this.client.registerToUint32([res[11], res[12]]) * 1000).toLocaleDateString("fr-FR", opt);
                        //40014
                        this.general.upcLanguage = this.client.registerToUint32(res[13]);
                        //40015
                        this.general.upcTrapNum = res[14];
                        //40016 40017
                        this.general.co2FlowRefTrap = this.client.registerToFloat([res[15], res[16]]);
                        //40018 40019
                        this.general.co2FlowRefAdj = this.client.registerToFloat([res[17], res[18]]);
                        //40020 40021
                        this.general.co2FlowRefNom = this.client.registerToFloat([res[19], res[20]]);
                        //40022 40023
                        this.communicationParameters.comGsmIpAdr = this.int2ip(this.client.registerToUint32([res[21], res[22]]));
                        //40024 40033
                        var tabMdmName = [];
                        for (var i = 23; i < 33; i++) {
                            tabMdmName.push(res[i]);
                        }
                        this.communicationParameters.comMdmName = this.client.registerToString(tabMdmName);
                        //40034 40043
                        var tabMdmPass = [];
                        for (var i = 33; i < 43; i++) {
                            tabMdmPass.push(res[i]);
                        }
                        this.communicationParameters.comGsmPass = this.client.registerToString(tabMdmPass);
                        //43 ne pas lire 40044
                        //40045 40053
                        var tabssid = [];
                        for (var i = 44; i < 54; i++) {
                            tabssid.push(res[i]);
                        }
                        this.communicationParameters.comGsmName = this.client.registerToString(tabssid);
                        //40055 40064
                        var tabpassword = [];
                        for (var i = 54; i < 64; i++) {
                            tabpassword.push(res[i]);
                        }
                        this.communicationParameters.comWiFiPass = this.client.registerToString(tabpassword).replace(/[^a-zA-Z0-9-.-]/g, '');
                        //40065
                        this.diffusions.upcDiffLvlAdj = res[64];
                        //40066
                        this.alarm.alrResLowEn = res[65] == 1;
                        //66 à ne pas lire 40067
                        //40068 40069
                        this.diffHourSunrise = this.client.registerToUint32([res[67], res[68]]);
                        //40070 40071
                        this.diffHourSunset = this.client.registerToUint32([res[69], res[70]]);
                        //40072 40073
                        this.diffCo2Program[0].start = this.client.registerToUint32([res[71], res[72]]);
                        //40074 40075
                        this.diffCo2Program[0].stop = this.client.registerToUint32([res[73], res[74]]);
                        //40076
                        this.diffCo2Program[0].mode = this.client.registerToUint32([res[75]]);
                        //40077
                        this.diffCo2Program[0].intensity = this.client.registerToUint32([res[76]]);
                        //40078 40079
                        this.diffCo2Program[1].start = this.client.registerToUint32([res[77], res[78]]);
                        //40080 40081
                        this.diffCo2Program[1].stop = this.client.registerToUint32([res[79], res[80]]);
                        // 40082
                        this.diffCo2Program[1].mode = this.client.registerToUint32([res[81]]);
                        //40083
                        this.diffCo2Program[1].intensity = this.client.registerToUint32([res[82]]);
                        //40084 40085
                        this.diffCo2Program[2].start = this.client.registerToUint32([res[83], res[84]]);
                        //40086 40087
                        this.diffCo2Program[2].stop = this.client.registerToUint32([res[85], res[86]]);
                        //40088
                        this.diffCo2Program[2].mode = this.client.registerToUint32([res[87]]);
                        //40089
                        this.diffCo2Program[2].intensity = this.client.registerToUint32([res[88]]);
                        //40090 40091
                        this.diffCo2Program[3].start = this.client.registerToUint32([res[89], res[90]]);
                        //40092 40093
                        this.diffCo2Program[3].stop = this.client.registerToUint32([res[91], res[92]]);
                        //40094 
                        this.diffCo2Program[3].mode = this.client.registerToUint32([res[93]]);
                        //40095
                        this.diffCo2Program[3].intensity = this.client.registerToUint32(res[94]);
                        //40096 40097
                        this.diffCo2Program[4].start = this.client.registerToUint32([res[95], res[96]]);
                        //40098 40099
                        this.diffCo2Program[4].stop = this.client.registerToUint32([res[97], res[98]]);
                        //40100
                        this.diffCo2Program[4].mode = this.client.registerToUint32([res[99]]);
                        //40101
                        this.diffCo2Program[4].intensity = this.client.registerToUint32(res[100]);
                        //40102 40103
                        this.diffCo2Program[5].start = this.client.registerToUint32([res[101], res[102]]);
                        //40104 40105
                        this.diffCo2Program[5].stop = this.client.registerToUint32([res[103], res[104]]);
                        //40106
                        this.diffCo2Program[5].mode = this.client.registerToUint32([res[105]]);
                        //40107
                        this.diffCo2Program[5].intensity = this.client.registerToUint32([res[106]]);
                        //40108 40109
                        this.diffCo2Program[6].start = this.client.registerToUint32([res[107], res[108]]);
                        //40110 40111
                        this.diffCo2Program[6].stop = this.client.registerToUint32([res[109], res[110]]);
                        //40112 
                        this.diffCo2Program[6].mode = this.client.registerToUint32([res[111]]);
                        //40113
                        this.diffCo2Program[6].intensity = this.client.registerToUint32([res[112]]);
                        //40114 40115
                        this.diffCo2Program[7].start = this.client.registerToUint32([res[113], res[114]]);
                        //40116 40117
                        this.diffCo2Program[7].stop = this.client.registerToUint32([res[115], res[116]]);
                        //40118 
                        this.diffCo2Program[7].mode = this.client.registerToUint32([res[117]]);
                        //40119
                        this.diffCo2Program[7].intensity = this.client.registerToUint32([res[118]]);
                        //40120 40121
                        this.diffCo2Program[8].start = this.client.registerToUint32([res[119], res[120]]);
                        return { success: true, object: res };
                    }
                }
                else { //on est en mode test
                    this.nameId = nameId;
                    //40011
                    this.general.upcMode = this.client.registerToUint32(res[10]);
                    //40012 40013
                    this.general.upcClock = new Date(this.client.registerToUint32([res[11], res[12]]) * 1000).toLocaleDateString("fr-FR", opt);
                    //40014
                    this.general.upcLanguage = this.client.registerToUint32(res[13]);
                    //40015
                    this.general.upcTrapNum = res[14];
                    //40016 40017
                    this.general.co2FlowRefTrap = this.client.registerToFloat([res[15], res[16]]);
                    //40018 40019
                    this.general.co2FlowRefAdj = this.client.registerToFloat([res[17], res[18]]);
                    //40020 40021
                    this.general.co2FlowRefNom = this.client.registerToFloat([res[19], res[20]]);
                    //40022 40023
                    this.communicationParameters.comGsmIpAdr = this.int2ip(this.client.registerToUint32([res[21], res[22]]));
                    //40024 40033
                    var tabMdmName = [];
                    for (var i = 23; i < 33; i++) {
                        tabMdmName.push(res[i]);
                    }
                    this.communicationParameters.comMdmName = this.client.registerToString(tabMdmName);
                    //40034 40043
                    var tabMdmPass = [];
                    for (var i = 33; i < 43; i++) {
                        tabMdmPass.push(res[i]);
                    }
                    this.communicationParameters.comGsmPass = this.client.registerToString(tabMdmPass);
                    //43 ne pas lire 40044
                    //40045 40053
                    var tabssid = [];
                    for (var i = 44; i < 54; i++) {
                        tabssid.push(res[i]);
                    }
                    this.communicationParameters.comGsmName = this.client.registerToString(tabssid);
                    //40055 40064
                    var tabpassword = [];
                    for (var i = 54; i < 64; i++) {
                        tabpassword.push(res[i]);
                    }
                    this.communicationParameters.comWiFiPass = this.client.registerToString(tabpassword);
                    //40065
                    this.diffusions.upcDiffLvlAdj = res[64];
                    //40066
                    this.alarm.alrResLowEn = res[65] == 1;
                    //66 à ne pas lire 40067
                    //40068 40069
                    this.diffHourSunrise = this.client.registerToUint32([res[67], res[68]]);
                    //40070 40071
                    this.diffHourSunset = this.client.registerToUint32([res[69], res[70]]);
                    //40072 40073
                    this.diffCo2Program[0].start = this.client.registerToUint32([res[71], res[72]]);
                    //40074 40075
                    this.diffCo2Program[0].stop = this.client.registerToUint32([res[73], res[74]]);
                    //40076
                    this.diffCo2Program[0].mode = this.client.registerToUint32([res[75]]);
                    //40077
                    this.diffCo2Program[0].intensity = this.client.registerToUint32([res[76]]);
                    //40078 40079
                    this.diffCo2Program[1].start = this.client.registerToUint32([res[77], res[78]]);
                    //40080 40081
                    this.diffCo2Program[1].stop = this.client.registerToUint32([res[79], res[80]]);
                    // 40082
                    this.diffCo2Program[1].mode = this.client.registerToUint32([res[81]]);
                    //40083
                    this.diffCo2Program[1].intensity = this.client.registerToUint32([res[82]]);
                    //40084 40085
                    this.diffCo2Program[2].start = this.client.registerToUint32([res[83], res[84]]);
                    //40086 40087
                    this.diffCo2Program[2].stop = this.client.registerToUint32([res[85], res[86]]);
                    //40088
                    this.diffCo2Program[2].mode = this.client.registerToUint32([res[87]]);
                    //40089
                    this.diffCo2Program[2].intensity = this.client.registerToUint32([res[88]]);
                    //40090 40091
                    this.diffCo2Program[3].start = this.client.registerToUint32([res[89], res[90]]);
                    //40092 40093
                    this.diffCo2Program[3].stop = this.client.registerToUint32([res[91], res[92]]);
                    //40094 
                    this.diffCo2Program[3].mode = this.client.registerToUint32([res[93]]);
                    //40095
                    this.diffCo2Program[3].intensity = this.client.registerToUint32(res[94]);
                    //40096 40097
                    this.diffCo2Program[4].start = this.client.registerToUint32([res[95], res[96]]);
                    //40098 40099
                    this.diffCo2Program[4].stop = this.client.registerToUint32([res[97], res[98]]);
                    //40100
                    this.diffCo2Program[4].mode = this.client.registerToUint32([res[99]]);
                    //40101
                    this.diffCo2Program[4].intensity = this.client.registerToUint32(res[100]);
                    //40102 40103
                    this.diffCo2Program[5].start = this.client.registerToUint32([res[101], res[102]]);
                    //40104 40105
                    this.diffCo2Program[5].stop = this.client.registerToUint32([res[103], res[104]]);
                    //40106
                    this.diffCo2Program[5].mode = this.client.registerToUint32([res[105]]);
                    //40107
                    this.diffCo2Program[5].intensity = this.client.registerToUint32([res[106]]);
                    //40108 40109
                    this.diffCo2Program[6].start = this.client.registerToUint32([res[107], res[108]]);
                    //40110 40111
                    this.diffCo2Program[6].stop = this.client.registerToUint32([res[109], res[110]]);
                    //40112 
                    this.diffCo2Program[6].mode = this.client.registerToUint32([res[111]]);
                    //40113
                    this.diffCo2Program[6].intensity = this.client.registerToUint32([res[112]]);
                    //40114 40115
                    this.diffCo2Program[7].start = this.client.registerToUint32([res[113], res[114]]);
                    //40116 40117
                    this.diffCo2Program[7].stop = this.client.registerToUint32([res[115], res[116]]);
                    //40118 
                    this.diffCo2Program[7].mode = this.client.registerToUint32([res[117]]);
                    //40119
                    this.diffCo2Program[7].intensity = this.client.registerToUint32([res[118]]);
                    //40120 40121
                    this.diffCo2Program[8].start = this.client.registerToUint32([res[119], res[120]]);
                    var d = new Date();
                    var t = d.getTime();
                    return { success: true, object: res, bloc: 1, time: t };
                }
            }
            catch (err) {
                return { success: false, object: err, bloc: 1 };
            }
        });
    }
    readBloc2() {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            var res = yield this.client.readHoldingRegisters(40122, 120);
            try {
                //40122 40123
                this.diffCo2Program[8].stop = this.client.registerToUint32([res[0], res[1]]);
                //40124 
                this.diffCo2Program[8].mode = this.client.registerToUint32([res[2]]);
                //40125
                this.diffCo2Program[8].intensity = this.client.registerToUint32([res[3]]);
                //40126 40127
                this.diffCo2Program[9].start = this.client.registerToUint32([res[4], res[5]]);
                //40128 40129
                this.diffCo2Program[9].stop = this.client.registerToUint32([res[6], res[7]]);
                //40130
                this.diffCo2Program[9].mode = this.client.registerToUint32([res[8]]);
                //40131
                this.diffCo2Program[9].intensity = this.client.registerToUint32(res[9]);
                //40132 40133
                this.diffCo2Sunrise.offset = this.client.registerToUint32([res[10], res[11]]);
                //40134 40135
                this.diffCo2Sunrise.duration = this.client.registerToUint32([res[12], res[13]]);
                //40137
                this.diffCo2Sunrise.intensity = this.client.registerToUint32([res[15]]);
                //40138 40139
                this.diffCo2Sunset.offset = this.client.registerToUint32([res[16], res[17]]);
                //40140 40141
                this.diffCo2Sunset.duration = this.client.registerToUint32([res[18], res[19]]);
                //40143
                this.diffCo2Sunset.intensity = this.client.registerToUint32([res[21]]);
                //40144 40145
                this.diffusions.diffCo2Instant.delay = this.client.registerToUint32([res[22], res[23]]);
                //40146 40147
                this.diffusions.diffCo2Instant.duration = this.client.registerToUint32([res[24], res[25]]);
                //40149
                this.diffusions.diffCo2Instant.intensity = this.client.registerToUint32([res[27]]);
                //40150
                this.reserves.co2ResActAdj = this.client.registerToUint32([res[28]]);
                //40151
                this.reserves.co2ResActive = this.client.registerToUint32([res[29]]);
                //30 Non utilisé 40152
                //40153 40154
                this.reserves.co2Res1FillVol = this.client.registerToFloat([res[31], res[32]]);
                //40155 40156
                this.reserves.co2Res1FillTime = this.client.registerToUint32([res[33], res[34]]);
                //40157 40158
                this.reserves.co2Res1ActVol = Math.round((this.client.registerToFloat([res[35], res[36]]) * 0.001974) * 100) / 100;
                //40159
                this.reserves.co2Res1ActDur = this.client.registerToUint32([res[37]]);
                //40160 libre 38
                //40161 40162
                this.reserves.co2Res2FillVol = this.client.registerToFloat([res[39], res[40]]);
                //40163 40164
                this.reserves.co2Res2FillTime = this.client.registerToUint32([res[41], res[42]]);
                //40165 40166
                this.reserves.co2Res2ActVol = Math.round((this.client.registerToFloat([res[43], res[44]]) * 0.001974) * 100) / 100;
                //40167
                this.reserves.co2Res2ActDur = this.client.registerToUint32([res[45]]);
                //40168
                this.general.upcFwVer = this.client.registerToUint32([res[46]]);
                //40169
                this.alarm.alrResEmptyEn = res[47] == 1;
                //40170
                this.alarm.alrPresInpEn = res[48] == 1;
                //40171
                this.alarm.alrPresOutEn = res[49] == 1;
                //40172
                this.alarm.alrFlowAvgEn = res[50] == 1;
                //40173
                this.alarm.alrPowDownEn = res[51] == 1;
                //40174
                this.alarm.alrPowBackEn = res[52] == 1;
                // 53-102 SMS non necessaire 40175 40224
                //40225 40226
                this.alarm.alrResEmptyFlow = this.client.registerToFloat([res[103], res[104]]);
                //40227 40228
                this.alarm.alrResLowLevel = this.client.registerToFloat([res[105], res[106]]);
                //40229 40230
                this.alarm.alrPressInpSet1_1 = this.client.registerToFloat([res[107], res[108]]);
                //40231 40232
                this.alarm.alrPressInpSet1_2 = this.client.registerToFloat([res[109], res[110]]);
                //40233 40234
                this.alarm.alrPressInpSet1_3 = this.client.registerToFloat([res[111], res[112]]);
                //40235 40236
                this.alarm.alrPressInpSet1_4 = this.client.registerToFloat([res[113], res[114]]);
                //40237 40238
                this.alarm.alrPressInpSet1_5 = this.client.registerToFloat([res[115], res[116]]);
                //40239 40240
                this.alarm.alrPressInpSet1_6 = this.client.registerToFloat([res[117], res[118]]);
                return { success: true, object: res, bloc: 2 };
            }
            catch (err) {
                return { success: false, object: err, bloc: 2 };
            }
        });
    }
    readBloc3() {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            try {
                var res = yield this.client.readHoldingRegisters(40241, 120);
                //40241 40242
                this.alarm.alrPressInpSet1_7 = this.client.registerToFloat([res[0], res[1]]);
                //40243 40244
                this.alarm.alrPressInpSet1_8 = this.client.registerToFloat([res[2], res[3]]);
                //40245 40246
                this.alarm.alrPressInpSet1_9 = this.client.registerToFloat([res[4], res[5]]);
                //40247 40248
                this.alarm.alrPressInpSet1_10 = this.client.registerToFloat([res[6], res[7]]);
                //40249 40250
                this.alarm.alrPressInpSet2_1 = this.client.registerToFloat([res[8], res[9]]);
                //40251 40252
                this.alarm.alrPressInpSet2_2 = this.client.registerToFloat([res[10], res[11]]);
                //40253 40254
                this.alarm.alrPressInpSet2_3 = this.client.registerToFloat([res[12], res[13]]);
                //40255 40256
                this.alarm.alrPressInpSet2_4 = this.client.registerToFloat([res[14], res[15]]);
                //40257 40258
                this.alarm.alrPressInpSet2_5 = this.client.registerToFloat([res[16], res[17]]);
                //40259 40260
                this.alarm.alrPressInpSet2_6 = this.client.registerToFloat([res[18], res[19]]);
                //40261 40262
                this.alarm.alrPressInpSet2_7 = this.client.registerToFloat([res[20], res[21]]);
                //40263 40264
                this.alarm.alrPressInpSet2_8 = this.client.registerToFloat([res[22], res[23]]);
                //40265 40266
                this.alarm.alrPressInpSet2_9 = this.client.registerToFloat([res[24], res[25]]);
                //40267 40268
                this.alarm.alrPressInpSet2_10 = this.client.registerToFloat([res[26], res[27]]);
                //40269 40270
                this.alarm.alrPresInpTol = this.client.registerToFloat([res[28], res[29]]);
                //40271 40272
                this.general.co2PresOutRef1 = this.client.registerToFloat([res[30], res[31]]);
                //40273 40274
                this.general.co2PresOutRef2 = this.client.registerToFloat([res[32], res[33]]);
                //40275 40276
                this.general.co2PresOutRef3 = this.client.registerToFloat([res[34], res[35]]);
                //40277 40278
                this.general.co2PresOutRef4 = this.client.registerToFloat([res[36], res[37]]);
                //40279 40280
                this.general.co2PresOutRef5 = this.client.registerToFloat([res[38], res[39]]);
                //40281 40282
                this.general.co2PresOutRef6 = this.client.registerToFloat([res[40], res[41]]);
                //40283 40284
                this.general.co2PresOutRef7 = this.client.registerToFloat([res[42], res[43]]);
                //40285 40286
                this.general.co2PresOutRef8 = this.client.registerToFloat([res[44], res[45]]);
                //40287 40288
                this.general.co2PresOutRef9 = this.client.registerToFloat([res[46], res[47]]);
                //40289 40290
                this.general.co2PresOutRef10 = this.client.registerToFloat([res[48], res[49]]);
                //40291 40292
                this.alarm.alrPresOutTol = this.client.registerToFloat([res[50], res[51]]);
                //40293 40294
                this.alarm.alrFlowSetTol = this.client.registerToFloat([res[52], res[53]]);
                //40295 40310
                var taburl = [];
                for (var i = 54; i < 69; i++) {
                    taburl.push(res[i]);
                }
                this.communicationParameters.comWebSrvUrl = this.client.registerToString(taburl).replace(/[^a-zA-Z0-9-.-]/g, '');
                //40320
                var tabapnuser = [];
                for (var i = 79; i < 89; i++) {
                    tabapnuser.push(res[i]);
                }
                this.communicationParameters.comMdmApnUser = this.client.registerToString(tabapnuser).replace(/[^a-zA-Z0-9]/g, '');
                //40330 40339
                var tabapnpass = [];
                for (var i = 89; i < 99; i++) {
                    tabapnpass.push(res[i]);
                }
                this.communicationParameters.comMdmApnPass = this.client.registerToString(tabapnpass).replace(/[^a-zA-Z0-9]/g, '');
                //40340 
                this.communicationParameters.comWifiApCh = this.client.registerToUint32([res[99]]);
                //40341 Non utilisé 100
                //40342 40346
                var tabResBottles = [];
                for (var i = 101; i < 106; i++) {
                    tabResBottles.push(res[i]);
                }
                this.reserves.co2Res1Bottle = this.client.registerToUint32(tabResBottles);
                //40347 40348
                this.reserves.co2Res1AuxVol = this.client.registerToFloat([res[106], res[107]]);
                //40349 40353
                var tabResBottles2 = [];
                for (var i = 107; i < 112; i++) {
                    tabResBottles2.push(res[i]);
                }
                this.reserves.co2Res2Bottle = this.client.registerToUint32(tabResBottles2);
                //40354 40355
                this.reserves.co2Res2AuxVol = this.client.registerToFloat([res[112], res[113]]);
                //40356 40357
                this.alarm.alrPressOutSet_1 = this.client.registerToFloat([res[114], res[115]]);
                //40358 40359
                this.alarm.alrPressOutSet_2 = this.client.registerToFloat([res[116], res[117]]);
                //40360 40361
                this.alarm.alrPressOutSet_3 = this.client.registerToFloat([res[118], res[119]]);
                return { success: true, object: res, bloc: 3 };
            }
            catch (err) {
                return { success: false, object: err, bloc: 3 };
            }
        });
    }
    readBloc4() {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            try {
                var res = yield this.client.readHoldingRegisters(40362, 105);
                //40362 40263
                this.alarm.alrPressOutSet_4 = this.client.registerToFloat([res[0], res[1]]);
                //40364 402365
                this.alarm.alrPressOutSet_5 = this.client.registerToFloat([res[2], res[3]]);
                //40366 40367
                this.alarm.alrPressOutSet_6 = this.client.registerToFloat([res[4], res[5]]);
                //40368 40369
                this.alarm.alrPressOutSet_7 = this.client.registerToFloat([res[6], res[7]]);
                //40370 40371
                this.alarm.alrPressOutSet_8 = this.client.registerToFloat([res[8], res[9]]);
                //40372 40373
                this.alarm.alrPressOutSet_9 = this.client.registerToFloat([res[10], res[11]]);
                //40374 40375
                this.alarm.alrPressOutSet_10 = this.client.registerToFloat([res[12], res[13]]);
                //40376
                this.general.upcStatus = this.client.registerToUint32([res[14]]);
                //40377 40378
                this.general.upcCo2PidInteg = this.client.registerToFloat([res[15], res[16]]);
                //40379 40380
                this.general.upcCo2PidDiff = this.client.registerToFloat([res[17], res[18]]);
                //40381
                this.reserves.co2Res1Status = this.client.registerToUint32([res[19]]);
                //40382
                this.reserves.co2ResType = this.client.registerToUint32([res[20]]);
                //40383
                this.reserves.co2Res2Status = this.client.registerToUint32([res[21]]);
                //40384 40385
                this.reserves.co2Res1FillNew = this.client.registerToFloat([res[22], res[23]]);
                //40386 40387
                this.reserves.co2Res2FillNew = this.client.registerToFloat([res[24], res[25]]);
                //40388 40389
                this.alarm.alrResEmptyTest = this.client.registerToUint32([res[26], res[27]]);
                //40390 40391
                this.diffusions.co2FlowGain = this.client.registerToFloat([res[28], res[29]]);
                //40392 40400 non alloué 30 38
                //40401 40402
                this.general.upcTimeZone = this.client.registerToUint32([res[39], res[40]]);
                //40403 40414 event 40 51
                //40414
                this.communicationParameters.comMdmMode = this.client.registerToUint32([res[52]]);
                //40415
                this.communicationParameters.comGsmLevel = this.client.registerToUint32([res[53]]);
                //40416
                this.diffusions.upcCo2DiffLvl = this.client.registerToUint32([res[54]]);
                //40417 40418
                this.reserves.co2ResActPrev = this.client.registerToUint32([res[55], res[56]]);
                //40419 40420
                this.reserves.co2ResInactPrev = this.client.registerToUint32([res[57], res[58]]);
                //40421 40422 
                this.reserves.co2Res1StartVol = Math.round((this.client.registerToFloat([res[59], res[60]]) * 0.001974) * 100) / 100;
                //40423 40424
                this.general.upcBattChrg = this.client.registerToFloat([res[61], res[62]]);
                //40425 40426
                this.general.upcBattTemp = this.client.registerToFloat([res[63], res[64]]);
                //40427 40428
                this.diffusions.co2PresInpMeas1 = this.client.registerToFloat([res[65], res[66]]);
                //40429 40430
                this.diffusions.co2PresInpMeas2 = this.client.registerToFloat([res[67], res[68]]);
                //40431 40432
                this.diffusions.co2PresOutMeas = this.client.registerToFloat([res[69], res[70]]);
                //40433 40434
                this.diffusions.co2FlowMeas = this.client.registerToFloat([res[71], res[72]]);
                //40435 40436
                this.diffusions.co2PresInpAvg = this.client.registerToFloat([res[73], res[74]]);
                //40437 40438
                this.diffusions.co2PresOutAvg = this.client.registerToFloat([res[75], res[76]]);
                //40439 40440
                this.diffusions.co2FlowAvg = this.client.registerToFloat([res[77], res[78]]);
                //40441 40449 79 87
                var tabuuid = "";
                for (var i = 79; i < 87; i++) {
                    tabuuid += this.toZero4(res[i]);
                }
                this.general.upcMcuUid = tabuuid;
                //40449 40450  Math.round((this.client.registerToFloat([res[87],res[88]])* 0.001974) * 100) / 100
                this.reserves.co2Res2StartVol = Math.round((this.client.registerToFloat([res[87], res[88]]) * 0.001974) * 100) / 100;
                //40451 40452
                this.diffusions.co2TempAvg = this.client.registerToFloat([res[89], res[90]]);
                //40453 40454
                this.general.upcCo2PidProp = this.client.registerToFloat([res[91], res[92]]);
                //40455 40456
                this.diffusions.co2PressInpOffs = this.client.registerToFloat([res[93], res[94]]);
                //40457 40458
                this.diffusions.co2PressOutOffs = this.client.registerToFloat([res[95], res[96]]);
                //40459 40460
                this.diffusions.co2FlowOffs = this.client.registerToFloat([res[97], res[98]]);
                //40461 40462
                this.general.co2PressOutTemp = this.client.registerToFloat([res[99], res[100]]);
                //40463 40464
                this.diffusions.co2PressOutComp = this.client.registerToFloat([res[101], res[102]]);
                //40465 40466
                this.alarm.alrPressSetTemp = this.client.registerToFloat([res[103], res[104]]);
                return { success: true, object: res, bloc: 4 };
            }
            catch (err) {
                return { success: false, object: err, bloc: 4 };
            }
        });
    }
    readBloc5() {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            try {
                var res = yield this.client.readHoldingRegisters(40467, 120);
                //40467 40517 0 50 
                var tabapn2 = [];
                for (var i = 0; i < 50; i++) {
                    tabapn2.push(res[i]);
                }
                this.communicationParameters.comMdmApnId2 = this.client.registerToString(tabapn2).replace(/[^a-zA-Z0-9]/g, '');
                return { success: true, object: res, bloc: 5 };
            }
            catch (err) {
                return { success: false, object: err, bloc: 5 };
            }
        });
    }
    readBloc6() {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            try {
                var res = yield this.client.readHoldingRegisters(41124, 120);
                //41124 41128
                var tabB11 = [];
                for (var i = 0; i < 5; i++) {
                    tabB11.push(res[i]);
                }
                this.reserves.bottlesB1.push(this.client.registerToString(tabB11));
                //41129 41133
                var tabB12 = [];
                for (var i = 5; i < 10; i++) {
                    tabB12.push(res[i]);
                }
                this.reserves.bottlesB1.push(this.client.registerToString(tabB12));
                //41134 41138
                var tabB13 = [];
                for (var i = 10; i < 15; i++) {
                    tabB13.push(res[i]);
                }
                this.reserves.bottlesB1.push(this.client.registerToString(tabB13));
                //41139 41143
                var tabB14 = [];
                for (var i = 15; i < 20; i++) {
                    tabB14.push(res[i]);
                }
                this.reserves.bottlesB1.push(this.client.registerToString(tabB14));
                //41144 41148
                var tabB15 = [];
                for (var i = 20; i < 25; i++) {
                    tabB15.push(res[i]);
                }
                this.reserves.bottlesB1.push(this.client.registerToString(tabB15));
                //41149 41153
                var tabB16 = [];
                for (var i = 25; i < 30; i++) {
                    tabB16.push(res[i]);
                }
                this.reserves.bottlesB1.push(this.client.registerToString(tabB16));
                //41154 41158
                var tabB17 = [];
                for (var i = 30; i < 35; i++) {
                    tabB17.push(res[i]);
                }
                this.reserves.bottlesB1.push(this.client.registerToString(tabB17));
                //41159 41163
                var tabB18 = [];
                for (var i = 35; i < 40; i++) {
                    tabB18.push(res[i]);
                }
                this.reserves.bottlesB1.push(this.client.registerToString(tabB18));
                //41164 41168
                var tabB19 = [];
                for (var i = 40; i < 45; i++) {
                    tabB19.push(res[i]);
                }
                this.reserves.bottlesB1.push(this.client.registerToString(tabB19));
                //41169 41173
                var tabB21 = [];
                for (var i = 45; i < 50; i++) {
                    tabB21.push(res[i]);
                }
                this.reserves.bottlesB2.push(this.client.registerToString(tabB21));
                //41174 41178
                var tabB22 = [];
                for (var i = 50; i < 55; i++) {
                    tabB22.push(res[i]);
                }
                this.reserves.bottlesB2.push(this.client.registerToString(tabB22));
                //41179 41183
                var tabB23 = [];
                for (var i = 55; i < 60; i++) {
                    tabB23.push(res[i]);
                }
                this.reserves.bottlesB2.push(this.client.registerToString(tabB23));
                //41184 41188
                var tabB24 = [];
                for (var i = 60; i < 65; i++) {
                    tabB24.push(res[i]);
                }
                this.reserves.bottlesB2.push(this.client.registerToString(tabB24));
                //41189 41193
                var tabB25 = [];
                for (var i = 65; i < 70; i++) {
                    tabB25.push(res[i]);
                }
                this.reserves.bottlesB2.push(this.client.registerToString(tabB25));
                //41194 41198
                var tabB26 = [];
                for (var i = 70; i < 75; i++) {
                    tabB26.push(res[i]);
                }
                this.reserves.bottlesB2.push(this.client.registerToString(tabB26));
                //41199 41203
                var tabB27 = [];
                for (var i = 75; i < 80; i++) {
                    tabB27.push(res[i]);
                }
                this.reserves.bottlesB2.push(this.client.registerToString(tabB27));
                //41204 41208
                var tabB28 = [];
                for (var i = 80; i < 85; i++) {
                    tabB28.push(res[i]);
                }
                this.reserves.bottlesB2.push(this.client.registerToString(tabB28));
                //41209 41213
                var tabB29 = [];
                for (var i = 85; i < 90; i++) {
                    tabB29.push(res[i]);
                }
                this.reserves.bottlesB2.push(this.client.registerToString(tabB29));
                //41214 41219 90 95
                //41219
                this.communicationParameters.xComMdmRssuMoyen2G = this.client.registerToFloat([res[95], res[96]]);
                //41221
                this.communicationParameters.xComMdmRssuMoyen3G = this.client.registerToFloat([res[97], res[98]]);
                //41223
                this.communicationParameters.xComMdmRssuMoyen4G = this.client.registerToFloat([res[99], res[100]]);
                //41225
                this.communicationParameters.xComMdmQualMoyen2GGPRS = this.client.registerToFloat([res[101], res[102]]);
                //41227
                this.communicationParameters.xComMdmQualMoyen2GEDGE = this.client.registerToFloat([res[103], res[104]]);
                //41229
                this.communicationParameters.xComMdmQualMoyen3G = this.client.registerToFloat([res[105], res[106]]);
                //41231
                this.communicationParameters.xComMdmQualMoyen4G = this.client.registerToFloat([res[107], res[108]]);
                //41233
                this.communicationParameters.xComMdmRatioTimeIn2G = this.client.registerToFloat([res[109], res[110]]);
                //41235
                this.communicationParameters.xComMdmRatioTimeIn3G = this.client.registerToFloat([res[111], res[112]]);
                //41237
                this.communicationParameters.xComMdmRatioTimeIn4G = this.client.registerToFloat([res[113], res[114]]);
                //41239
                this.communicationParameters.xComMdmRatioTimeOffline = this.client.registerToFloat([res[115], res[116]]);
                return { success: true, object: res, bloc: 6 };
            }
            catch (err) {
                return { success: false, object: err, bloc: 6 };
            }
        });
    }
    readGeneralParameters() {
        this.client.getIntFromHoldingRegister(40015, 1).then(res => {
            alert(res);
            this.general.upcTrapNum = res;
        });
        this.client.getStringFromHoldingRegister(40441, 8).then(res => {
            //alert(res);
            this.general.upcMcuUid = res;
        });
        this.client.getFloatFromHoldingRegister(40016).then(res => {
            //alert(res);
            this.general.co2FlowRefTrap = res;
        });
        this.client.getFloatFromHoldingRegister(40020).then(res => {
            //alert(res)
            this.general.co2FlowRefNom = res;
        });
        this.client.getFloatFromHoldingRegister(40271).then(res => {
            //alert(res);
            this.general.co2PresOutRef1 = res;
        });
        this.client.getFloatFromHoldingRegister(40273).then(res => {
            //alert(res);
            this.general.co2PresOutRef2 = res;
        });
        this.client.getFloatFromHoldingRegister(40275).then(res => {
            //alert(res);
            this.general.co2PresOutRef3 = res;
        });
        this.client.getFloatFromHoldingRegister(40277).then(res => {
            //alert(res);
            this.general.co2PresOutRef4 = res;
        });
        this.client.getFloatFromHoldingRegister(40279).then(res => {
            //alert(res);
            this.general.co2PresOutRef5 = res;
        });
        this.client.getFloatFromHoldingRegister(40281).then(res => {
            //alert(res);
            this.general.co2PresOutRef6 = res;
        });
        this.client.getFloatFromHoldingRegister(40283).then(res => {
            //alert(res);
            this.general.co2PresOutRef7 = res;
        });
        this.client.getFloatFromHoldingRegister(40285).then(res => {
            //alert(res);
            this.general.co2PresOutRef8 = res;
        });
        this.client.getFloatFromHoldingRegister(40287).then(res => {
            //alert(res);
            this.general.co2PresOutRef9 = res;
        });
        this.client.getFloatFromHoldingRegister(40289).then(res => {
            //alert(res);
            this.general.co2PresOutRef10 = res;
        });
        this.client.getFloatFromHoldingRegister(40461).then(res => {
            //alert(res);
            this.general.co2PressOutTemp = res;
        });
        this.client.getIntFromHoldingRegister(40401, 2).then(res => {
            //alert(res);
            this.general.upcTimeZone = res;
        });
        this.client.getIntFromHoldingRegister(40376, 1).then(res => {
            //alert(res);
            this.general.upcStatus = res;
        });
        this.client.getIntFromHoldingRegister(40011, 1).then(res => {
            //alert(res);
            this.general.upcMode = res;
        });
        this.client.getIntFromHoldingRegister(40168, 1).then(res => {
            //alert(res);
            this.general.upcFwVer = res;
        });
        this.general.co2FlowRefAdj;
        this.client.getIntFromHoldingRegister(40012, 2).then(res => {
            //alert(res);
            this.general.upcClock = res;
        });
        this.client.getFloatFromHoldingRegister(40018).then(res => {
            //alert(res);
            this.general.co2FlowRefAdj = res;
        });
    }
    init() {
        // Init Client
        this.client = new _modbus__WEBPACK_IMPORTED_MODULE_1__["ModbusClient"](32000, false);
        this.client.on('reconnecting', function () {
            this.state = UPCState.RECONNECTING;
            this.stateChangeCallback(this.state);
        }.bind(this));
        this.client.on('offline', function () {
            this.state = UPCState.OFFLINE;
            this.stateChangeCallback(this.state);
        }.bind(this));
        this.client.on('online', function () {
            this.state = UPCState.ONLINE;
            this.stateChangeCallback(this.state);
        }.bind(this));
        this.client.on('error', function () {
            this.state = UPCState.ERROR;
            this.stateChangeCallback(this.state);
        }.bind(this));
        //this.client.createSocket().then(res=>{
        /*setTimeout(()=>{
          this.client.setHost(this.host);
          this.client.setPort(this.port);
          this.client.connect();
          //this.client.reconnect();
        },1000)*/
        //this.client.reconnect();
        //})
        //setTimeout(()=>{
        //},1000)
    }
    disconnect() {
        // Modbus client
        this.client.disconnect();
    }
    reconnect() {
        // Modbus client
        this.client.disconnect();
        this.init();
    }
    sleep(ms) {
        return new Promise(resolve => setTimeout(resolve, ms));
    }
    /**
     * Methods
     */
    flashFW(file, loading) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            var lines = file.split('\n');
            for (var i = 0; i < lines.length; i++) {
                // Write line
                var l = lines[i].trim() + '\0';
                var length = l.length;
                if (length % 2 != 0) {
                    l = l + '\0';
                    length++;
                }
                yield this.client.setStringInHoldingRegister(41000, l);
                const load = yield loading.create({
                    duration: 2000,
                    message: 'Updating firmware : ' + (i / lines.length * 100).toFixed(1) + ' %'
                });
                yield load.present();
            }
        });
    }
    editTrapNum(nbpieges, value) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function* () {
            yield this.client.setIntInHoldingRegister(40015, 1, this.client.getIntFromHoldingRegister(nbpieges, 1)).then(data => {
                alert(JSON.stringify(data));
            }).catch(err => {
                alert(JSON.stringify(err));
            });
            yield this.client.setFloatInHoldingRegister(40018, this.client.getFloatFromHoldingRegister(value)).then(data => {
                alert(JSON.stringify(data));
            }).catch(err => {
                alert(JSON.stringify(err));
            });
            ;
            yield this.client.setFloatInHoldingRegister(40020, this.client.getFloatFromHoldingRegister(value)).then(data => {
                alert(JSON.stringify(data));
            }).catch(err => {
                alert(JSON.stringify(err));
            });
            yield this.client.setFloatInHoldingRegister(40016, 0.17).then(data => {
                alert(JSON.stringify(data));
            }).catch(err => {
                alert(JSON.stringify(err));
            });
        });
    }
    getAllVars() {
        // TODO
        return Promise.all([
            // General parameters
            this.client.getStringFromHoldingRegister(40441, 8),
            this.client.getIntFromHoldingRegister(40168, 1),
            this.client.getStringFromHoldingRegister(40001, 10),
            this.client.getIntFromHoldingRegister(40011, 1),
            this.client.getIntFromHoldingRegister(40376, 1),
            this.client.getIntFromHoldingRegister(40012, 2),
            this.client.getIntFromHoldingRegister(40401, 2),
            this.client.getIntFromHoldingRegister(40014, 1),
            this.client.getIntFromHoldingRegister(40044, 1),
            this.client.getIntFromHoldingRegister(40015, 1),
            this.client.getFloatFromHoldingRegister(40016),
            this.client.getFloatFromHoldingRegister(40020),
            this.client.getFloatFromHoldingRegister(40018),
            this.client.getFloatFromHoldingRegister(40271),
            this.client.getFloatFromHoldingRegister(40273),
            this.client.getFloatFromHoldingRegister(40275),
            this.client.getFloatFromHoldingRegister(40277),
            this.client.getFloatFromHoldingRegister(40279),
            this.client.getFloatFromHoldingRegister(40281),
            this.client.getFloatFromHoldingRegister(40283),
            this.client.getFloatFromHoldingRegister(40285),
            this.client.getFloatFromHoldingRegister(40287),
            this.client.getFloatFromHoldingRegister(40289),
            this.client.getFloatFromHoldingRegister(40461),
            // Comunication
            this.client.getStringFromHoldingRegister(40024, 10),
            this.client.getStringFromHoldingRegister(40034, 10),
            this.client.getIntFromHoldingRegister(40022, 2),
            this.client.getIntFromHoldingRegister(40414, 1),
            this.client.getIntFromHoldingRegister(40415, 1),
            this.client.getStringFromHoldingRegister(40045, 10),
            this.client.getStringFromHoldingRegister(40055, 10),
            this.client.getIntFromHoldingRegister(40340, 1),
            // CO2 diffusion
            this.client.getIntFromHoldingRegister(40068, 2),
            this.client.getIntFromHoldingRegister(40070, 2),
            this.client.getDiffusionProgramFromHoldingRegister(40072),
            this.client.getDiffusionProgramFromHoldingRegister(40078),
            this.client.getDiffusionProgramFromHoldingRegister(40084),
            this.client.getDiffusionProgramFromHoldingRegister(40090),
            this.client.getDiffusionProgramFromHoldingRegister(40096),
            this.client.getDiffusionProgramFromHoldingRegister(40102),
            this.client.getDiffusionProgramFromHoldingRegister(40108),
            this.client.getDiffusionProgramFromHoldingRegister(40114),
            this.client.getDiffusionProgramFromHoldingRegister(40120),
            this.client.getDiffusionProgramFromHoldingRegister(40126),
            this.client.getDiffusionSunFromHoldingRegister(40132),
            this.client.getDiffusionSunFromHoldingRegister(40138),
            this.client.getFloatFromHoldingRegister(40427),
            this.client.getFloatFromHoldingRegister(40429),
            this.client.getFloatFromHoldingRegister(40431),
            this.client.getFloatFromHoldingRegister(40433),
            this.client.getFloatFromHoldingRegister(40435),
            this.client.getFloatFromHoldingRegister(40455),
            this.client.getFloatFromHoldingRegister(40437),
            this.client.getFloatFromHoldingRegister(40457),
            this.client.getFloatFromHoldingRegister(40463),
            this.client.getFloatFromHoldingRegister(40439),
            this.client.getFloatFromHoldingRegister(40459),
            this.client.getFloatFromHoldingRegister(40390),
            this.client.getIntFromHoldingRegister(40416, 1),
            this.client.getIntFromHoldingRegister(40065, 1),
            this.client.getFloatFromHoldingRegister(40451),
            // CO2 reserves
            this.client.getIntFromHoldingRegister(40151, 1),
            this.client.getIntFromHoldingRegister(40150, 1),
            this.client.getIntFromHoldingRegister(40417, 2),
            this.client.getIntFromHoldingRegister(40419, 2),
            this.client.getIntFromHoldingRegister(40382, 1),
            this.client.getIntFromHoldingRegister(40381, 1),
            this.client.getFloatFromHoldingRegister(40384),
            this.client.getFloatFromHoldingRegister(40153),
            this.client.getIntFromHoldingRegister(40155, 2),
            this.client.getFloatFromHoldingRegister(40157),
            this.client.getIntFromHoldingRegister(40159, 1),
            this.client.getFloatFromHoldingRegister(40421),
            this.client.getFloatFromHoldingRegister(40347),
            this.client.getIntFromHoldingRegister(40383, 1),
            this.client.getFloatFromHoldingRegister(40386),
            this.client.getFloatFromHoldingRegister(40161),
            this.client.getIntFromHoldingRegister(40163, 2),
            this.client.getFloatFromHoldingRegister(40165),
            this.client.getIntFromHoldingRegister(40167, 1),
            this.client.getFloatFromHoldingRegister(40449),
            this.client.getFloatFromHoldingRegister(40354),
            // Alarms setup
            this.client.getIntFromHoldingRegister(40388, 2),
            this.client.getIntFromHoldingRegister(40066, 1),
            this.client.getIntFromHoldingRegister(40169, 1),
            this.client.getIntFromHoldingRegister(40170, 1),
            this.client.getIntFromHoldingRegister(40171, 1),
            this.client.getIntFromHoldingRegister(40172, 1),
            this.client.getIntFromHoldingRegister(40173, 1),
            this.client.getIntFromHoldingRegister(40174, 1),
            this.client.getStringFromHoldingRegister(40175, 10),
            this.client.getStringFromHoldingRegister(40185, 10),
            this.client.getStringFromHoldingRegister(40195, 10),
            this.client.getStringFromHoldingRegister(40205, 10),
            this.client.getStringFromHoldingRegister(40215, 10),
            this.client.getFloatFromHoldingRegister(40227),
            this.client.getFloatFromHoldingRegister(40225),
            this.client.getFloatFromHoldingRegister(40269),
            this.client.getFloatFromHoldingRegister(40291),
            this.client.getFloatFromHoldingRegister(40293),
            this.client.getFloatFromHoldingRegister(40229),
            this.client.getFloatFromHoldingRegister(40231),
            this.client.getFloatFromHoldingRegister(40233),
            this.client.getFloatFromHoldingRegister(40235),
            this.client.getFloatFromHoldingRegister(40237),
            this.client.getFloatFromHoldingRegister(40239),
            this.client.getFloatFromHoldingRegister(40241),
            this.client.getFloatFromHoldingRegister(40243),
            this.client.getFloatFromHoldingRegister(40245),
            this.client.getFloatFromHoldingRegister(40247),
            this.client.getFloatFromHoldingRegister(40249),
            this.client.getFloatFromHoldingRegister(40251),
            this.client.getFloatFromHoldingRegister(40253),
            this.client.getFloatFromHoldingRegister(40255),
            this.client.getFloatFromHoldingRegister(40257),
            this.client.getFloatFromHoldingRegister(40259),
            this.client.getFloatFromHoldingRegister(40261),
            this.client.getFloatFromHoldingRegister(40263),
            this.client.getFloatFromHoldingRegister(40265),
            this.client.getFloatFromHoldingRegister(40267),
            this.client.getFloatFromHoldingRegister(40356),
            this.client.getFloatFromHoldingRegister(40358),
            this.client.getFloatFromHoldingRegister(40360),
            this.client.getFloatFromHoldingRegister(40362),
            this.client.getFloatFromHoldingRegister(40364),
            this.client.getFloatFromHoldingRegister(40366),
            this.client.getFloatFromHoldingRegister(40368),
            this.client.getFloatFromHoldingRegister(40370),
            this.client.getFloatFromHoldingRegister(40372),
            this.client.getFloatFromHoldingRegister(40374),
            this.client.getFloatFromHoldingRegister(40465),
            // Auxiliary parameters
            this.client.getStringFromHoldingRegister(40295, 15),
            this.client.getStringFromHoldingRegister(40310, 10),
            this.client.getStringFromHoldingRegister(40320, 10),
            this.client.getStringFromHoldingRegister(40330, 10),
            this.client.getFloatFromHoldingRegister(40453),
            this.client.getFloatFromHoldingRegister(40377),
            this.client.getFloatFromHoldingRegister(40379),
            this.client.getFloatFromHoldingRegister(40423),
            this.client.getFloatFromHoldingRegister(40425) // upcBattTemp
        ]).then(results => {
            return {
                // General parameters
                general: {
                    upcMcuUid: results[0], upcFwVer: results[1], upcNameId: results[2], upcMode: results[3], upcStatus: results[4], upcClock: results[5], upcTimeZone: results[6],
                    upcLanguage: results[7], upcEventNum: results[8], upcTrapNum: results[9], co2FlowRefTrap: results[10], co2FlowRefNom: results[11], co2FlowRefAdj: results[12],
                    co2PressOutRef: [results[13], results[14], results[15], results[16], results[17], results[18], results[19], results[20], results[21], results[22]],
                    co2PressOutTemp: results[23]
                },
                // Comunication
                comunication: {
                    comMdmName: results[24], comMdmPass: results[25], comMdmIpAdr: results[26], comMdmMode: results[27],
                    comMdmLevel: results[28], comWifiSsid: results[29], comWifiPass: results[30], comWifiApCh: results[31]
                },
                // CO2 diffusion
                co2Diffusion: {
                    diffHourSunRise: results[32], diffHourSunSet: results[33],
                    diffCo2Program: [results[34], results[35], results[36], results[37], results[38], results[39], results[40], results[41], results[42], results[43]],
                    diffCo2Sunrise: results[44], diffCo2Sunset: results[45], co2PressInpMeas1: results[46], co2PressInpMeas2: results[47], co2PressOutMeas: results[48],
                    co2FlowMeas: results[49], co2PressInpAvg: results[50], co2PressInpOffs: results[51], co2PressOutAvg: results[52], co2PressoutOffs: results[53],
                    co2PressOutComp: results[54], co2FlowAvg: results[55], co2FlowOffs: results[56], co2FlowGain: results[57], upcCo2DiffLvl: results[58],
                    upcDiffLvlAdj: results[59], co2TempAvg: results[60]
                },
                // CO2 reserves
                co2Reserves: {
                    co2ResActive: results[61], co2ResActAdj: results[62], co2ResActPrev: results[63], co2ResInactPrev: results[64], co2ResType: results[65],
                    co2Res1Status: results[66], co2Res1FillNew: results[67], co2Res1FillVol: results[68], co2Res1FillTime: results[69], co2Res1ActVol: results[70],
                    co2Res1ActDur: results[71], co2Res1StartVol: results[72], co2Res1AuxVol: results[73], co2Res2Status: results[74], co2Res2FillNew: results[75],
                    co2Res2FillVol: results[76], co2Res2FillTime: results[77], co2Res2ActVol: results[78], co2Res2ActDur: results[79], co2Res2StartVol: results[80],
                    co2Res2AuxVol: results[81]
                },
                // Alarms setup
                alarms: {
                    alrResEmptyTest: results[82], alrResLowEn: results[83], alrResEmptyEn: results[84], alrPressInpEn: results[85], alrPressOutEn: results[86], alrFlowAvgEn: results[87],
                    alrPowDownEn: results[88], alrPowBackEn: results[89], alrSmsNum: [results[90], results[91], results[92], results[93], results[94]], alrResLowLevel: results[95],
                    alrResEmptyFlow: results[96], alrPressInpTol: results[97], alrPressOutTol: results[98], alrFlowSetTol: results[99],
                    alrPressInpSet1: [results[100], results[101], results[102], results[103], results[104], results[105], results[106], results[107], results[108], results[109]],
                    alrPressInpSet2: [results[110], results[111], results[112], results[113], results[114], results[115], results[116], results[117], results[118], results[119]],
                    alrPressOutSet: [results[120], results[121], results[122], results[123], results[124], results[125], results[126], results[127], results[128], results[129]],
                    alrPressSetTemp: results[130]
                },
                // Auxiliary parameters
                auxiliary: {
                    comWebSrvUrl: results[131], comMdmApnId: results[132], comMdmApnUser: results[133], comMdmApnPass: results[134], upcCo2PidProp: results[135],
                    upcCo2PidInteg: results[136], upcCo2PidDiff: results[137], upcBattChrg: results[138], upcBattTemp: results[139]
                }
            };
        });
    }
    reset() {
        return Promise.all([this.client.setIntInHoldingRegister(40011, 1, 0xffff)]);
    }
    wipe() {
        return Promise.all([this.client.setIntInHoldingRegister(40011, 1, 0xeeee)]);
    }
}
UPCModbus.litterToKilograms = 0.001974;
UPCModbus.ctorParameters = () => [
    null
];
var UPCState;
(function (UPCState) {
    UPCState[UPCState["RECONNECTING"] = 0] = "RECONNECTING";
    UPCState[UPCState["ONLINE"] = 1] = "ONLINE";
    UPCState[UPCState["OFFLINE"] = 2] = "OFFLINE";
    UPCState[UPCState["ERROR"] = 3] = "ERROR";
    UPCState[UPCState["NULL"] = 4] = "NULL";
})(UPCState || (UPCState = {}));


/***/ }),

/***/ "./src/app/model/upcv3/upcv3.ts":
/*!**************************************!*\
  !*** ./src/app/model/upcv3/upcv3.ts ***!
  \**************************************/
/*! exports provided: UPCV3 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "UPCV3", function() { return UPCV3; });
/* harmony import */ var _generalParameters__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./generalParameters */ "./src/app/model/upcv3/generalParameters.ts");
/* harmony import */ var _communicationParameters__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./communicationParameters */ "./src/app/model/upcv3/communicationParameters.ts");
/* harmony import */ var _diffusionParameters__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./diffusionParameters */ "./src/app/model/upcv3/diffusionParameters.ts");
/* harmony import */ var _reservesParameters__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./reservesParameters */ "./src/app/model/upcv3/reservesParameters.ts");
/* harmony import */ var _alarmsParameters__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./alarmsParameters */ "./src/app/model/upcv3/alarmsParameters.ts");
/* harmony import */ var _LocalDateTime__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./LocalDateTime */ "./src/app/model/upcv3/LocalDateTime.ts");
/* harmony import */ var _defaultUPCV3Params__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./defaultUPCV3Params */ "./src/app/model/upcv3/defaultUPCV3Params.ts");
/* harmony import */ var _diffCo2Program__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./diffCo2Program */ "./src/app/model/upcv3/diffCo2Program.ts");








class UPCV3 {
    constructor(defaultParams = null) {
        this.id = 0;
        this.upcNameId = '';
        this.lat = 0;
        this.lng = 0;
        this.upcError = 0;
        this.hibernated = false;
        this.generalParameters = new _generalParameters__WEBPACK_IMPORTED_MODULE_0__["GeneralParameters"]();
        this.communicationParameters = new _communicationParameters__WEBPACK_IMPORTED_MODULE_1__["CommunicationParameters"]();
        this.diffusionParameters = new _diffusionParameters__WEBPACK_IMPORTED_MODULE_2__["DiffusionParameters"]();
        this.reservesParameters = new _reservesParameters__WEBPACK_IMPORTED_MODULE_3__["ReservesParameters"]();
        this.alarmsParameters = new _alarmsParameters__WEBPACK_IMPORTED_MODULE_4__["AlarmsParameters"]();
        this.upcLastPollDatetime = new _LocalDateTime__WEBPACK_IMPORTED_MODULE_5__["LocalDateTime"]();
        this.lastPollResult = 0;
        this.upcPollEnable = false;
        this.upcPollTasks = 0;
        this.upcLastSyncDatetime = new _LocalDateTime__WEBPACK_IMPORTED_MODULE_5__["LocalDateTime"]();
        this.logLastVisit = new _LocalDateTime__WEBPACK_IMPORTED_MODULE_5__["LocalDateTime"]();
        this.belt = '';
        if (defaultParams) {
            this.generalParameters.co2FlowRefTrap = defaultParams.co2FlowRefTrap;
            this.generalParameters.refFlowRateGperhour = defaultParams.refFlowRateGperhour;
            this.diffusionParameters.diffCo2Program1.daysCode = _diffCo2Program__WEBPACK_IMPORTED_MODULE_7__["DaysCode"][defaultParams.daysCode1];
            this.diffusionParameters.diffCo2Program1.start = defaultParams.startTime1;
            this.diffusionParameters.diffCo2Program1.end = defaultParams.endTime1;
            this.diffusionParameters.diffCo2Program1.intensity = defaultParams.intensity1;
            this.diffusionParameters.diffCo2Program2.daysCode = _diffCo2Program__WEBPACK_IMPORTED_MODULE_7__["DaysCode"][defaultParams.daysCode2];
            this.diffusionParameters.diffCo2Program2.start = defaultParams.startTime2;
            this.diffusionParameters.diffCo2Program2.end = defaultParams.endTime2;
            this.diffusionParameters.diffCo2Program2.intensity = defaultParams.intensity2;
            this.diffusionParameters.diffCo2Sunrise.delay = defaultParams.sunriseDelay;
            this.diffusionParameters.diffCo2Sunrise.duration = defaultParams.sunriseDuration;
            this.diffusionParameters.diffCo2Sunrise.intensity = defaultParams.sunriseIntensity;
            this.diffusionParameters.diffCo2Sunset.delay = defaultParams.sunsetDelay;
            this.diffusionParameters.diffCo2Sunset.duration = defaultParams.sunsetDuration;
            this.diffusionParameters.diffCo2Sunset.intensity = defaultParams.sunsetIntensity;
            this.alarmsParameters.alrResLowEn = defaultParams.alrResLowEn;
            this.alarmsParameters.alrResEmptyEn = defaultParams.alrResEmptyEn;
            this.alarmsParameters.alrPresInpEn = defaultParams.alrPresInpEn;
            this.alarmsParameters.alrPresOutEn = defaultParams.alrPresOutEn;
            this.alarmsParameters.alrFlowAvgEn = defaultParams.alrFlowAvgEn;
            this.alarmsParameters.alrPowBackEn = defaultParams.alrPowBackEn;
            this.alarmsParameters.alrPowDownEn = defaultParams.alrPowDownEn;
            this.alarmsParameters.alrEmptyPress = defaultParams.alrEmptyPress;
            this.alarmsParameters.alrEmptyVol = defaultParams.alrEmptyVol;
            this.alarmsParameters.alrPresInpTol = defaultParams.alrPresInpTol;
            this.alarmsParameters.alrPresOutTol = defaultParams.alrPresOutTol;
            this.alarmsParameters.alrFlowSetTol = defaultParams.alrFlowSetTol;
            this.alarmsParameters.alrResLowLevel = defaultParams.alrResLowLevel;
            this.alarmsParameters.alrResEmptyFlow = defaultParams.alrResEmptyFlow;
            this.alarmsParameters.alrSmsNum1 = defaultParams.alrSmsNum0;
            this.communicationParameters.comWiFiName = defaultParams.comWiFiName;
            this.communicationParameters.comWiFiPass = defaultParams.comWiFiPass;
            this.generalParameters.upcLanguage = defaultParams.upcLanguage;
            this.communicationParameters.comGsmName = defaultParams.comGsmName;
            this.communicationParameters.comGsmPass = defaultParams.comGsmPass;
            this.communicationParameters.comWebSrvUrl = defaultParams.comWebSrvUrl;
        }
    }
    co2LettersToKg(letters) {
        return letters * 0.001974;
    }
    get upcStatusString() {
        switch (this.generalParameters.upcStatus) {
            case 0: return 'DIS';
            case 1: return 'ENA';
            case 2: return 'ADJ';
            case 3: return 'CHK';
            case 4: return 'CAL';
            case 100: return 'EMPTY';
            default: return '';
        }
    }
    get co2ResActiveString() {
        if (this.generalParameters.upcMode == 0)
            return '/';
        switch (this.reservesParameters.co2ResActive) {
            case 1:
                var co2ResActive = 'B' + this.reservesParameters.co2ResActive;
                if (this.reservesParameters.co2ResType == 1)
                    co2ResActive += 'P';
                if (this.reservesParameters.co2ResType == 2)
                    co2ResActive += 'S';
                return co2ResActive;
            case 2:
                var co2ResActive = 'B' + this.reservesParameters.co2ResActive;
                if (this.reservesParameters.co2ResType == 1)
                    co2ResActive += 'S';
                if (this.reservesParameters.co2ResType == 2)
                    co2ResActive += 'P';
                return co2ResActive;
            default:
                return '-';
        }
    }
    get upcLastPollDatetimeString() {
        if (this.upcLastPollDatetime) {
            // Day
            if (this.upcLastPollDatetime.daysFromNow > 0) {
                if (this.upcLastPollDatetime.daysFromNow > 1)
                    return this.upcLastPollDatetime.daysFromNow + ' jours';
                else
                    return this.upcLastPollDatetime.daysFromNow + ' jour';
            }
            // Hour
            if (this.upcLastPollDatetime.hoursFromNow > 0) {
                if (this.upcLastPollDatetime.hoursFromNow > 1)
                    return this.upcLastPollDatetime.hoursFromNow + ' heures';
                else
                    return this.upcLastPollDatetime.hoursFromNow + ' heure';
            }
            // Minute
            if (this.upcLastPollDatetime.minutesFromNow > 0) {
                if (this.upcLastPollDatetime.minutesFromNow > 1)
                    return this.upcLastPollDatetime.minutesFromNow + ' minutes';
                else
                    return this.upcLastPollDatetime.minutesFromNow + ' minute';
            }
        }
        else
            return '-';
    }
    get upcNameIdIndex() {
        // 0: hibernating   1: OK   2: Alert    3: Comm error   4: Empty
        if (!this.hibernated) {
            if (this.reservesParameters.co2Res1Status == 0 && this.reservesParameters.co2Res2Status == 0)
                return 4;
            else if (this.upcPollEnable && this.lastPollResult != 0)
                return 3;
            else if (this.reservesParameters.co2Res1Status == 0 || this.reservesParameters.co2Res2Status == 0)
                return 2;
            else
                return 1;
        }
        else
            return 0;
    }
    get upcNameIdClass() {
        if (!this.hibernated && ((this.reservesParameters.co2Res1Status == 0 && this.reservesParameters.co2Res2Status == 0) || (this.upcPollEnable && this.lastPollResult != 0)))
            return 'text-danger';
        else if (!this.hibernated && (this.reservesParameters.co2Res1Status == 0 || this.reservesParameters.co2Res2Status == 0))
            return 'text-warning';
        else if (this.hibernated)
            return 'text-primary';
        else
            return 'text-success';
    }
    get upcStatusClass() {
        if (!this.hibernated && (this.generalParameters.upcStatus == 0 || this.generalParameters.upcStatus == 2 || this.generalParameters.upcStatus > 7))
            return 'text-danger font-weight-bold';
        else if (!this.hibernated && this.generalParameters.upcStatus == 3)
            return 'text-warning font-weight-bold';
        else
            return '';
    }
    get co2Res1ActVolClass() {
        if (!this.hibernated && this.reservesParameters.co2Res1Status == 0)
            return 'text-danger font-weight-bold';
        else if (!this.hibernated && this.reservesParameters.co2Res1Status == 1)
            return 'text-warning font-weight-bold';
        else
            return '';
    }
    get co2Res2ActVolClass() {
        if (!this.hibernated && this.reservesParameters.co2Res2Status == 0)
            return 'text-danger font-weight-bold';
        else if (!this.hibernated && this.reservesParameters.co2Res2Status == 1)
            return 'text-warning font-weight-bold';
        else
            return '';
    }
    get upcLastPollDatetimeClass() {
        if (!this.hibernated && this.lastPollResult != 0)
            return 'text-danger font-weight-bold';
        else
            return '';
    }
    get upcPollEnableClass() {
        if (!this.hibernated && !this.upcPollEnable)
            return 'text-danger font-weight-bold';
        else
            return '';
    }
    static loadFromJSON(json) {
        var upcv3 = Object.assign(new UPCV3, json);
        if (json.generalParameters)
            upcv3.generalParameters = _generalParameters__WEBPACK_IMPORTED_MODULE_0__["GeneralParameters"].loadFromJSON(json.generalParameters);
        if (json.communicationParameters)
            upcv3.communicationParameters = _communicationParameters__WEBPACK_IMPORTED_MODULE_1__["CommunicationParameters"].loadFromJSON(json.communicationParameters);
        if (json.diffusionParameters)
            upcv3.diffusionParameters = _diffusionParameters__WEBPACK_IMPORTED_MODULE_2__["DiffusionParameters"].loadFromJSON(json.diffusionParameters);
        if (json.reservesParameters)
            upcv3.reservesParameters = _reservesParameters__WEBPACK_IMPORTED_MODULE_3__["ReservesParameters"].loadFromJSON(json.reservesParameters);
        if (json.alarmsParameters)
            upcv3.alarmsParameters = _alarmsParameters__WEBPACK_IMPORTED_MODULE_4__["AlarmsParameters"].loadFromJSON(json.alarmsParameters);
        if (json.upcLastPollDatetime)
            upcv3.upcLastPollDatetime = _LocalDateTime__WEBPACK_IMPORTED_MODULE_5__["LocalDateTime"].loadFromJSON(json.upcLastPollDatetime);
        if (json.logLastVisit)
            upcv3.logLastVisit = _LocalDateTime__WEBPACK_IMPORTED_MODULE_5__["LocalDateTime"].loadFromJSON(json.logLastVisit);
        if (json.upcLastSyncDatetime)
            upcv3.upcLastSyncDatetime = _LocalDateTime__WEBPACK_IMPORTED_MODULE_5__["LocalDateTime"].loadFromJSON(json.upcLastSyncDatetime);
        return upcv3;
    }
}
UPCV3.ctorParameters = () => [
    { type: _defaultUPCV3Params__WEBPACK_IMPORTED_MODULE_6__["DefaultUPCV3Params"] }
];


/***/ }),

/***/ "./src/app/model/user.ts":
/*!*******************************!*\
  !*** ./src/app/model/user.ts ***!
  \*******************************/
/*! exports provided: User */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "User", function() { return User; });
class User {
    constructor() {
        this.id = '';
        this.username = '';
        this.password = '';
    }
}


/***/ }),

/***/ "./src/app/rackcontent/rackcontent.page.scss":
/*!***************************************************!*\
  !*** ./src/app/rackcontent/rackcontent.page.scss ***!
  \***************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL3JhY2tjb250ZW50L3JhY2tjb250ZW50LnBhZ2Uuc2NzcyJ9 */"

/***/ }),

/***/ "./src/app/rackcontent/rackcontent.page.ts":
/*!*************************************************!*\
  !*** ./src/app/rackcontent/rackcontent.page.ts ***!
  \*************************************************/
/*! exports provided: RackcontentPage */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RackcontentPage", function() { return RackcontentPage; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm2015/core.js");
/* harmony import */ var _api_upcv3service_service__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../api/upcv3service.service */ "./src/app/api/upcv3service.service.ts");
/* harmony import */ var _ionic_storage__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @ionic/storage */ "./node_modules/@ionic/storage/fesm2015/ionic-storage.js");
/* harmony import */ var _ionic_angular__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @ionic/angular */ "./node_modules/@ionic/angular/dist/fesm5.js");
/* harmony import */ var _api_ApiResponse__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../api/ApiResponse */ "./src/app/api/ApiResponse.ts");
/* harmony import */ var _api_global_service__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../api/global.service */ "./src/app/api/global.service.ts");







let RackcontentPage = class RackcontentPage {
    constructor(upcv3Service, storage, modal, global) {
        this.upcv3Service = upcv3Service;
        this.storage = storage;
        this.modal = modal;
        this.global = global;
        this.designation = [];
        this.isMesser = [];
    }
    ngOnInit() {
        this.storage.get("token").then(val => {
            this.token = val;
            this.upcv3Service.getBottleFromRack(val, this.rack).subscribe(res => {
                this.rackContent = res.result;
                this.rackContent.forEach(item => {
                    if (item.bottleType.designation == 37.5) {
                        this.isMesser.push(true);
                        this.designation.push("37.5");
                    }
                    else {
                        this.isMesser.push(false);
                        this.designation.push("" + item.bottleType.designation);
                    }
                });
            });
        });
    }
    onClose() {
        this.modal.dismiss();
    }
    onRetourFourn() {
        this.upcv3Service.removeRack(this.rack, this.token).subscribe(res => {
            if (res.code === _api_ApiResponse__WEBPACK_IMPORTED_MODULE_5__["Code"].BOTTLE_DELETED) {
                this.modal.dismiss();
            }
        });
    }
};
RackcontentPage.ctorParameters = () => [
    { type: _api_upcv3service_service__WEBPACK_IMPORTED_MODULE_2__["Upcv3serviceService"] },
    { type: _ionic_storage__WEBPACK_IMPORTED_MODULE_3__["Storage"] },
    { type: _ionic_angular__WEBPACK_IMPORTED_MODULE_4__["ModalController"] },
    { type: _api_global_service__WEBPACK_IMPORTED_MODULE_6__["GlobalService"] }
];
RackcontentPage = tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Component"])({
        selector: 'app-rackcontent',
        template: __webpack_require__(/*! raw-loader!./rackcontent.page.html */ "./node_modules/raw-loader/index.js!./src/app/rackcontent/rackcontent.page.html"),
        styles: [__webpack_require__(/*! ./rackcontent.page.scss */ "./src/app/rackcontent/rackcontent.page.scss")]
    }),
    tslib__WEBPACK_IMPORTED_MODULE_0__["__metadata"]("design:paramtypes", [_api_upcv3service_service__WEBPACK_IMPORTED_MODULE_2__["Upcv3serviceService"], _ionic_storage__WEBPACK_IMPORTED_MODULE_3__["Storage"], _ionic_angular__WEBPACK_IMPORTED_MODULE_4__["ModalController"], _api_global_service__WEBPACK_IMPORTED_MODULE_6__["GlobalService"]])
], RackcontentPage);



/***/ }),

/***/ "./src/environments/environment.ts":
/*!*****************************************!*\
  !*** ./src/environments/environment.ts ***!
  \*****************************************/
/*! exports provided: environment */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "environment", function() { return environment; });
// This file can be replaced during build by using the `fileReplacements` array.
// `ng build --prod` replaces `environment.ts` with `environment.prod.ts`.
// The list of file replacements can be found in `angular.json`.
const environment = {
    production: false
};
/*
 * For easier debugging in development mode, you can import the following file
 * to ignore zone related error stack frames such as `zone.run`, `zoneDelegate.invokeTask`.
 *
 * This import should be commented out in production mode because it will have a negative impact
 * on performance if an error is thrown.
 */
// import 'zone.js/dist/zone-error';  // Included with Angular CLI.


/***/ }),

/***/ "./src/main.ts":
/*!*********************!*\
  !*** ./src/main.ts ***!
  \*********************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/fesm2015/core.js");
/* harmony import */ var _angular_platform_browser_dynamic__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/platform-browser-dynamic */ "./node_modules/@angular/platform-browser-dynamic/fesm2015/platform-browser-dynamic.js");
/* harmony import */ var _app_app_module__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./app/app.module */ "./src/app/app.module.ts");
/* harmony import */ var _environments_environment__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./environments/environment */ "./src/environments/environment.ts");




if (_environments_environment__WEBPACK_IMPORTED_MODULE_3__["environment"].production) {
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["enableProdMode"])();
}
Object(_angular_platform_browser_dynamic__WEBPACK_IMPORTED_MODULE_1__["platformBrowserDynamic"])().bootstrapModule(_app_app_module__WEBPACK_IMPORTED_MODULE_2__["AppModule"])
    .catch(err => console.log(err));


/***/ }),

/***/ 0:
/*!***************************!*\
  !*** multi ./src/main.ts ***!
  \***************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__(/*! /Users/harmand/Desktop/biobeltmobile/src/main.ts */"./src/main.ts");


/***/ })

},[[0,"runtime","vendor"]]]);
//# sourceMappingURL=main-es2015.js.map