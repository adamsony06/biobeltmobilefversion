{"version":3,"sources":["./src/app/login/login.page.html","./src/app/login/login-routing.module.ts","./src/app/login/login.module.ts","./src/app/login/login.page.scss","./src/app/login/login.page.ts"],"names":[],"mappings":"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","file":"login-login-module-es2015.js","sourcesContent":["module.exports = \"<ion-content class=\\\"bg-light\\\" *ngIf=\\\"isLog\\\">\\n  <ion-row justify-content-center align-items-center>\\n    <ion-col col-12 col-sm-10 col-md-6 col-lg-5 col-xl-4>\\n\\n      <ion-card>\\n\\n        <!-- Image -->\\n        <img src=\\\"assets/bg_logo.png\\\"/>  \\n\\n        <!-- Content -->\\n        <ion-card-content>\\n\\n          <!-- Title -->\\n          <ion-card-title>Se connecter</ion-card-title>\\n\\n          <!-- Login form -->\\n          <form #loginForm=\\\"ngForm\\\" (ngSubmit)=\\\"login()\\\" autocomplete=\\\"off\\\">\\n\\n            <ion-list inset>\\n\\n              <ion-item>\\n                <ion-input placeholder=\\\"Email\\\" name=\\\"username\\\" type=\\\"email\\\" required [(ngModel)]=\\\"username\\\" #email></ion-input>\\n              </ion-item>\\n\\n              <ion-item>\\n                <ion-input placeholder=\\\"Mot de passe\\\" name=\\\"password\\\" type=\\\"password\\\" required [(ngModel)]=\\\"password\\\"></ion-input>\\n              </ion-item>\\n\\n            </ion-list>\\n\\n            <ion-button class=\\\"submit-btn\\\" color=\\\"primary\\\" full type=\\\"submit\\\" [disabled]=\\\"!loginForm.form.valid\\\" margin-top>Se connecter</ion-button>\\n\\n          </form>\\n        </ion-card-content>\\n\\n      </ion-card>\\n\\n    </ion-col>\\n  </ion-row>\\n</ion-content>\\n\"","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { LoginPage } from './login.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: LoginPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class LoginPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { LoginPageRoutingModule } from './login-routing.module';\n\nimport { LoginPage } from './login.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    LoginPageRoutingModule\n  ],\n  declarations: [LoginPage]\n})\nexport class LoginPageModule {}\n","module.exports = \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL2xvZ2luL2xvZ2luLnBhZ2Uuc2NzcyJ9 */\"","import { Component, OnInit, ViewChild } from '@angular/core';\nimport {Upcv3serviceService} from '../api/upcv3service.service';\nimport { ToastController, NavController, LoadingController } from '@ionic/angular';\nimport {User} from '../model/user';\nimport { Storage } from '@ionic/storage';\n\n@Component({\n  selector: 'app-login',\n  templateUrl: './login.page.html',\n  styleUrls: ['./login.page.scss'],\n})\nexport class LoginPage implements OnInit {\n  @ViewChild('email', {static: false}) email: any;\n  private username: string;\n  private password: string;\n  private isLog = false;\n\n  constructor(\n    private upc3serv:Upcv3serviceService,\n    public navCtrl: NavController,\n    public toastCtrl: ToastController,\n    public loadingCtrl: LoadingController,\n    private storage : Storage\n\n  ) { }\n  async ngOnInit() {\n    localStorage.setItem(\"BBAM\",null);\n    setTimeout(() => {\n      this.email.setFocus();\n    }, 500);\n    await this.storage.get('user').then(val => this.username = val);\n    await this.storage.get('pass').then(val => this.password = val);\n    await this.storage.get('remember').then(async res=>{\n      if (res === 1){\n        const loading = await this.loadingCtrl.create({\n          message: 'Connexion en cours...'\n        });\n        loading.present();\n        let user = new User();\n        user.username = this.username;\n        user.password = this.password;\n        this.upc3serv.login(user).subscribe(async res=>{\n          loading.dismiss();\n          if(res.result){\n            localStorage.setItem(\"token\",res.result);\n            this.navCtrl.navigateRoot('home');\n          }\n          else {\n            // Check code\n            switch (res.code) {\n              case 'TOKEN_WRONG_IDENTIFIERS':\n                let toast = await this.toastCtrl.create({\n                  message: 'Identifiants incorrects !',\n                  duration: 3000,\n                  position: 'top'\n                });\n                toast.present();\n                break;\n            }\n          }\n        },\n        async err => {\n          // Hide loading\n          loading.dismiss();\n\n          let toast = await this.toastCtrl.create({\n            message: 'Impossible de se connecter à internet !',\n            duration: 3000,\n            position: 'top'\n          });\n          toast.present()\n        })\n      }\n      else {\n        this.isLog = true;\n      }\n    });\n  }\n  \n  \n  async login() {\n    // Show loading\n    const loading = await this.loadingCtrl.create({\n      message: 'Connexion en cours...'\n    });\n    loading.present();\n   \n    // Request\n    let user :User = new User();\n    user.username = this.username;\n    user.password = this.password;\n    this.upc3serv.login(user).subscribe(\n        async data => {\n          // Hide loading\n          loading.dismiss();\n\n          // Check state\n          if (data.result) {\n            this.storage.set('token',data.result);\n            localStorage.setItem(\"token\",data.result);\n            this.storage.set('user',user.username);\n            this.storage.set('pass',user.password);\n            this.storage.set('remember',1);\n            this.navCtrl.navigateRoot('home'); \n          \n          } else {\n            // Check code\n            switch (data.code) {\n              case 'TOKEN_WRONG_IDENTIFIERS':\n                let toast = await this.toastCtrl.create({\n                  message: 'Identifiants incorrects !',\n                  duration: 3000,\n                  position: 'top'\n                });\n                toast.present();\n                break;\n            }\n          }\n        },\n        async err => {\n          // Hide loading\n          loading.dismiss();\n\n          let toast = await this.toastCtrl.create({\n            message: 'Impossible de se connecter à internet !',\n            duration: 3000,\n            position: 'top'\n          });\n          toast.present()\n        }\n    );\n  }\n\n}\n"],"sourceRoot":""}